The dynamics of higher-order noveltiesGabriele Di Bona1, 2, 3, 4, Alessandro Bellina3, 4, 5, Giordano De Marzo4, 5, 6, 7, Angelo Petralia8, Iacopo Iacopini9, 10, and Vito Latora1, 7, 11, *


## 1School of Mathematical Sciences, Queen Mary University of London, London E1 4NS, United Kingdom


## 2CNRS, GEMASS, 59 rue Pouchet, F-75017, Paris, France


## 3Sony Computer Science Laboratories Rome, I-00184, Rome, Italy


## 4Centro Ricerche Enrico Fermi, I-00184 Rome, Italy


## 5Dipartimento di Fisica Universit `a “Sapienza”, I-00185 Rome, Italy.


## 6Sapienza School for Advanced Studies, “Sapienza”, I-00185 Rome, Italy.


## 7Complexity Science Hub Vienna, A-1080 Vienna, Austria


## 8Department of Economics and Business, University of Catania, I-95128 Catania, Italy


## 9Network Science Institute, Northeastern University London, London, E1W 1LP, United Kingdom


## 10Department of Physics, Northeastern University, Boston, MA 02115, USA


## 11Dipartimento di Fisica ed Astronomia, Universit `a di Catania and INFN, I-95123 Catania, Italy

*Email: v.latora@qmul.a c.ukABSTRACTStudying how we explore the world in search of novelties is key to understand the mechanisms that can lead to new discoveries. Previous studies analyzed novelties in various exploration processes, defining them as the first appearance of an element. However, novelties can also be generated by combining what is already known. We hence define higher-order novelties as the first time two or more elements appear together, and we introduce higher-order Heaps’ exponents as a way to characterize their pace of discovery. Through extensive analysis of real-world data, we find that processes with the same pace of discovery, as measured by the standard Heaps’ exponent, can instead differ at higher orders. We then propose to model an exploration process as a random walk on a network in which the possible connections between elements evolve in time. The model reproduces the empirical properties of higher-order novelties, revealing how the network we explore changes over time along with the exploration process.


## Introduction

As humans, we experience novelties as part of our daily life. By the term novelty we generally indicate two apparently different things1. On the one hand, we can think of a novelty as the first time we visit a neighborhood, enter a newly launched pub, or listen to a song from an artist we previously did not know. In this case, the novelty represents a discovery for a single individual of a place, an artist o r, more in general, an item. On the other hand, there are discoveries that are new to the entire population, as could be a technological advancement or the development of a new drug. However, these two cases are not entirely distinct, as the second set of novelties, those new to everyone, represent a subset of the first one. Analysing how novelties emerge, both at the individual level and at the level of the entire population, is key to understand human creativity and the neural and social mechanisms that can lead to new discoveries.

The increasing availability of data on human behavior and consumption habits has allowed to study how humans explore the world, how novelties emerge in different contexts, and how they are distributed in time1–3. Empirical investigations cover a broad range of different areas4, ranging from science5 and language6, 7, to gastronomy8, goods or products9, network science10, information11, and cinema12, to name a few relevant examples. No matter the topic, one can always represent data coming from real-world exploration processes as sequences of elements or “items” that are sequentially adopted or consumed13. For instance, the activity of a user on an online digital music platform is turned into a sequence of listened songs, and a novelty is defined as the first time a song, or an artist, appears in the sequence14. Analogously, articles published in a scientific journal can be turned into a time-ordered sequence of concepts or keywords discovered by the community, and a novelty can be defined, again, as the first-time appearance of a keyword3. Under this framework, evidence shows that—independently of the system they belong t o—novelties seem to obey the same statistical patterns in the way they are distributed and correlated in time1. Indeed, a long tradition of works, started by the Yule-Simon processes for text generation15, 16, shows that most empirical sequences follow Heaps’17–19, Zipf’s20–24, and Taylor’s laws25.

Along with data-driven investigations, a relevant scientific problem is that of finding plausible mechanisms to reproduce and explain the empirical observations. What are the drivers controlling the appearance of new items in a sequence? How do humans explore the seemingly infinite space of possibilities in search of novelties? Interestingly, an insightful answer comes from biology, where, in 1996, Stuart Kauffman introduced the concept of the adjacent possible26 (AP) referring to “all those molecular species that are not members of the actual, but are one reaction step away from the actual”. In-arXiv:2307.06147v3  [physics.soc-p h]  7 Nov 2024 spired by previous works by Packard and Langton27–29, the AP provides a fresh view on the problem, for which discoveries (the possible) can only be found among those items which are close (the adjacent) to what is already known (the actual). New discoveries would then generate an expanding space of opportunities that are only available to u si n the moment we “unlock” what is adjacent to them. Kauffman’s AP has seen many interesting applications ranging from biology26, 30and economics9, 31 to models of discovery and innovation1, 3, 6. Among these, of particular interest is the recently proposed Urn Model with Triggering (UMT)1, 6, 32. Building upon the work of P´olya33, 34, the UMT adds to the traditional reinforcement mechanism of the P´olya urn’s scheme a triggering mechanism that expands the space of possible discoveries upon the extraction of each novelty. Being able to reproduce the empirical laws and thanks to its simplicity, the UMT has been used to study various systems with an expanding set of “items”, like the rise and fall of popularity in technological and artistic productions2, the emergence and evolution of social networks35, and the evolution of the cryptocurrency ecosystem36. One could also picture ideas, concepts, or items as the linked elements of an abstract network. In this view, the exploration process can be modelled as a random walk over this network, where the AP accounts for the emergence of the new starting from the “edge of what is known” within the network. Approaches based on random walks have been used to investigate the cognitive growth of knowledge in scientific disciplines3, and further extended to account for multi-agent systems, where the individual exploration of the agent is enriched by social interactions14, 37.

The idea of the AP, modelled either in terms of extractions from urns or random walks over a network, is of great importance to understand the processes leading to novelties. There i s, however, another important mechanism of creation of the new which is neglected by the frameworks discussed above: novelties can arise from the combination of alreadyknown elements. For instance, a meaningless sequence of words, if ordered in a different way, may generate elegant poetry38, 39. Novel combinations of existing hashtags may lead to new social-media trends40, 41. Different orderings of the same musical notes may in principle generate an endless number of songs42. The mechanics of combination of “preexisting” items has been studied in various fields, e.g., in biology where new associations of various entities produce new organisms. It has been shown that the immune system recombines existing segments of genes to produce new receptors43, 44. Also, publications and collaborations in science45are typically combinations of research ideas46–48 and expertises49–51. Similarly, in innovation economics, as originally discussed by Schumpeter52, 53 and confirmed by recent works on the generation of technologies54–56, new combinations of existing factors, that interact in a technological production process, may give rise to innovations, which rule out of the market obsolete products and services57, 58, thus increasing the probability of reaching further innovations (the s o-called “creative destruction”). In this context, the aim of this paper is to explore a more general notion of novelty, including novel combinations of existing elements. We thus investigate the dynamics of “higherorder” novelties, i.e., novel pairs, triplets, etc., of items in a sequence. In particular, we focus on the Heaps’ law, which characterizes the growth of the number of novelties in the sequence as a power-law, whose exponent is a proxy for the rate of discovery18 in the related process. Namely, we introduce higher-order Heaps’ laws to characterize the rate at which novel combinations of two and more elements appear in a sequence. We then analyse various types of empirical sequences, ranging from music listening records, to words in texts, and concepts in scientific articles, finding that Heaps’ laws also hold at higher orders. We discover that processes with a similar rate of discovery of single items can instead display different rates of discovery at higher orders, and can hence be differentiated by looking at higher-order novelties. We therefore propose a new model which is capable of reproducing various empirically observed features of higher-order Heaps’ laws. In our model the process of exploration is described as an edge-reinforced random walk with triggering (ERRWT) on a network. In our framework, the novelties at different orders (nodes and links visited for the first time by the walker) shape the growth of the network by reinforcing traversed links, while triggering the addition of new elements through the expansion and exploration of the adjacent possible. This expansion can happen whenever a node is visited for the first time, making other nodes accessible to the explorer, but also whenever a link is firstly used. In this case, the newly established connection will trigger novel combinations between previously explored nodes. By fitting the contributions of the two mechanisms of reinforcement and triggering, the ERRWT model is able to reproduce well the variety of scaling exponents found in real systems for the Heaps’ laws at different orders.


## Results

Higher-order Heaps’ laws An exploration process can be represented as an ordered set of T symbols S = {a 1, a 2, . . . , aT } sequentially explored. Such a set describes the sequence of “events” or “items” produced along the journey, e.g., the songs listened by a given individual over time, the list of hashtags posted on an online social network, the list of words in a text, or any other ordered list of items or ideas generated by single individuals or social groups1, 13, 37, 59. Similarly, in the context of some recent modelling schemes of discovery, the sequence S can be made of the colors of balls extracted from an urn1, 37, 59, or the nodes visited over time by a random walker moving on a network3. Although real-world events have an associated time, here, for simplicity, we focus only on their sequence, i.e., the relative temporal order of the events, neglecting the precise time at which they happen. For instance, if a person listens to song a 1 at time t 1, song a 2 at time t 2, song ai at time t i, and so o n,2/34with t 1 < t 2 < · · · < ti < . . . , we neglect these times and only retain the order of the songs in the sequence {a 1, a 2, . . . , aT }. In other words, we assume that a 1 is associated to the discrete time t = 1, a 2 is associated to time t = 2, and so forth.

Among the different ways to characterize the discovery rate of a given process, the Heaps’ law, D( t) ∼ tβ , describes the power-law growth of the number of novelties as a function of the number of items in the sequence, i.e., how the number D( t) of novel elements in the sequence S scale with the sequence length t18. The s o-called (standard) Heaps’ exponent β , that from now on we indicate as 1st-order Heaps’ exponent β1, is thus a measure of the pace of discovery of the process that generated the considered sequence. Given that the number of different elements D1(t) ≡ D( t) is smaller (o r equal) than the total length to f the sequence, the value of β1 is always bounded in the interval [0, 1], with the extreme case β1 = 1 reached by a process that generates new elements at a linear rate.

Here, we propose to go one step beyond and look at novelties as novel pairs, triplets, and higher-order combinations of consecutive symbols in a sequence60. For instance, when exploring a network, a novel pair is represented by the first visit of a link. In order to measure the pace of discovery of these higher-order compounds starting from a sequence of events S1 ≡ S , we first create the surrogate sequence of overlapping pairs S2 = {(a 1, a 2), (a 2, a 3), . . . , (aT −1, aT )}. Considering for example the sentence “One ring to rule them all”, from the sequence of events S1 = {one, ring, t o, rule, them, all } we obtain the sequence of overlapping pairs S2 = {(one, ring), (ring, t o), (t o, rule), (rule, them), (them, all)}. From S2 we can then compute the number D2(t) of different pairs among the first t ones, with t ≤ T − 1. Notice that, in this manuscript, we consider the pairs (one, ring) and (ring, one) as two different pairs, i.e., order matters. By construction, we always have D1(t) ≤ D2(t) ≤ t, since, on the one hand, for each new element added to S1 there is a new pair in S2, and, on the other hand, there cannot be more than t different pairs among t items. From the power-law scaling D2(t) ∼ tβ2 , we can then extract the value of β2, which we refer to as the


## 2nd-order Heaps’ exponent. This definition can be naturally

extended to any order n, considering the sequence Sn of consecutive overlapping n-tuples present in S1. Notice that, if |S1| = T , then |Sn| = T − n + 1. We can hence compute the number Dn( t) of different tuples among the first t tuples in Sn, and extract the nth-order Heaps’ exponent βn ∈ [0, 1] from Dn( t) ∼ tβn. Notice also that the nth-order Heaps’ exponent can also be interpreted as the first order Heaps’ exponent of a sequence whose events are the overlapping n-tuples of the original sequence. Finally, it is worth remarking that such an approach is close to the analysis of Zipf’s law in linguistic data for n-grams or sentences61, 62. In this context, studies showed that as one moves from graphemes, to words, sentences, and n-grams, the Zipf’s exponent (reciprocal of the Heaps’ exponent for infinitely long sequences19) gradually diminishes. This implies that n-grams or sentences are characterized by a larger novelty rate than words, a behavior analogous to what we have discussed above.

Analysis of real-world data sequences We start investigating the emergence of novelties of different orders in empirical exploration processes associated to three different data sets. These data sets are substantially different in nature, since they refer, respectively, to songs listened by users of Last.f m, words in books collected in the Project Gutenberg, and words of titles of scientific journals from Semantic Scholar (more details on the data can be found in Materials and Methods). In Fig. 1(a-c) we plot the average temporal evolution of the number Dn( t) of novelties of order n, with n = 1, 2, 3, in the three data sets (from left to right, respectively, Last.f m, Project Gutenberg, Semantic Scholar). In order to avoid spurious effects due to different lengths of the sequences, we restrict these averages to the sequences of length T greater than the median length ˜T in the corresponding data set (see Fig. S1 in the Supplementary Information (SI) for their distribution). Each continuous curve, plotted up to length ˜T , is obtained by averaging Dn( t) over all such sequences, while the shaded area represents one standard deviation above and below the mean. We also perform power-law fits (see Materials and Methods for details on the procedure), and plot the resulting curves as dashed lines, with the fitted function shown in the legend. Focusing first on the broadly-studied (1st-order) Heaps’ law, notice how the power-law fit is only accurate in the last part of the sequence. This highlights that the Heaps’ law starts after a transient phase, where most of the events are new for the individual, as also reported in Ref.1and similarly reported in other contexts63–67. Secondly, notice how the nth-order Heaps’ law, with n = 2, 3, is valid across the data sets, but with different values of the fitted exponents, especially for n = 2. Finally, as expected from their definition, the fitted Heaps’ exponents of order n + 1, i.e., βn+1, are higher than the lower-order ones, that i s, βn+1 ≥ βn. To explore the gain in information brought by the higherorder Heaps’ exponents with respect to the 1st-order Heaps’, we now look directly at individual sequences. In Figure 1(d-i) we show the scatter plots of β2 (d-f) and β3 (g-i) against β1, where each point refers to a single sequence from Last.f m (d,g), Project Gutenberg (e,h), or Semantic Scholar (f,i), with colors representing how dense points are (see color bar at the bottom of the figure). Here, we filter out sequences whose fitted exponent has a standard error above the 0.05 threshold (see Table S1 in SI for more details), for which the Heaps’ law cannot be considered valid. This filtering removes only 30 (3.37%), 8 (0.04%), and 5 (0.03%) sequences in the three data sets, respectively. Furthemore, we have removed sequences for which the extracted value of β2 is higher than the associated value of β1, or for which β3 > β2, since Dn( t) ≤ Dn+1(t) as previously discussed. This filtering removes 53 (6.16%), 7 (0.04%), 6 (0.03%) in the three data sets, retaining a total o f


## 807, 19 622, and 18 909 sequences, respectively. Looking

a t Figure 1(d), we see how users of Last.f m sharing the same3/34


## 102 103 104

t101102103104Dn( t) a Last.fmD1(t) 4.11t0.72 D2(t) 1.30t0.93D3(t) 1.24t0.95


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 d y=x y = 0.23x + 0.75 (R2 = 0.17)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.03 gy = 0.16x + 0.82 (R2 = 0.13)


## 102 103 104

t101102103104 b Project GutenbergD1(t) 13.43t0.56 D2(t) 3.04t0.85D3(t) 1.36t0.96


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 e

y = 0.48x + 0.58 (R2 = 0.74)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 h

y = 0.18x + 0.86 (R2 = 0.34)


## 102 103 104

t101102103104 c Semantic ScholarD1(t) 5.24t0.64 D2(t) 1.94t0.88D3(t) 1.25t0.96


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 f

y = 0.44x + 0.60 (R2 = 0.69)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 i

y = 0.18x + 0.84 (R2 = 0.35)low density high densityFigure 1. Higher-order Heaps’ exponents in real-world data sets. (a-c) Average number Dn( t) of novelties of order n, with n = 1, 2, 3, as a function of the sequence length t, and fit of the associated Heaps’ laws (dashed lines), with estimated exponents shown in the legend. Shaded area represents one standard deviation above and below the average. (d-i) Scatter plots between the (1st-order) Heaps’ exponents β1 and the nth-order exponents βn, with n = 2 (d-f) and 3 (g-i). Each point refers to a different sequence, with colors representing the density of points (see color bar). Each panel also reports histograms of exponents distributions, the bisector y = x (dashed gray line), as well as the fitted linear model (dotted red line) with the value of its coefficient of determination R2. Each column refers to a different data set: (a,d,g) Last.f m, (b,e,h) Project Gutenberg and (c,f,i) Semantic Scholar, respectively. 4/34value of β1 can have very different values of β2. Conversely, the other two data sets present stronger correlation between β2 and β1. To quantitatively characterize this, we fit a linear model with an ordinary least squares method, displayed in each plot as a red dotted line. In the legend we also report the value of the related coefficient of determination R2, which represents the percentage of variance of the dependent variable explained by the linear fit with the independent variable. For the Last.f m data set, points are much more spread around the linear fit compared to the other two data sets, as also confirmed by the values of R2, indicating a greater variability in listening habits compared to writing habits. Moreover, the values of the parameters of the linear fit greatly change across data sets and orders. In particular, Last.f mi s characterized by a much lower slope and intercept compared to the other data sets for the same order. Furthermore, we notice how, for each data set, the values of β3 are much much higher and more spread than the respective values of β1 and β2, resulting in lower values of R2 in the linear fit between β1 and β3. At an aggregate level, we observe that at all orders the distribution of the Heaps’ exponents are very different across data sets (see Fig. S2 in SI for a comparative figure, while further statistical information on the Heaps’ exponents distribution can be found in Table S2 in SI). The exponents are more spread in Last.f m, which also shows a higher average of β1 and β2, but a lower one for β3 compared to the other data sets. Distributions for Project Gutenberg and Semantic Scholar, which are both related to linguistic data, are more peaked. Such peaks appear at higher values for the latter data set. This could be the result of how titles of scientific papers are written with respect to books or poems, that i s, concentrating the whole message of a scientific work in a few significant and specialised words, avoiding stop-words and repetition. In addition, scientific advancements tend to favor the combinations of previously existing scientific concepts to form new ones, while the same does not apply to non-scientific literature in general, where instead similar constructions tend to be repeated across the piece. Finally, similar results are obtained also for more coarsegrained sequences generated by using artists and stemmed words instead of songs and words (see Fig S3 in SI). Furthermore, in Fig S4 in SI we analyse higher-order novelties in the collective sequences obtained by randomly concatenating all the individual sequences of each data set1.

Analysis of existing models After studying higher-order Heaps’ laws in real data, we check whether the observed patterns can be reproduced by the available models of discovery processes. We start this analysis from the Urn Model with Triggering (UMT). In such a model, sequences of events are generated by the extraction of colored balls from an urn1, where different colors correspond to different events or items being discovered or adopted. Here, an event in the sequence is simply represented by the color extracted. In the UMT, for each extracted ball, the corresponding color is reinforced by adding ρ additional balls, of the same color, to the urn. At the same time, whenever a novel color is drawn, the discovery triggers the addition of ν + 1 balls of new different colors to the urn (see detailed model definition in Materials and Methods). The reinforcement process ensures the wide-spread adoption of items or concept that were frequently adopted in the past. Conversely, the triggering mechanism mimics the adjacent possible expansion, since each novelty makes the space of possible colors expand. Intuitively, these two parameters modulate the exploit-explore tendency of the system, with a more pronounced exploratory behavior for larger ν/ρ ratios. Previous studies have shown that the 1st-order Heaps’ law is verified in sequences generated by UMT simulations1, 6. In particular, the number of novelties in the model grows asymptotically as D1(t) ∼ t ν ρ when ν < ρ, while a linear behavior is found for ν > ρ. We hence focus on the most interesting case ν ≤ ρ, studying how variations of the two parameters ρ and ν, respectively representing the reinforcement and the increase in size of the adjacent possible, affect the Heaps’ law at various orders. Since the pace of discovery effectively depends only on the fraction ν/ρ, we fix ρ = 20 and numerically simulate the UMT with ν = 1, 2, 3, . . . , 20 for T = 105time-steps, obtaining sequences of length comparable to the data sets (see Fig. S1 in SI). For each set of parameters we run 100 simulations, generating a total of 2 × 103 synthetic sequences. Then, for each generated sequence, we compute the temporal evolution of the number of novelties Dn( t), and estimate a power-law fit, extracting the related nth-order Heaps’ exponent βn. In Fig. 2(a), we show how the extracted values of β2 change with respect to β1 across simulations. The color represents the value of the parameter ν, as indicated by the color bar. We observe that, although the exponents span the interval (0, 1), the points (β1, β2) are aligned just above the bisector (gray dashed line). In other words, the values of β2 are highly correlated with the related values of β1. We can derive an analytical approximation of the higher-order Heaps’ exponents for this model, as we show in Sec. S3.2 of the SI. We obtain that the number of unique pairs for the UMT approximately grows asD2(t) ≈ atβ2, with β2 = β1 + cd + log( t) , (1)where a, c, d > 0 depend on the parameters ρ and ν, and β1 = ν/ρ. Although the predicted 2nd-order exponent is slightly higher than the 1st-order one, their difference just depends on the sequence length, and vanishes at larger times. Therefore, the difference between β1 and β2 observed in the simulations is only due to finite time effects, revealing how the UMT cannot reproduce the empirical patterns of Fig. 1. Due to the same reason, notice how the fitted values of β1 in the simulations of the UMT are lower than the asymptotically expected value of β1 = ν/ρ for high values of ν, as also shown in Fig S6(a) in SI.

We repeat the analysis for two other generative models5/34


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 a UMT( = 1) y=x


## 5 10 15 201 20


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 b UMST( = 0.1)


## 5 10 15 201 20


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 c ERRW


## 2.5 5.0 7.5 10.00.1 10.0

dwFigure 2. Higher-order Heaps’ exponents in existing models. Scatter plots of the (1st-order) Heaps’ exponent β1 against the 2nd-order exponent β2 i n: (a) the urn model with triggering (UMT), no semantic correlations (η = 1), and ρ = 20, ν = 1, 2, . . . , 20; (b) the urn model with semantic triggering (UMST) with η = 0.1 and ρ = 4, ν = 1, 2, . . . , 20; (c) the edge-reinforced random walk (ERRW) on a small-world network (average degree ⟨k⟩ = 4 and rewiring probability p = 0.168) with edge reinforcement ρ ranging geometrically from 0.1 to 10. Each point refers to a different simulation of the related model, with colors representing the value of the free parameter (see color bar). Each panel also reports histograms of exponent distributions on the respective axes, and the bisector y = x (dashed gray line). All simulations have run for 105 time steps.

for discovery and exploration processes, i.e., the Urn Model with Semantic Triggering (UMST)1 and the Edge-Reinforced Random Walk (ERRW)3, which have been proved to generate sequences obeying to the Heaps’ law. These models share the same foundations of the UMT, but with some crucial differences. The UMST builds on top of the UMT introducing also semantic groups for colors. This addition effectively diminishes the probability to draw colors outside the semantic group of the last extracted color by a factor η ≤ 1. The ERRW, instead, is formulated as a network exploration rather than a process of extractions from an urn. Instead of a sequence of extracted balls, the ERRW generates a sequence made of the nodes sequentially visited by the edge-reinforcing random walker over a weighted network, where the weight of the visited edges are reinforced by ρ when crossed. A full description of the models can be found in Materials and Methods. We simulate the UMST with parameters η = 0.1 (semantic parameter), ρ = 4 (reinforcement parameter), ν = 1, 2, . . . , 20 (triggering parameter), while the simulations of the ERRW run over small-world networks69, 70 (with average degree ⟨k⟩ = 4 and rewiring probability p = 0.1 following the procedure of Ref.68), with edge reinforcement ρ ranging from 0.1 to 10. Similarly to the UMT, we perform 100 simulations for each set of parameters, and report the results in Fig. 2(b-c). For both UMST and ERRW, we find that the values of β2 do not differ much from their corresponding value of β1—a s shown by the great proximity of the points (β1, β2) to the bisector. This means that also these models fail to reproduce the empirical variability of higher-order Heaps’ exponents with respect to the 1st-order one. Moreover, we notice in (b) that for the UMST we only obtain exponents with either very low (u pt o


## 0.4) or very high (close to 1) values. We indeed see an abrupt

transition between these two extremes, with the model not able to cover the values in between, which are instead present in the empirical data reported in Fig. 1 (see also the relation with analytical results in Fig S6 in SI). Further simulations of both the UMST and ERRW with other sets of parameters are reported in Fig. S7 of the SI. Also in these other cases, these models are unable to generate sequences with β2 different from β1.

Overall, the analyses above indicate that, while the existing models of discovery and innovation dynamics are able to reproduce the empirically observed pace of discovery of new items (singletons) as captured by the 1st-order Heaps’ law, they fail to capture the distributions of Heaps’ exponents of higher order.

The ERRWT: a model for higher-order Heaps’ laws In order to fill the gap between empirical observations and models, we introduce here a new model that can generate synthetic sequences with tunable discovery paces both at the first order and at higher orders. As for the previously discussed ERRW, our model is formulated in terms of network exploration. Namely, in the model: (i) the items to be explored correspond to the nodes of the network, (i i) the links between nodes represent semantic associations between items that one can use to move from one to another, and (iii) the exploration process is modelled as a random walk over the network and the sequence is obtained from the ordered list of visited nodes. Under these assumptions, the first visit of a node corresponds to a 1st-order novelty, while the first visit of a link corresponds to a 2nd-order novelty. Such definition can be straightforwardly extended to higher orders. In this manuscript, for simplicity, we limit our attention to the first two orders. The ERRW proposed in Ref.3 consists of6/34a random walk on a network whose topology is fixed, i.e., the links cannot change in time, but the link weights can be modified by the passage of the random walker. By contrast, in our model not only the weights, but the entire network structure c o-evolves with the exploration process, and new nodes and new links can be triggered. Thus, in analogy with the UMT1, we name the model Edge-Reinforced Random Walk with Triggering (ERRWT). More specifically, on top of the edge reinforcement mechanism of the ERRW, the model is based on two different triggering mechanisms that add new edges and new nodes every time a novelty appears. Similarly to the previous models analysed before, the first visit of a node triggers the expansion of the adjacent possible, as new nodes, neighbors of the discovered node, become now accessible. As an example of this mechanism, think for instance to the invention of the transistor, which made it possible to create mobile phones, among other things. Moreover, differently from the previous models, here the first visit of an edge is also considered a novelty, and as such, it triggers new edges. The idea is that whenever two elements are associated for the first time, new possible combinations involving one of these elements are then triggered. For instance, once photo-cameras and mobile phones were firstly combined, this association made clear that many more functions could be added to the latter, e.g., a music player, a game console, a GPS, etc. More formally, the model considers that the adjacent possible can be expanded at various orders, i.e., not just by introducing new nodes, but also by triggering new links.

The basic mechanisms of the ERRWT model are illustrated in Fig. 3. Suppose that at a given time t, the walker is located at node io fa network. At this point, some nodes and links, represented by full circles and solid lines in Fig. 3(a), have already been visited, while others, shown as empty circles and dashed lines, are part of the adjacent possible. In Fig. 3(b), the walker moves from node it o node j, crossing in this way an already explored link. Consequently, the weight of such link is increased by a positive quantity ρ, meaning that the association between the two nodes i and j becomes stronger and thus more likely to be used again. This is the same edge reinforcement mechanism adopted in the ERRW model3. In addition to this, if instead the walker moves from node it o node k, traversing an edge for the first time, as displayed in Fig. 3(c), this event is considered a 2nd-order novelty and triggers the creation of new edges. In particular, ν2 + 1 new edges connecting node kt o other already-visited nodes are created (green dashed lines). Finally, the third mechanism of the ERRWT model is analogous to the triggering mechanism of the UMT model. As illustrated in Fig. 3(d), when the walker moves from it oa node l, visiting node l for the first time, this event triggers the expansion of node l’s adjacent possible with the addition of new nodes and new links. Namely, ν1 + 1 new nodes are added to the network and connected to the node l itself. In addition to this, ν2 + 1 new links to already known elements are created, since whenever a node is explored for the first time, also the link leading to i ti s explored for the first Figure 3. The Edge-Reinforced Random Walk with Triggering (ERRWT) model. An exploration process is modelled as a random walk on a growing weighted network. (a) At time t, the walker is at the red node i. Nodes that have been already visited by the walker are colored in black, in white those left to be visited. Similarly, traversed (old) and not-traversed (new) links are respectively depicted with continuous and dashed lines, whose widths represent their weights. At time t + 1, the walker can move to each of the neighbours of i, e.g. nodes j, k, or l, with a probability proportional to the weight of the respective link. (b) If the walker moves to j, the weight of the link (i, j) is reinforced by ρ (Edge Reinforcement mechanism), but no new nodes or links are added to the network, since the link (i, j) is old; (c) if the walker moves to node k, since link (i, k) is new but node ki s old, in addition to the edge reinforcement, ν2 + 1 = 2 new edges (i n green) between k and old nodes are added to the network (Edge Triggering mechanism); (d) finally, if the walker moves to l, since both the link (i, l) and the node l are new, in addition to the edge reinforcement and the edge triggering, ν1 + 1 = 3 new nodes (i n green) are added to the network and connected to l (Node and Edge Triggering mechanism). 7/34time. More details about the ERRWT model can be found in Materials and Methods.

Balancing edge reinforcement and node and edge triggering mechanisms through the parameters ρ, ν1 and ν2 of the ERRWT model, it is possible to control the pace of discovery of new nodes and edges, and consequently tuning the exponents of the 1st-order and the 2nd-order Heaps’ law associated to the sequences produced by the model. To systematically explore this, we simulate the ERRWT model with parameters ρ = 10, ν1 = 0, 1, . . . , 20, and ν2 = 0, 1, . . . , 2ν1, running 100 simulations for each set of parameters. Higher values of ν2 have not been considered since they produce the same exponents as those for ν2 = 2ν1. In Fig. 4(a) we report the increase in the number of 1st-order and 2nd-order novelties (continuous lines) for a specific set of parameters as an example. The power-law fits (dashed lines) highlight that the Heaps’ law is verified at the 2nd order too, leading to an increase of the exponent values (from β1 = 0.56 to β2 = 0.87). The relation between the different orders is explored in the scatter plot between the 1st- and 2nd-order Heaps’ exponents reported in Fig. 4(b). Each point refers to a different simulation, and we use the color to indicate the value of the parameter ν1 used (see color bar). We notice that the ERRWT model can produce a wide range of values for the exponents at both orders, and that the 2nd-order exponents are not trivially correlated to the 1st-order ones, as it happened in the models considered in the previous section. This is even more clear when we look at Fig. 4(c), where the Heaps’ exponents are averaged across simulations for each set of parameters. Each curve in the figure refers to a different value of ν1, with ν1 increasing from 1 to 20 from bottom left to top right of the panel. The color represents instead different values of the parameter ν2 from 0 to 2ν1. For reference, we also flag using a red dot the pair of exponents related to the parameters used in Fig. 4(a). We can immediately notice how the 1st- and 2nd-order Heaps’ exponents increase as ν1 gets larger. More interestingly, we observe the combined role of the two parameters. For each curve, by increasing ν2, therefore triggering new links in the network, the difference between β1 and β2 becomes larger, and the point (β1, β2) moves away from the bisector, in a way that depends on the specific value of ν1. In particular, for low values of ν1, the curves are almost vertical, with only β2 increasing. Instead, for higher values of ν1, especially when ν1 ≥ ρ, an increase of ν2 produces a decrease of β1, while the value of β2, which is close to its upper bound value 1, does not change. Intuitively, this happens because the creation of more and more new links between explored nodes increases the chance to exploit nodes already discovered, while still exploring never traversed links. It is also possible to perform an analytical investigation of a simplified version of the ERRWT model, which leads to results in agreement with the simulations (see Sec. S4 in SI). In particular, for such a simplified model, we can prove that the values of the asymptotic Heaps’ exponents β1 and β2 depend on the two ratios ν1/ρ and ν2/ρ. Moreover, we find that, for ν1/ρ > 1, the 2nd-order Heaps’ exponent is asymptotically equal to 1, while the 1st-order one depends on ν1/ν2, as seen in Fig. 4(c). Finally, the exponents are asymptotically bounded by β1 ≤ β2 ≤ 2β1, as also observed in the simulations in Fig. 4(c). This also explains why the exponents do not change when we increase ν2 above 2ν1.

Comparison between ERRWT and real-world data To show that the ERRWT model is able to reproduce the properties observed in real-world processes, we now fit the parameters of the model to the three data sets analyzed (Last.f m, Project Gutenberg and Semantic Scholar). Given an empirical sequence and its pair of 1st- and 2nd-order Heaps exponents (β1, β2), we compute the Euclidean distance between the pair (β1, β2) and each of the pairs of exponents (β ′


## 1, β ′


## 2) o b-

tained by simulating the ERRWT model using the sets of parameters considered in the previous section. We then select the best model parameters by minimizing the average distance over 100 simulations for each set, and repeat the procedure for all the sequences of the three data sets. Figure 5(a) shows the probability density distribution of the distances between the empirical sequences and the simulations of the best-performing ERRWT model. Notice how these distances are almost all below 0.1, that is the uncertainty we expect on the values of the parameters. Indeed, being ν1, ν2 integers and ρ = 10, the maximum precision we can gain on the estimate of the best parameters is about 1/ρ = 0.1. The percentage of sequences with higher distance than this threshold is 7.67%, 0.73%, and 0.05% for Last.f m, Project Gutenberg, and Semantic Scholar, respectively. The scatter plots of the best-fitted parameters ν1 and ν2 for the three data sets are shown in Fig. 5(b-d). The colors here indicate the number of empirical sequences which are best represented by each pair of parameters ν1 and ν2. We notice that most of the sequences of Last.f m are characterized by relatively large values of ν1. Since ν1 is related to the triggering of new nodes, this result indicates that the discovery of a new song exposes the user to a large variety of related songs, previously not accessible, which can now be discovered. Conversely, the parameter ν2, which controls the triggering of new edges between already existing items in the model, takes values in a larger range, predominantly skewed towards the lower end. This suggests that, once a new association between two songs is established by a user, there is a high probability that the same association will be repeated over and over. Consequently, the user will preferably listen to songs in a similar order, instead of creating new associations. We point out that we cannot distinguish if this is due to individual preferences or is pushed by the presence of recommender systems in music listening platforms. In the case of Project Gutenberg, most sequences have ν2 > ν1. This implies that writers tend to frequently generate new word associations instead of using words never used before in the text, highlighting the incredible variety of expressions we can make by combining a limited set of words. Finally, Semantic Scholar exhibits values of ν1 and ν2 similar to those found8/34


## 102 103 104 105

t101102103104Dn( t) a = 10


## 1 = 10


## 2 = 15

D1(t) 1.00t0.56 D2(t) 1.00t0.87


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 by = x


## 0 5 10 15 200 20

1


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 cy = xy = 2x


## 1 = 10


## 2 = 15


## 0 2 1

2


## 1 = 1


## 1 = 20

Figure 4. Higher-order Heaps’ exponents in the ERRWT model. (a) Average number Dn( t) of novelties of order n, with n = 1 and 2, as a function of the sequence length t for simulations of the ERRWT model with parameters ρ = 10, ν1 = 10, ν2 = 15, and fit of the associated Heaps’ laws (dashed lines), with estimated exponents shown in the legend. Shaded areas represent one standard deviation above and below the average. (b) Scatter plot between the (standard) Heaps’ exponent β1 and the 2nd-order exponent β2. Each point refers to a different simulation of the model, with colors representing the corresponding value of the parameter ν1 ranging from 0 to 20 (see color bar), while ρ = 10 and ν2 = 0, . . . , 2ν1. (c) Variation of the average nth-order Heaps’ exponents βn, with n = 1, 2. Each curve refers to a different value of ν1, increasing from 1 to 20 from bottom left to top right, while the color represents the value of ν2 (see color bar). The set of parameters used in (a) is here highlighted in with a red dot.


## 0.1 0.2 0.3

dist0102030pdf a Last.f m Project Gutenberg Semantic Scholar


## 0 10 20

10102030402 b Last.fmy = xy = 2x


## 100 101100 101

count


## 0 10 20

10102030402 c Project Gutenberg


## 100 102100 101 102 103


## 0 10 20

10102030402 d Semantic Scholar


## 100 102100 101 102 103

Figure 5. Fitting the ERRWT model to real-world data sets. (a) Distribution of the average distance between the pair of exponents (β1, β2) of a real sequence and the pair (β ′


## 1, β ′


## 2) obtained by the best fitting ERRWT model. (b-c) Scatter plots o f

the best-fitted parameters ν1 and ν2 of the model across the sequences of the three data sets, respectively Last.f m (b), Project Gutenberg (c), and Semantic Scholar (d). The color of a point refers to the number of sequences with that pair of parameters in the best fitting ERRWT model (see color bar). 9/34in the Project Gutenberg data set. However, some sequences of Semantic Scholar have a relatively high value of ν1 with respect to ν2. This is an indication that, when choosing words for titles, authors tend to use more original words, while the pace of creation of new word associations remains similar.


## Discussion

The extraction of the Heaps’ exponent from empirical sequences has recently allowed to characterize the pace at which discoveries occur in different contexts1–3, 71, 72. However, there is more and more evidence that discoveries are often made from novel combinations of already known elements46, 48, 49, 55, 56. In this manuscript we have proposed to explore higher-order Heaps’ laws and to extract higher-order Heaps’ exponents as a way to characterize novel combinations in an exploration process. The key idea is to look at novelties not only as discoveries of single items, but also as the first appearances of new combinations of two or more items. More precisely, the Heaps’ exponent of order n measures the rate of discovery of novelties of order n, i.e., combinations of n items. Notice that our approach differs and complements other measures of the pace of discovery recently proposed. For example, the authors of Refs.8, 73 have investigated the number of all possible valid combinations that can be created by using the elements acquired so far as a proxy of the level of innovation of a given system. In this way, the potential for new discoveries is accounted for, rather than the actual number of novel combinations observed in a system and their rate of appearance. As we have shown through the analysis of empirical sequences of music listening records, higher-order Heaps’ exponents can be used to further classify users of Last.f m with the same rate of discovery of new songs or new artists. The higher-order Heaps’ exponent can indeed tell apart different ways to explore the same set of songs in terms of number of different associations of consecutive pairs or triples of songs. Analogously, we found that higher-order Heaps’ exponents can uncover different patterns in the use of words in different texts. Titles of peer-reviewed papers published in scientific journals show more creative combinations of words, than the texts of narrative books. They indeed exhibit many more new n-grams, even if the total set of words used is similar in length. Overall, our analysis shows that the space of possibilities grows in a complex way, which does not depend solely on the balance between old items to exploit and new ones to explore, but also on the structure of their associations. Notice, however that in our framework we have considered all associations of consecutive items in a sequence as possible discoveries. This is certainly a strong assumption, which might not always be valid. For instance, in the context of a written text, the last word of a paragraph and the first word of the following paragraph, are not necessarily related to each other and could be discarded from the sequence of pairs to be analyzed. The problem can be solved by filtering out all such cases, as we have done for books in Gutenberg in Fig. S5, obtaining similar results in terms of 1st-order and higher-order Heaps’ exponents. In other contexts, it might be necessary to better tailor the precise definition of “novel combination” according to the nature of the sequence being analysed and the underlying research question. We have then focused our attention in understanding the underlying mechanisms that can trigger higher-order novelties. We have proposed a new modelling framework, the ERRWT which takes into account not only the exploration rate of new items, but also the propensity to explore the same content in a more creative way. Considering that pairs of items can be seen as the links of a network, the model is based on a process of network exploration and on the c o-evolution of the network structure with the dynamics of the exploration process. The model considers a reinforcement of the visited links and the triggering of new nodes and links whenever new nodes or links are explored. Not only the ERRTW model is able to reproduce the higher-order Heaps’ exponents extracted from real data, but also provides a new intuition of how the space of possibilities grows over time, shedding light on the underlying mechanism in which novel elements and combinations emerge. We acknowledge there are various ways in which our model can be improved and generalized. For example, future work should investigate the interplay between initial knowledge, either of the individual or o fa group, and the pace of discovery at various orders during the exploration process, or the influence of recommendation algorithms. In our model, we have supposed that the links all start with the same weight, which can be a too strong assumption in certain contexts. Moreover, we have assumed to trigger new links with a uniform probability. It would be interesting to study cases in which the space has some preferential pathways, for example represented by an underlying network structure. This could be implemented in our model by limiting the addition of new links to only those permitted by an underlying network given as an input to the model. Alternatively, more complex ways to trigger edges, such as preferential attachment mechanisms, could be considered 74, 75. Finally, we have not considered the presence of semantic correlations in the temporal sequence of visited items, which can be a consequence of the interplay between the network topology and a predisposition to move within items semantically close to the recent ones, reinforcing a clustered structure. It would indeed be interesting to use higher-order Heaps’ exponents and the ERRWT model to study phenomena related to waves of novelties2 and popularity76. Moreover, the ERRWT model could be extended to a multi-agent model to study how different agents would cooperate and diffuse knowledge14, 37, also taking into account the presence of a limited attention capacity and memory that could influence the rise and fall of popular items77. We believe that our model can be directly used to answer these questions and, more in general, to better understand the fundamental mechanism behind innovation and creativity. 10/34


## Methods

Data In this work we consider three different data sets: music listening records (Last.f m), books (Project Gutenberg), and scientific articles (Semantic Scholar).

Last.f mi sa digital platform for music born in 2002, famous for logging all listening activities of its users, providing both personal recommendations and a space to interact with other users interested in music78. In this manuscript, we use a data set presented in Ref.79 and available at Ref.80. This data set has been obtained and used according to terms and conditions of Last.fm78, and can only be used for non-commercial use80. It contains all listening records of about 1000 users. In order to have sequences long enough for statistically relevant fits, only users with more than 1000 logs have been retained. The final data set contains 890 users having a median number of listened records of 13 985. Each record contains the timestamp at which a user listened to a given song. In the database, each song is associated to a title, the artist’s name and a unique MusicBrainz Identifier (MBID), which can be used to obtain additional metadata81. Using this information, we are able to create, for each user, a temporally ordered sequence of songs together with the associated sequence of artists. It is worth noting that the behavior of each user might be influenced by additional factors, such as recommendation algorithms. While the specifics of these procedures are not known in details, we expect that they would not drastically alter our main findings2. They may, for example, impact only the numerical values obtained, without affecting the fundamental mechanisms captured by our modelling approach.

Project Gutenberg is an open access text corpus containing more than 50 000 books of different nature82. This corpus is made of public domain books, with expired copyrights, which can therefore be disseminated freely and legally. Here, we make use of the Standardized Project Gutenberg Corpus83, which allows to download and process an updated version of the open corpus. Using Google’s Compact Language Detector


## 3 (cld3 package in Python), we filter out all non-English

texts. We then discard all texts with less than 1000 words, retaining a total of 19 637 books with a median number o f


## 50 726 words. A sequence of events for each book is hence

created with the lemmatized words, disregarding punctuation and putting all characters in lower case. We also extract stems from each word using the English Snowball stemmer84—a more accurate extension of the Porter stemmer85—, which is not as aggressive as the Lancaster stemmer86.

Semantic Scholar is a recent project with the scope of facilitating scientific analysis of academic publications87. It provides monthly snapshots of research papers published in all fields, publicly and freely accessible through the Semantic Scholar Academic Graph (S2AG, pronounced “stag”)88. This database (1st Jan. 2022 snapshot) contains about 203.6M papers, 76.4M authors, and 2B citations, obtained in accordance with the project terms and conditions89. It also classifies each paper into one or more fields of study90, for a total of 19 different fields. For simplicity, we associate each paper to its first (and most relevant) field of study. To create the sequences to analyze, for each field we consider the first 1000 journals in terms of number of English papers. Then, for each journal, we order the published papers based on the respective year of publication, volume, issue, and first page. When some of this information is not available, the Semantic Scholar unique ID of the paper is also used in the ordering process. Thus, for each paper, we extract and lemmatize their title, similarly to what done for the Project Gutenberg. Finally, a sequence of events is created for each selected journal, concatenating the lemmatized words in the titles of each paper in their temporal order, for a total of 19 000 sequences with median length o f


## 9 114.5. Associated to each sequence, we also consider the

sequence of stemmed words for further analysis, similarly to the Project Gutenberg corpus..

Power-law fit Fundamental for the estimation of the higher-order Heaps’ exponent of a sequence is the power-law fitting procedure for the number of novel n-tuples Dn( t) as a function of the sequence length t, with n ≥ 1. The sequences analyzed in this manuscript come from very different contexts, from empirical data sets to model simulations. We thus need to take into consideration all those cases that show a transient regime— whose length might also depend on the system structure37—i n which the pace of discovery can fluctuate before reaching its stationary value. Therefore, we fit each sequence according to the following procedure. To reduce computational times, we first logarithmically sample 1000 real points in the range [1, T ], where T is the length of the sequence. Considering their integer part, we discard all the duplicates that may be produced when some sampled points differ only for the decimal part. We thus obtain a set of k integer times {t i}i=1,...,k between 1 and T . Due to the removal of duplicates, k can be equal or smaller than 1000. If T ≥ 1000, that is the case of all sequences analyzed in this manuscript, then this process results in k ≥


## 424 points. Taking into account that the associated sequence

o f n-tuples has length T − n + 1, we thus consider the points {(t i − n + 1, Dn( t))}i=1,...,k in logarithmic scale, i.e.,(x i, y i) = (log10(t i − n + 1), log10(Dn( t))) , (2)with i = 1, . . . , k. In order to neglect the initial transient regime, but still have enough points for a sufficiently significant fit, we select only the last 100 of such points. We hence look for the best fit of {(x i, y i)}i=k−100+1,...,k by optimizing the linear function y = a + b x, with a ≥ 0, using the tool curve fit of the Python package Scipy91. The constraint a ≥ 0 is necessary to avoid that the fitted Heaps’ exponent is greater than 1, which could happen when the initial transient regime differs significantly from the asymptotic one and could hence produce wrong fits. Finally, if a and b are the best parameters, then the power-law fit of the Heaps’ law is Dn( t) ≈ 10a t b,11/34that i s, the nth-order Heaps’ exponent is approximated by the slope bo f the fit.

Urn Model with (Semantic) Triggering The Urn Model with Triggering (UMT) is a random generative model for discovery processes, producing a sequence of extractions of balls of various colors from an urn. First introduced in Ref.1, it successfully reproduces the main features of empirical discovery processes1, 6, 59, 92. The UMT can be thought as an extension of P´olya Urn processes33, 34, 93–95that includes the concept of adjacent possible26 in the way a novelty can trigger further ones2, 32. Differently from the classic urn of P´olya in which only balls of existing colors can be added to the urn, the UMT features a growing number of colors, that i s, the set of possible events expands together with the exploration process. It is hence the process itself that shapes the content of the urn by reinforcing elements already discovered and adding new possibilities. Supposing that the urn initially contains N0 balls of different colors, the UMT works as follows. At each discrete time-step t, a ball is randomly drawn from the urn with uniform probability, and its color is marked in a temporally-ordered sequence of events S at position t. The extracted ball is then put back in the urn together with other ρ copies of the same color, in a rich-get-richer manner74. This mechanism ensures that frequently adopted items, visited places, or exploited concepts will be more and more likely to be adopted, visited, or exploited in the future. Furthermore, if the color of the extracted ball has never appeared before in S , this event is considered to b ea novelty. As a consequence it triggers new possibilities, represented by the addition of ν + 1 balls—each of a new different color—into the urn. This triggering mechanism thus ensures the expansion of the space of possibilities.

In a different version of the model, the Urn Model with Semantic Triggering (USMT), the sequences produced contain semantic correlations between consecutive extractions, as seen in the data1. The UMST works similarly to the UMT, but with the introduction of semantic groups for colors. In particular, at each triggering event, supposing that the triggering color belongs to the group A, the new ν + 1 colors are assigned to a common new group B, semantically related to the triggering color. Therefore, a color io f label A is semantically related to all other colors of label A (siblings), the color that triggered the addition of A in the urn (parent), as well as all colors of label B that have been triggered by i (children). Taking this into consideration, at each extraction, the probability to extract each color changes depending on a fixed parameter η ∈ [0, 1]. A ball has weight 1 if its color is semantically related to the one extracted on the previous time-step, otherwise it has weight η. Notice that we can recover the original UMT by simply considering η = 1. Finally, as shown in Ref.1, the effect of N0 is negligible at large times. For simplicity, we thus consider N0 = 1 in our simulations of both UMT and UMST. Edge-Reinforced Random Walk Given a weighted connected graph G = (V , E ) with N = |V | vertices (nodes) and M = |E | edges (links), the EdgeReinforced Random Walk (ERRW) is a dynamical process that reinforces the weights of the visited edges in E , leading to Heaps’ laws3. The weights of the links in the network quantify the strength of the relationship among nodes, and are encoded in a time-varying adjacency matrix W t ≡ {w ti j}. This matrix features non-zero entries wt ij when at time t the link connecting node i and node ji s different from zero. Let us assume that at time t = 0 each link (i, j) ∈ E has weight w 0 ij = 1, while all other weights are set to zero. At each time step, a walker at node i walks to a neighboring node j with a probability that is proportional to the weight of the outgoing links, i.e., P( i → j) = wt i j/ ∑l wt i l. After moving to the randomly chosen node j, a reinforcement ρ is added to the weight of the traversed edge (i, j), i.e., w t+1 ij = wt ij + ρ. Starting from an underlying structure given by the graph G, the ERRW can generate sequences of visited nodes with a tunable pace of discovery obtained by properly calibrating the reinforcement parameter ρ 3. Because of the interplay between structure and dynamics, different structures might require different values of the reinforcement parameter to reach the same pace of discovery. For example, higher values of ρ must be chosen for a denser graph. This is similar to what happens in the UMT, in which we need higher values of the reinforcement parameter ρ to obtain the same pace of discovery as we increase the triggering parameter ν.

Edge-Reinforced Random Walk with Triggering In this manuscript we propose a generative model of a discovery process based on the exploration of a growing network, i.e., the Edge-Reinforced Random Walk with Triggering (ERRWT), which can be considered as a UMT-inspired extension of the ERRW model. For this model, any initial connected network G0 = (V 0, E 0) with N0 = |V 0| ≥ 1 nodes and M0 = |E 0| links can be used. Let us suppose that the nodes of the graph are indexed, that i s, V 0 = {1, 2, . . . , N0}. Similarly to the ERRW model, we assume that all initial links (i, j) ∈ E 0 have weight w 0 ij = 1. The initial node to start the exploration process is randomly selected from V 0. We let the graph evolve during the process, adding new nodes and links. Let Gt = (V t , E t ) be the graph at time t. The structure of the growing network is encrypted in the time-varying weighted adjacency matrix W t ≡ {w ti j}, where wt ij represents the weight of the link (i, j) at time t. We assume here that Gtis an undirected graph, so the matrix W ti s symmetric, and any variation of w ti j affects wt ji too. Supposing that at time t the ERRWT is positioned on node io f Gt , the model obeys to the following rules.

• Choice of next node. The ERRWT randomly moves to a neighbouring node jo f the current node i. The probability to move to node j depends on the weight of12/34the outgoing links of i, i.e.,P( i → j) = wt ij ∑l wt il . (3)• Edge reinforcement. The weight of the chosen edge (i, j) is reinforced by ρ, that i s,w t+1 ij = wt ij + ρ. (4)• Edge triggering. If the walker never traversed the chosen edge (i, j) before, i.e., it i sa new link, then ν2 + 1 new possible links are added to the network. These links are connections of unitary weight between j and previously visited nodes l = l 1, . . . , lν2 in V t, for which the link ( j, l) has never been traversed by the walker. If one of these edges already exists in the space of possibilities, its weight is reinforced by one more unit, otherwise, it is added to E t+1. In other words, we havew t+1 jl = wt jl + 1, l = l 1, . . . , lν2 | l old, ( j, l) new. (5)• Node triggering. If the walker never visited the chosen node j before, i.e., it i sa new node, then ν1 + 1 new possible nodes are added to the network; these are connected to node j with unitary weights. Mathematically, we haveV t+1 = V t + {l}l=|V t |+1, ..., |V t |+ν1+2 w t+1 jl = 1, l = |V t | + 1, . . . , |V t | + ν1 + 2. (6)Notice that if the chosen node ji s new, then also the traversed edge (i, j) is necessarily new as well. Therefore, in this case there is also a triggering of ν2 + 1 edges from jt o other previously visited nodes, as described before.

Finally, in this manuscript, we let the initial graph G0 be a small graph that emulates the triggering mechanism introduced, shown in Fig. S11 in SI. This is a regular tree with branching parameter ν1 + 1 and two levels, where only the leaves are considered new, since all other nodes have already triggered. In other words, a root node has triggered ν1 + 1 nodes connected to i t, and again these nodes have also triggered each ν1 + 1 other nodes. Therefore, we initially suppose that the triggered nodes, which are ν1 + 2 in number, are all known to the walker at the start of the simulation, and do not trigger again when later explored. Moreover, we assume that all links are new to the walker and have unitary weight. This initialization makes sure that in the initial stages of the simulation there are enough possible links between already known nodes. As we show in Sec. S4 in SI where we test different initial graphs, the initialization procedure only affects thermalization times, and becomes irrelevant asymptotically.

Data availability The data used in this manuscript is publicly available at Refs.80, 83, 88, and has been obtained and used according to their terms and conditions. Code availability All the code used to download, process and analyse the data and the models can be found at Ref.96.


## References


## 1. Tria, F., Loreto, V., Servedio, V. D. P. & Strogatz, S. H. The dynamics

o f correlated novelties. Scientific Reports 4, 1–8 (2014).


## 2. Monechi, B., Ruiz-Serrano, ˜A., Tria, F. & Loreto, V. Waves of novelties

i n the expansion into the adjacent possible. PLoS one 12, e0179303 (2017).


## 3. Iacopini, I., Milojevi´c, S. & Latora, V. Network dynamics of innovation

processes. Physical Review Letters 120, 048301 (2018).


## 4. North, M. Novelty: A history of the new (University of Chicago Press,

2013).


## 5. Rzhetsky, A., Foster, J. G., Foster, I. T. & Evans, J. A. Choosing exper-

iments to accelerate collective discovery. Proceedings of the National Academy of Sciences U.S.A. 112, 14569–14574 (2015).


## 6. Loreto, V., Servedio, V. D. P., Strogatz, S. H. & Tria, F. Dynamics o n

expanding spaces: modeling the emergence of novelties. In Creativity and universality in language, 59–83 (Springer, 2016).


## 7. Puglisi, A., Baronchelli, A. & Loreto, V. Cultural route to the emergence

o f linguistic categories. Proceedings of the National Academy of Sciences U.S.A. 105, 7936–7940 (2008).


## 8. Fink, T., Reeves, M., Palma, R. & Farr, R. Serendipity and strategy i n

rapid innovation. Nature communications 8, 1–9 (2017).


## 9. Saracco, F., Di Clemente, R., Gabrielli, A. & Pietronero, L. From

innovation to diversification: a simple competitive model. PLoS One 10, e0140420 (2015).


## 10. Abbas, K. et a l. Popularity and novelty dynamics in evolving networks.

Scientific Reports 8, 1–10 (2018).


## 11. Rodi, G. C., Loreto, V. & Tria, F. Search strategies of wikipedia readers.

PLoS One 12, e0170746 (2017).


## 12. Sreenivasan, S. Quantitative analysis of the evolution of novelty i n

cinema through crowdsourced keywords. Scientific Reports 3, 1–11 (2013).


## 13. Iacopini, I. & Latora, V. On the dual nature of adoption processes i n

complex networks. Frontiers in Physics 9, 604102 (2021).


## 14. Di Bona, G. et a l. Social interactions affect discovery processes. arXiv

preprint arXiv:2202.05099 (2022).


## 15. Yule, G. U. A mathematical theory of evolution, based on the conclusions

o fd r j. c. willis, f.r.s. Philosophical Transactions of the Royal Society of London 213, 21–87 (1924).


## 16. Simon, H. A. On a class of skew distribution functions. Biometrika 42,


## 425–440 (1955).


## 17. Herdan, G. Type-token Mathematics: A Textbook of Mathematical

Linguistics, vol. 4 (Mouton en company, 1960).


## 18. Heaps, H. S. Information Retrieval: Computational and Theoretical

Aspects (Academic Press, Inc., Orlando, FL, USA, 1978).


## 19. L¨u, L., Zhang, Z.-K. & Zhou, T. Zipf’s law leads to heaps’ law: Analyz-

ing their relation in finite-size systems. PloS one 5, e14139 (2010).


## 20. Estoup, J.-B. Gammes s t´enographiques (Institut s t´enographique d e

France, 1916).


## 21. Zipf, G. K. Relative frequency as a determinant of phonetic change.

Harvard studies in classical philology 40, 1–95 (1929).


## 22. Zipf, G. K. The psychobiology of language (1935).


## 23. Zipf, G. K. Human behavior and the principle of least effort. cambridge,

(mass.): Addison-wesley, 1949, p p. 573. Journal of Clinical Psychology


## 6, 306–306 (1950).


## 24. De Marzo, G., Gabrielli, A., Zaccaria, A. & Pietronero, L. Dynamical

approach to zipf’s law. Physical Review Research 3, 013084 (2021).


## 25. Taylor, L. R. Aggregation, variance and the mean. Nature 189, 732–735

(1961). 13/34


## 26. Kauffman, S. A. Investigations: The nature of autonomous agents

and the worlds they mutually create. In SFI working papers (Santa Fe Institute, 1996).


## 27. Packard, N. H. Adaptation toward the edge of chaos. Dyn. Patterns

Complex Syst. 212, 293 (1988).


## 28. Langton, C. Computation at the edge of chaos: Phase transition and

emergent computation (1990).


## 29. Langton, C., Taylor, C., Farmer, J. & Rasmussen, S. Artificial Life II

(Avalon Publishing, 2003).


## 30. Bak, P. & Sneppen, K. Punctuated equilibrium and criticality in a simple

model of evolution. Physical Review Letters 71, 4083 (1993).


## 31. Armano, G. & Javarone, M. A. The beneficial role of mobility for the

emergence of innovation. Scientific Reports 7, 1–8 (2017).


## 32. Gravino, P., Monechi, B., Servedio, V. D. P., Tria, F. & Loreto, V. Cross-

ing the horizon: exploring the adjacent possible in a cultural system. In Proceedings of the Seventh International Conference on Computational Creativity, Paris. (2016).


## 33. Eggenberger, F. & P´olya, G. ¨uber die statistik verketteter vorg¨ange.

ZAMM - Journal of Applied Mathematics and Mechanics / Zeitschrift f¨u r Angewandte Mathematik und Mechanik 3, 279–289 (1923).


## 34. Hoppe, F. M. P´olya-like urns and the ewens’ sampling formula. Journal

o f Mathematical Biology 20, 91–94 (1984).


## 35. Ubaldi, E., Burioni, R., Loreto, V. & Tria, F. Emergence and evolution

o f social networks through exploration of the adjacent possible space. Communications Physics 4, 1–12 (2021).


## 36. Marzo, G. D., Pandolfelli, F. & Servedio, V. D. P. Modeling innovation

i n the cryptocurrency ecosystem. Scientific Reports 12, 12942 (2022).


## 37. Iacopini, I., Di Bona, G., Ubaldi, E., Loreto, V. & Latora, V. Interacting

discovery processes on complex networks. Physical Review Letters 125,


## 248301 (2020).


## 38. Lakoff, G. & Johnson, M. Metaphors we live by (University of Chicago

press, 2008).


## 39. Pinker, S. The language instinct: How the mind creates language

(Penguin uK, 2003).


## 40. Boyd, D. M. & Ellison, N. B. Social network sites: Definition, history,

and scholarship. Journal of computer-mediated Communication 13,


## 210–230 (2007).


## 41. Tufekci, Z. Big questions for social media big data: Representativeness,

validity and other methodological pitfalls. In Proceedings of the international AAAI conference on web and social media, vol. 8, 505–514 (2014).


## 42. Cope, D. The Algorithmic Composer (2000).


## 43. Market, E. & Papavasiliou, F. N. V (d) j recombination and the evolution

o f the adaptive immune system. PLoS Biology 1, e16 (2003).


## 44. Jones, J. M. & Gellert, M. The taming of a transposon: V (d) j recombi-

nation and the immune system. Immunological Reviews 200, 233–248 (2004).


## 45. Fortunato, S. et a l. Science of science. Science 359 (2018).


## 46. Uzzi, B., Mukherjee, S., Stringer, M. & Jones, B. Atypical combinations

and scientific impact. Science 342, 468–472 (2013).


## 47. Ke, Q., Ferrara, E., Radicchi, F. & Flammini, A. Defining and identifying

sleeping beauties in science. Proceedings of the National Academy of Sciences U.S.A. 112, 7426–7431 (2015).


## 48. Wang, J., Veugelers, R. & Stephan, P. Bias against novelty in science: A

cautionary tale for users of bibliometric indicators. Research Policy 46,


## 1416–1436 (2017).


## 49. Fontana, M., Iori, M., Montobbio, F. & Sinatra, R. New and atypical

combinations: An assessment of novelty and interdisciplinarity. Research Policy 49, 104063 (2020).


## 50. Wu, L., Wang, D. & Evans, J. A. Large teams develop and small teams

disrupt science and technology. Nature 566, 378–382 (2019).


## 51. Alvarez-Rodriguez, U. et a l. Evolutionary dynamics of higher-order

interactions in social networks. Nature Human Behaviour 5, 586–595 (2021).


## 52. Schumpeter, J. A. et a l. Business cycles, vol. 1 (McGraw-Hill New York,

1939).


## 53. Schumpeter, J. A. Capitalism, socialism and democracy (routledge,

2013).


## 54. McNerney, J., Farmer, J. D., Redner, S. & Trancik, J. E. Role of design

complexity in technology improvement. Proceedings of the National Academy of Sciences U.S.A. 108, 9008–9013 (2011).


## 55. Abbasiharofteh, M., Kogler, D. F., Lengyel, B. et a l. Atypical com-

bination of technologies in regional c o-inventor networks. Papers in Evolutionary Economic Geography (PEEG) 20 (2020).


## 56. Lambert, B. et a l. The pace of modern culture. Nature Human Behaviour


## 4, 352–360 (2020).


## 57. Jin, C., Song, C., Bjelland, J., Canright, G. & Wang, D. Emergence o f

scaling in complex substitutive systems. Nature Human Behaviour 3,


## 837–846 (2019).


## 58. Leroi, A. M. et a l. On revolutions. Palgrave Communications 6, 1–11

(2020).


## 59. Tria, F., Loreto, V. & Servedio, V. D. P. Zipf’s, heaps’ and taylor’s laws

are determined by the expansion into the adjacent possible. Entropy 20,


## 752 (2018).


## 60. Sinatra, R., Condorelli, D. & Latora, V. Networks of motifs from

sequences of symbols. Physical Review Letters 105, 178702 (2010).


## 61. Ha, L. Q., Hanna, P., Ming, J. & Smith, F. J. Extending zipf’s law t o

n-grams for large corpora. Artificial Intelligence Review 32, 101–113 (2009).


## 62. Ryland Williams, J. et a l. Zipf’s law holds for phrases, not words.

Scientific reports 5, 12209 (2015).


## 63. Cs´anyi, G. & Szendr˝o i, B. Structure of a large social network. Physical

Review E 69, 036131 (2004).


## 64. Gl¨anzel, W. Characteristic scores and scales: A bibliometric analysis o f

subject characteristics based on long-term citation observation. Journal of Informetrics 1, 92–102 (2007).


## 65. Milojevi´c, S. Modes of collaboration in modern science: Beyond power

laws and preferential attachment. Journal of the american society for Information science and technology 61, 1410–1423 (2010).


## 66. Milojevi´c, S. Power law distributions in information science: Making

the case for logarithmic binning. Journal of the American Society for Information Science and Technology 61, 2417–2425 (2010).


## 67. Gerlach, M. & Altmann, E. G. Stochastic model for the vocabulary

growth in natural languages. Physical Review X 3, 021006 (2013).


## 68. Newman, M. E. & Watts, D. J. Scaling and percolation in the small-world

network model. Physical review E 60, 7332 (1999).


## 69. Watts, D. J. Small worlds: the dynamics of networks between order and

randomness, vol. 36 (Princeton university press, 2004).


## 70. Gravino, P., Servedio, V. D., Barrat, A. & Loreto, V. Complex structures

and semantics in free word association. Advances in Complex Systems


## 15, 1250054 (2012).


## 71. Cattuto, C., Loreto, V. & Pietronero, L. Semiotic dynamics and collabo-

rative tagging. Proceedings of the National Academy of Sciences 104,


## 1461–1464 (2007).


## 72. Cattuto, C., Baldassarri, A., Servedio, V. D. P. & Loreto, V. Vocab-

ulary growth in collaborative tagging systems. arXiv preprint arXiv:


## 0704.3316 (2007).


## 73. Fink, T. & Reeves, M. How much can we influence the rate of innova-

tion? Science Advances 5, eaat6107 (2019).


## 74. Barab´asi, A.-L. & Albert, R. Emergence of scaling in random networks.

Science 286, 509–512 (1999).


## 75. Bianconi, G. & Barab´asi, A.-L. Competition and multiscaling in evolving

networks. Europhysics letters 54, 436 (2001).


## 76. Monechi, B., Gravino, P., Servedio, V. D. P., Tria, F. & Loreto, V.

Significance and popularity in music production. Royal Society Open Science 4, 170433 (2017).


## 77. Castaldo, M., Venturini, T., Frasca, P. & Gargiulo, F. Junk news bubbles

modelling the rise and fall of attention in online arenas. new media & society 24, 2027–2045 (2022). 14/34


## 78. Last.f m. Description page. https://www.last.f m/about (Ac-

cessed: January 2021).


## 79. Celma, O. Music Recommendation and Discovery in the Long Tail

(Springer, 2010).


## 80. Last.f m. Music recommendation datasets for research.

last.f m dataset - 1k users. http://ocelma.net/ MusicRecommendationDataset/lastfm-1K.html (2009). Accessed: January 2021.


## 81. MusicBrainz. Home page. https://musicbrainz.org/ (2022).

Accessed: June 2022.


## 82. Hart, M. Project gutenberg, 1971. Project gutenberg, URL:

https://www.gutenberg.org (1971).


## 83. Gerlach, M. & Font-Clos, F. A standardized project gutenberg corpus

for statistical analysis of natural language and quantitative linguistics. Entropy 22, 126 (2020).


## 84. Porter, M. F. Snowball: A language for stemming algorithms (2001).


## 85. Porter, M. F. An algorithm for suffix stripping. Program (1980).


## 86. Paice, C. D. Another stemmer. SIGIR Forum 24, 56–61 (1990).


## 87. Scholar, S. Home page. https://www.semanticscholar.org/

(Accessed: January 2021).


## 88. Ammar, W. et a l. Construction of the literature graph in semantic scholar.

In NAACL (2018).


## 89. Scholar, S. Api license agreement. https://api.

semanticscholar.org/license/ (Accessed: June 2023).


## 90. Allen Institute for AI. Semantic scholar’s paper field of study classi-

fier. https://github.com/allenai/s2_fos. Accessed June


## 8, 2022 (2022).


## 91. Virtanen, P. et a l. Scipy 1.0: fundamental algorithms for scientific

computing in python. Nature Methods 17, 261–272 (2020).


## 92. Tria, F., Crimaldi, I., Aletti, G. & Servedio, V. D. P. Taylor’s law i n

innovation processes. Entropy 22, 573 (2020).


## 93. P´olya, G. Sur quelques points de l at h´eorie des probabilit´e s. In Ann. Inst.

Henri Poincar´e, vol. 1, 117–161 (1930).


## 94. Johnson, N. L. & Kotz, S. Urn models and their application; an approach

t o modern discrete probability theory (1977).


## 95. Mahmoud, H. P´olya urn models crc press. Boca Raton FL (2009).


## 96. Di Bona, G., Iacopini, I., Petralia, A. & Latora, V. Code used

t o download, process and analyse the data and the models at higher orders. https://github.com/gabriele-d i-bona/ higher-order-heaps-laws (2023).


## 97. King, T., Butcher, S. & Zalewski, L. Apocrita - High Performance

Computing Cluster for Queen Mary University of London (2017).


## 98. Inc., W. R. Mathematica, Version 12. URL https://www.wolfram.

com/mathematica. Champaign, IL, 2022.

Acknowledgements G.D.B. acknowledges support from the French Agence Nationale de la Recherche (ANR), under grant ANR-21-CE38-


## 0020 (project ScientIA). A.P. and V.L. acknowledge support

from the PNRR GRInS Project. I.I. acknowledges partial support from the James S. McDonnell Foundation 21st Century Science Initiative “Understanding Dynamic and Multi-scale Systems”. All computations have been performed via the High Performance Computing (HPC) cluster provided by Queen Mary University of London97. A.P. wishes to thank Roberto di Mari for several comments and suggestions.

Author contributions G.D.B, I.I., A.P., and V.L. designed the study. A.P. performed a preliminary investigation, collected in an early draft. G.D.B. carried out the data collection and performed the numerical simulations. G.D.B., A.B., and G.D.M. carried out the analytical calculations. G.D.B, A.B., I.I., and V.L. wrote the manuscript. All authors contributed to analyze the data, discuss the results, define the proposed model, and revise the manuscript.

Competing interests The authors declare no competing interests.

Additional information Supplementary Information is attached to this manuscript.

15/34Supplementary Information for “The dynamics of higher-order novelties”S1 Higher-order Heaps’ exponents in the data sets


## 3 4 5 6 7

log10(T)0.00.20.40.60.81.0pdf Last.f m Project Gutenberg Semantic Scholar median length (Last.f m) median length (Project Gutenberg) median length (Semantic Scholar)Figure S1. Length T distribution of the sequences in the data sets. Probability density function of the length T of all sequences in the three data sets (Last.f mi n blue, Project Gutenberg in orange, Semantic Scholar in green). Moreover, the median lengths, respectively equal to 13 985, 50 726, and 9 114.5, are shown in the plot as vertical dashed lines, with the color corresponding to each data set, as shown in the legend.

data set (βn) min 1st perc. 25th perc. median 75th perc. 99th perc. maxLast.f m (β1) 0.0007 0.0016 0.0052 0.0079 0.0129 0.0693 0.1988 Last.f m (β2) 0.0000 0.0001 0.0026 0.0047 0.0091 0.0510 0.1497 Last.f m (β3) 0.0000 0.0000 0.0019 0.0038 0.0073 0.0388 0.1366 Last.f m (β4) 0.0000 0.0000 0.0015 0.0031 0.0064 0.0343 0.1294 Project Gutenberg (β1) 0.0000 0.0010 0.0021 0.0029 0.0043 0.0169 0.0727 Project Gutenberg (β2) 0.0003 0.0005 0.0010 0.0014 0.0020 0.0087 0.0522 Project Gutenberg (β3) 0.0001 0.0002 0.0004 0.0006 0.0009 0.0064 0.0484 Project Gutenberg (β4) 0.0000 0.0001 0.0001 0.0002 0.0005 0.0051 0.0444 Semantic Scholar (β1) 0.0003 0.0008 0.0018 0.0025 0.0035 0.0115 0.1279 Semantic Scholar (β2) 0.0002 0.0004 0.0010 0.0014 0.0021 0.0093 0.1677 Semantic Scholar (β3) 0.0000 0.0002 0.0005 0.0008 0.0013 0.0078 0.1698 Semantic Scholar (β4) 0.0000 0.0001 0.0003 0.0005 0.0009 0.0068 0.

Table S1. Statistics on the standard error of the fitted higher-order Heaps’ exponents in the empirical data. Various statistics on the standard error, or standard deviation of the estimator, of the fitted nth-order Heaps’ exponents βn of the sequences in the three data sets, with n = 1, 2, 3, and 4. Notice how the standard deviation of the distribution of the values of the exponents in the data sets (see Table. S2 for reference) is about two orders of magnitude higher than the median standard error and one order higher than its 99th percentile. Moreover, the p-values of the fits are all zero (not shown in the table). This proves we can consider the fits valid, and thus the nth-order Heaps’ laws valid in almost all the sequences of the data sets considered. 16/34


## 0.0 0.2 0.4 0.6 0.8 1.0

051015pdf Songs a Last.fm1234


## 0.0 0.2 0.4 0.6 0.8 1.0

01020


## 30 Books

b Project Gutenberg


## 0.0 0.2 0.4 0.6 0.8 1.0

01020


## 30 Titles

c Semantic Scholar


## 0.0 0.2 0.4 0.6 0.8 1.0

n0246pdf Artists d


## 0.0 0.2 0.4 0.6 0.8 1.0

n01020


## 30 Stemmed books

e


## 0.0 0.2 0.4 0.6 0.8 1.0

n01020


## 30 Stemmed titles

fFigure S2. Heaps’ exponent distribution of the sequences in the data sets. Probability density functions of the nth-order Heaps’ exponents βn, with n = 1, 2, 3, 4, calculated from the empirical sequences (a-c) and respective sequences of labels (d-f). In particular, sequences contain songs (a) and artists (d) in Last.f m, words (b) and stemmed words (e) in Project Gutenberg books, words (c) and stemmed words (f) in Semantic Scholar journal titles.

data set (βn) mean std min 1st perc. 25th perc. median 75th perc. 99th perc. maxLast.f m (β1) 0.7029 0.1797 0.1063 0.2010 0.5965 0.7395 0.8436 0.9761 0.9959 Last.f m (β2) 0.9048 0.1014 0.3342 0.5725 0.8699 0.9388 0.9754 0.9999 0.9999 Last.f m (β3) 0.9286 0.0862 0.3664 0.6123 0.9041 0.9583 0.9861 0.9999 1.0000 Last.f m (β4) 0.9411 0.0759 0.3837 0.6643 0.9195 0.9679 0.9896 0.9999 1.0000 Project Gutenberg (β1) 0.5699 0.0973 -0.0000 0.3678 0.5026 0.5594 0.6285 0.8302 0.9527 Project Gutenberg (β2) 0.8527 0.0547 0.0304 0.7118 0.8191 0.8509 0.8883 0.9706 0.9919 Project Gutenberg (β3) 0.9589 0.0300 0.0307 0.8648 0.9480 0.9627 0.9765 0.9968 0.9998 Project Gutenberg (β4) 0.9882 0.0203 0.0304 0.9242 0.9870 0.9923 0.9958 0.9995 1.0000 Semantic Scholar (β1) 0.6695 0.1019 0.2225 0.4673 0.5923 0.6590 0.7436 0.8889 0.9293 Semantic Scholar (β2) 0.8895 0.0536 0.2587 0.7509 0.8550 0.8936 0.9303 0.9803 0.9942 Semantic Scholar (β3) 0.9612 0.0305 0.2665 0.8686 0.9478 0.9680 0.9825 0.9972 0.9999 Semantic Scholar (β4) 0.9847 0.0198 0.2790 0.9177 0.9807 0.9901 0.9954 0.9995 1.

Table S2. Statistics of the fitted higher-order Heaps’ exponents in the data. Various statistics of the fitted nth-order Heaps’ exponents βn of the sequences in the three data sets, with n = 1, 2, 3, and 4. 17/34


## 102 103 104

t101102103104Dn( t) a Last.fmD1(t) 2.75t0.59 D2(t) 1.00t0.89D3(t) 1.00t0.93


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 d y=x y = 0.40x + 0.60 (R2 = 0.28)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.03 gy = 0.23x + 0.75 (R2 = 0.13)


## 102 103 104

t101102103104 b Project GutenbergD1(t) 21.15t0.49 D2(t) 3.32t0.84D3(t) 1.38t0.96


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 e

y = 0.45x + 0.61 (R2 = 0.66)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 h

y = 0.15x + 0.88 (R2 = 0.26)


## 102 103 104

t101102103104 c Semantic ScholarD1(t) 6.23t0.61 D2(t) 2.02t0.87D3(t) 1.26t0.96


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 f

y = 0.42x + 0.62 (R2 = 0.64)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 i

y = 0.16x + 0.86 (R2 = 0.30)low density high densityFigure S3. Higher-order Heaps’ exponents in real-world data sets. (a-c) Average number Dn( t) of novelties of order n, with n = 1, 2, 3, as a function of the sequence length t, and fit of the associated Heaps’ laws (dashed lines), with estimated exponents shown in the legend. Shaded area represents one standard deviation above and below the average. (d-i) Scatter plots between the (1st-order) Heaps’ exponents β1 and the nth-order exponents βn, with n = 2 (d-f) and 3 (g-i). Each point refers to a different sequence, with colors representing the density of points (see color bar). Each panel also reports histograms of exponents distributions, the bisector y = x (dashed gray line), as well as the fitted linear model (dotted red line) with the value of its coefficient of determination R2. Each column refers to a different data set: (a,d,g) sequences of artists listened on Last.f m, (b,e,h) sequences of stemmed words of books from Project Gutenberg and (c,f,i) sequences of stemmed words of titles in journals of Semantic Scholar, respectively. Notice that the sequences analyzed here are different from those shown in Fig. 1 in the main manuscript, since here we consider the sequence of artists or stems instead of the related songs or words. 18/34


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107 108Dn( t) aSongs Last.f m D1(t) t 0.69 D2(t) t 0.96D3(t) t 0.98


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107


## 108 b

Books Project GutenbergD1(t) t 0.66 D2(t) t 0.71D3(t) t 0.81


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107


## 108 c

Titles Semantic Scholar D1(t) t 0.61 D2(t) t 0.69D3(t) t 0.82


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107 108Dn( t) dArtists D1(t) t 0.64 D2(t) t 0.89D3(t) t 0.96


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107


## 108 e

Stemmed books D1(t) t 0.67 D2(t) t 0.70D3(t) t 0.80


## 100 101 102 103 104 105 106 107 108 109

t100 101 102 103 104 105 106 107


## 108 f

Stemmed titles D1(t) t 0.61 D2(t) t 0.67D3(t) t 0.

Figure S4. Higher-order Heaps’ laws for the collective sequence in real-world data sets. Average number Dn( t) of novelties of order n, with n = 1, 2, 3, as a function of the sequence length t, and fit of the associated Heaps’ laws (dashed lines), with estimated exponents shown in the legend. For each data set we compute the Heaps’ laws over a collective sequence obtained by consecutively adding all individual sequences in a random order. This procedure has been repeated 100 times for each data set. Shaded area represents one standard deviation above and below the average. Each panel refers to the collective sequence of a different data set: sequences of songs (a) and artists (d) listened by users on Last.f m, sequences of words (b) and their stems (e) of books from Project Gutenberg, and sequences of words (c) and their stems (f) from titles in journals of Semantic Scholar, respectively. 19/34


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 a Original y=x y = 0.48x + 0.58 (R2 = 0.74)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.03 b Original y = 0.18x + 0.86 (R2 = 0.34)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 c Filtered y = 0.47x + 0.58 (R2 = 0.68)


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.03 d Filtered y = 0.19x + 0.85 (R2 = 0.31)


## 0.0 0.2 0.4 0.6 0.8 1.0

Original0.00.20.40.60.81.0Filtered e 2 y = 1.02x 0.02 (R2 = 0.96)


## 0.0 0.2 0.4 0.6 0.8 1.0

Original0.00.20.40.60.81.0Filtered f 3 y = 1.07x 0.07 (R2 = 0.91)low density high densityProject GutenbergFigure S5. Higher-order Heaps’ exponents for Project Gutenberg, filtering out pairs and triplets of words between punctuation marks. (a-d) Scatter plots between the (1st-order) Heaps’ exponents β1 and the nth-order exponents βn, with n = 2 (a,c) and 3 (b,d). Panels (a-b) refer to the original sequences of words analyzed in Fig. 1(e,h), while the sequences of panels (c-d) are obtained from the original ones filtering out all pairs or triplets of words between punctuation marks. Notice that this filtering only removes elements from the higher-order sequences. (e-f) Scatter plots between the nth-order Heaps’ exponents for the original and filtered Project Gutenberg sequences. Each point refers to a different sequence, with colors representing the density of points (see color bar). Each panel also reports histograms of exponents distributions, the bisector y = x (dashed gray line), as well as the fitted linear model (dotted red line) with the value of its coefficient of determination R2. Notice how there are no significant differences between higher-order Heaps’ exponents in the original and filtered sequences.

20/34S2 Heaps’ exponents in simulations of existing modelsThe Urn Model with Triggering (UMT) features a triggering mechanism for the growth of the adjacent possible1. In particular, whenever a new color is drawn for the first time, ν + 1 new colors are triggered and added into the urn. Together with the reinforcement mechanism introduced in Polya’s urn93, the UMT manages to reproduce various features of discovery processes, including the Heaps’ law. In particular, varying the parameters, the UMT produces different rates of discovery, which can be measured by the power-law exponent β1 of the Heaps’ law. According to analytical results on the asymptotic Heaps’ exponent, we have that β1 → ν/ρ. We check if this relation holds true at finite times in Fig. S6(a), where we show the scatter plots between ν/ρ and the fitted value of β1 for simulations of the UMT with ρ = 20 and ν = 1, . . . , 20, run for T = 105 time steps. Each point refers to a different simulation, and we analyze 100 simulations for each set of parameters. We notice how the relationship holds true in most cases, although the fitted values are less than the theoretical ones, especially for high values of ν/ρ. We repeat this check also for higher-order Heaps’ exponents in Fig. S6(b-c), finding that also in this case there is not so much difference between the theoretical value ν/ρ and the fitted β2 and β3, if only that the points in the plot are slightly higher than the bisector. We repeat the same analysis for the Urn Model with Semantic Triggering (UMST), which introduces semantic triggering between the colors in the urn. In particular, two colors are considered semantically related if they have been triggered by the same color (siblings) or if one has triggered the other (parent and child). Then, whenever a new color needs to be extracted, a ball of a certain color in the UMST has a different weight depending on the semantic relationship with the previous color. If the two colors are related, then the ball has weight 1, otherwise it gets weight η ≤ 1. Notice that the UMT is equivalent to the UMST with η = 1. Analytical results on the Heaps’ law from the SI in Ref.1 show that the asymptotic Heaps’ exponent is found between ην/ρ and min (1, ν/ρ). We test this in Fig. S6(d-l), where we show the scatter plots between the expected lower bound ην/ρ and the fitted value of the Heaps’ exponents for simulations of the UMST with various sets of parameters: (d-f) η = 0.7, ρ = 7, ν = 1, 2, . . . , 10; (g-i) η = 0.5, ρ = 20, ν = 1, 2, . . . , 30; (j-l) η = 0.1, ρ = 4, ν = 1, 2, . . . , 20. Let us start our analysis by looking at panel (j), since the UMST can only reproduce the semantic correlations seen in the data for low values of η 14. We see that for low values of the ην/ρ the value of β1 corresponds to the theoretical lower bound (points are found on the bisector). However, starting from about ην/ρ = 0.2 there are simulations in which the value of β1 goes abruptly up to 1. Notice that for these values, we have that ν/ρ = 2. Interestingly, up to ην/ρ = 0.3 and sometimes up to ην/ρ = 0.4, there are both simulations with Heaps’ exponent β1 ≈ ην/ρ and others with β1 ≈ 1, but almost none in between. After that, there remain only simulations with linear Heaps’ law. We repeat the analysis for higher-order Heaps’ exponents, finding the same behavior. In Table S3 we also report the number of simulations with either of the two behaviors. Notice how the number of simulations with β1 ≈ 1 increases with higher values of ν. This analysis shows the inadequacy of the UMST to reproduce the whole spectrum of paces of discovery. In fact, we are not able to obtain Heaps’ exponents in between the two theoretical limits. For example, we cannot obtain Heaps’ exponents between roughly 0.4 and 0.9 when η = 0.1. Instead, simulations actually only produce exponents very close to these two bounds. Moreover, the higher the theoretical value ην/ρ, the higher the chance of having a Heaps’ exponent close to 1. A possible explanation of why this could happen lies on the way semantic triggering happens. In the UMST, indeed, when a color is drawn for the first time, ν + 1 balls of new colors are added to the urn, and they become semantically connected to the triggering color. Then, the probability to draw a ball of a color semantically close to the previous one is 1/η = 10 times higher with respect to balls of other colors. This brings about two possible scenarios. On the one hand, if a small cluster of colors is highly reinforced in the beginning of the simulation, after one of them is drawn it is very likely that another of these colors is extracted in the next time step. On the other hand, if a new color is drawn, since it is highly probable to move to a semantic close color and almost all of them are new, if ν is high enough the next extracted color is also almost surely new. Then, once inside one of the two scenarios, it is very unlikely to break the loop, producing the two groups of Heaps’ exponent we observe. This also explains why the likelihood of being in the linear case increases with ν, even though the two behaviors can coexist in the same set of parameters. Furthermore, this is also confirmed by simulations with higher number steps—w e tested with 107steps—, which show the same results, indicating that the behavior has already reached a stationary state. A similar result is obtained also for higher values of η, as shown in Fig. S6(d-i). Looking for example at panel (g), we can see the same behavior, where all simulations have their exponents at the theoretical lower bound for low values of ην/ρ (points in the bisector), while for higher values of ην/ρ the majority of simulations are closer to the upper bound instead. Therefore, there are very few simulations around β1 = 0.7. Considering the higher value of η with respect to that shown in panel (j), here this behavior is less evident, but it is still present Finally, in Fig S7 we show the scatter plot between the 1st-order Heaps’ exponent β1 and the 2nd one β2 in various simulations of UMST and ERRW with different parameters. In particular, the parameters chosen for the UMST are the same as those discussed above in Fig. S6. The parameters for the ERRW are the same as those chosen in the main manuscript, i.e., the edge reinforcement goes from ρ = 0.1 to 10, running on synthetic random small world networks with a rewiring probability of 0.121/34(panel d), 0.01 (e), and 0.001 (f). Notice how reducing the rewiring in the network, so that the network is more similar to a ring, the discovery rates at both first and second orders are lower. Nevertheless, in all cases, both UMST and ERRW cannot reproduce the empirical range of pairs (β1, β2) seen in the empirical data.


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.01 aUMT y=x


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.02 b


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.03 c


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.01 dUMST (=0.7)


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.02 e


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.03 f


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.01 gUMST (=0.5)


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.02 h


## 0.0 0.2 0.4 0.6 0.8 1.0

0.00.20.40.60.81.03 i


## 0.0 0.2 0.4 0.6 0.8 1.0

/0.00.20.40.60.81.01 jUMST (=0.1)


## 0.0 0.2 0.4 0.6 0.8 1.0

/0.00.20.40.60.81.02 k


## 0.0 0.2 0.4 0.6 0.8 1.0

/0.00.20.40.60.81.03 llow density high densityFigure S6. Higher-order Heaps’ exponents with the expected asymptotic value in urn model simulations. Scatter plots between the analytically expected lower bound ην/ρ for the asymptotic 1st-order Heaps’ exponent—the theoretical upper bound being min(1, ν/ρ)—and the Heaps’ exponents β1 (a), β2 (b), β3 (c), β4 (d). Each point refers to a different simulation of 105 time steps, colored according to the density of points (see color bar). Each panel reports the value of the correlation coefficient r. The first row refers to the Urn Model with Triggering (UMT), with no semantic correlations (η = 1) and ρ = 20. The second row refers to the Urn Model with Semantic Triggering (UMST), with ρ = 4 and η = 0.1. Here, we show the results of 100 simulations for each set of parameters. 22/34


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 a UMST( = 0.1) y=x


## 5 10 15 201 20


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 b UMST( = 0.5)


## 10 20 301 30


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 c UMST( = 0.7)


## 2.5 5.0 7.5 10.01.0 10.0


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.81.02 d ERRW( p = 0.1) y=x


## 2.5 5.0 7.5 10.00.1 10.0


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 e ERRW( p = 0.01)


## 2.5 5.0 7.5 10.00.1 10.0


## 0.0 0.2 0.4 0.6 0.8 1.0

10.00.20.40.60.8


## 1.0 f ERRW( p = 0.001)


## 2.5 5.0 7.5 10.00.1 10.0

Figure S7. Higher-order Heaps’ exponents in existing models with other parameters. Scatter plots between the (1st-order) Heaps’ exponent β1 and the 2nd-order exponent β2 in (a-c) the urn model with semantic triggering (UMST) and (d-e) the edge-reinforced random walk (ERRW) on a small-world network with average degree ⟨k⟩ = 4 and edge reinforcement ρ ranging (geometrically) from 0.1 to 10. Each panel refers to a different set of parameters: (a) η = 0.1, ρ = 4, ν = 1, 2, . . . , 20; (b) η = 0.5, ρ = 20, ν = 1, 2, . . . , 30; (c) η = 0.7, ρ = 7, ν = 1, 2, . . . , 10; (d) rewiring probability of the small-world network p = 0.1; (e) p = 0.01; and (f) p = 0.001. Each point in these plots refers to a different simulation of the related model, with colors representing the value of the free parameter (see color bar). Each panel also reports histograms of exponent distributions on the respective axes, and the bisector y = x (dashed gray line). All simulations have run for 105 time steps.

23/34η ρ ν β1 ≈ ην/ρ β1 ≈ 1


## 0.1 4 1 100 0


## 0.1 4 2 100 0


## 0.1 4 3 100 0


## 0.1 4 4 100 0


## 0.1 4 5 100 0


## 0.1 4 6 100 0


## 0.1 4 7 99 1


## 0.1 4 8 91 9


## 0.1 4 9 80 20


## 0.1 4 10 51 49


## 0.1 4 11 44 56


## 0.1 4 12 21 79


## 0.1 4 13 12 88


## 0.1 4 14 0 100


## 0.1 4 15 0 100


## 0.1 4 16 1 99


## 0.1 4 17 0 100


## 0.1 4 18 0 100


## 0.1 4 19 0 100


## 0.1 4 20 0 100

Table S3. Statistics on the number of simulations of urn models. Number of simulations of the UMST (η = 0.1, ρ = 4, ν = 1, . . . , 20) that have an exponent approximately equal to the lower bound ην/ρ or to the upper bound 1. For each set of parameters, 100 simulations have been launched. 24/34S3 Analytic results for higher-order Heaps’ exponents in UMT simulationsIn this section we provide a complete analytical analysis of the higher-order Heaps’ laws for the Urn Model with Triggering (UMT). Let us consider an urn with parameters ρ and ν and initially composed by N0 ≥ 1 balls of different colors.

S3.1 First-order Heaps’ law The evolution of the number D1(t) of different colors that have appeared in the first t positions of the sequence S is ruled by the following master equation:

D1(t + 1) = D1(t) + P ( N( t+1)) = D1(t) + N0 + vD1(t) N0 + ρt + (v + 1)D1(t) , (S1)where N( t+1) is the event of drawing at time (t + 1) a ball of a color that has not been observed before. Its probability P ( N( t+1))can be expressed as the number of colors in the urn yet to be discovered, N0 + (ν + 1)D1(t) − D1(t), divided by the total number of balls available at time ti n the urn. In the long time limit, Eq. (S1) can be approximated by a differential equation, which leads to an analytical expression for D1(t) (see Refs.1, 59 for the analytical calculations):

  dD1(t) dt = N0 + vD1(t) N0 + ρt + (v + 1)D1(t) D1(0) = 0 =⇒ D1(t) ≈ t→∞   btβ1 if ν < ρ,b t logt if ν = ρ,b ti f ν > ρ, (S2)where β1 = ν/ρ and bi sa constant depending on ν and ρ. In other words, in the sublinear case ν < ρ, the Heaps’ law is analytically verified, with asymptotic exponent β1 = ν/ρ 1.

S3.2 Second-order Heaps’ law In order to write down an equation similar to Eq. (S2) for the the number D2(t) of different pairs that have appeared in the sequence S2 of length t, i.e.,   dD2(t) dt = P(“The t-t h pair is new”),D2(0) = 0, (S3)w e need to calculate the probability to observe a new pair. However, differently from Eq. (S2), such a probability depends not only on the total number of balls and on the number of extracted colors, but also on the number of balls of each extracted color. Notice that the t-t h pair (x 1, x 2) of S2 is composed by the color x 1 drawn at time ti n S and the color x 2 drawn in the next time step. Hence, there are three separate events in which the t-t h pair (x 1, x 2) is a novelty in S2: the event A in which x 1 is a novelty, i.e. it appears for the first time in the sequence S at time t; the event B in which x 1 is not a novelty but x 2 is a novelty; the event C in which both colors x 1 and x 2 are not novel, but the combination (x 1, x 2) appears for the first time. Consequently, the probability that the t-t h pair is new is equal to the sum of the probabilities of such events. Using Eq. (S2), for large values of t the probability of event A can be written asP(A) = P ( N( t)) = dD1(t) dt ≈ t→∞ bβ1tβ1−1. (S4)Similarly, denoting with N( t) the opposite event of N( t), the probability of event B readsP(B) ≈ P ( N( t)) P ( N( t+1)) ≈ (


## 1 − dD1(t)

d t ) dD1(t + 1) dt ≈ bβ1tβ1−1 = P(A), (S5)Thirdly, we can compute the probability of the event C by calculating the probability that each possible pair of old colors is a novelty in this time step. Since the number of old colors up to time ti s D1(t), indicating with C( t) i, j the event in which i and j are two already extracted colors and their pair (i, j) is a novelty at time ti n S2, we can write:

P(C) ≈ P ( N( t)) P ( N( t+1)) P  D1(t)⋃i, j=1 C( t) i, j  ≈ (


## 1 − bβ1tβ1−1)2 P

 btβ1⋃i, j=1 C( t) i, j  ≈ btβ1 ∑ i, j=1 P ( C( t) i, j ) . (S6)25/34The last equality in Eq. (S6) holds true because for any (i 1, j 1) ̸= (i 2, j 2) we have C( t) i 1, j 1 ∩ C( t) i 2, j 2 = Ø, since only one pair can be extracted at each time step, and we have disregarded lower infinitesimals.

Let us now concentrate on computing the probability of Ci, j( t). Defining the event E (τ) ij = “pair (i, j) appears (not necessarilyfor the first time) in the sequence at time τ”, we can rewrite C( t) i, j asC( t) i, j = E (1) ij ∩ E (2) ij ∩ · · · ∩ E (t−1) ij ∩ E (t) ij , (S7)where we denote with E (τ) ij the opposite event of E (τ) ij . We can hence compute its probability asP ( C( t) i, j ) = P ( E (1) ij ∩ E (2) ij ∩ · · · ∩ E (t−1) ij ∩ E (t) ij )= P ( E (1) ij ) P ( E (2) ij | E (1) ij ) · · · P ( E (t−1) ij | E (1) ij ∩ · · · ∩ E (t−2) ij ) P ( E (t) ij | E (1) ij ∩ · · · ∩ E (t−1) ij ) . (S8)First, we notice that we can simplify the expressions in Eq. (S8), sinceP ( E (τ) ij | E (1) ij ∩ · · · ∩ E (τ−1) ij ) = P ( E (τ) ij | E (τ−1) ij ) . (S9)This equality in Eq. (S9) holds true because, the probability of extracting the pair (i, j) at time τ can only be influenced by what has happened at time (τ − 1), disregarding all previous times. Without loss of generality, let us index the colors in the urn in the same order they first appeared in the sequence, i.e., let us suppose that the i-t h color has appeared at time t i, with t i+1 > t i, for i = 1, 2, . . . , D1(t). Let us also suppose that the rate at which a new color appears is given exactly by the approximated solution given by Eq. (S2). Then, it would bei = D( t i) ≈ btβ1 i =⇒ ti ≈ ( ib ) 1 β1 . (S10)With Eq. (S10) we are assuming that the behavior of D1(t) at finite times can be approximated with the asymptotic one, and that colors appear deterministically at these expected moments. Even though strong, this assumption makes sense if we consider that, as it has been observed before, there is a good correspondence between this analytical solution and simulations at finite times. Moreover, we will confirm a posteriori the suitability of this assumption since, as we will see, there is correspondence between the analytical solution of D2(t) we obtain here and the results of model simulations. Let us now define n i( t) as the number of times the color i has appeared before time t, supposing it has first appeared at timeti ≤ t. If E (t) i = “i appears at time t” (not necessarily for the first time), then we have that dni dt = P ( E (t) i ) . Thus, we can write:

  dni( t) dt = ρni( t) + 1 N0 + aD( t) + ρt ≈ t→∞ ni t ,n i( t i) = 1, =⇒   n i( t) ≈ t→∞ tt i if t ≥ t i,n i( t) = 0 if t < t i, =⇒   dni( t) dt ≈ t→∞ 1 ti = ( bi ) 1 β1 if t ≥ t i,dni( t) dt = 0 if t < t i. (S11)Let us observe that under these assumptions dni/d ti s actually constant in time, depending just on t i. Then, supposing that the number of balls n i(τ), n j(τ) of the two colors in the urn follows exactly Eq. (S3), we can calculate the probability of E (τ) ij asP ( E (τ) ij ) = P ( E (τ) i ) P ( E (τ+1) j ) = dni(τ) dτ dn j(τ + 1) dτ ≈ t→∞   1 tit ji f τ ≥ max( t i,t j − 1),


## 0 if τ < max( t i,t j − 1). (S12)

26/34Furthermore, if τ ≥ max( t i,t j − 1), we can writeP ( E(τ) ij ∩ E (τ−1) ij ) = P ([( E(τ+1) ij ∩ E(τ) ij ) ∩ E(τ) j ] ∪ [(E (τ+1) ij ∩ E (τ) ij ) ∩ E (τ) j ])= P ([ E(τ) i ∩ E (τ+1) j ∩ E(τ−1) i ∩ E(τ) j ] ∪ [ E(τ) i ∩ E(τ+1) j ∩ E(τ) j ])= P ( E (τ) i ∩ E(τ) j ) P ( E (τ+1) j ) P ( E (τ−1) i ) + P ( E(τ) i ∩ E(τ) j ) P ( E (τ+1) j )= δ (i, j) 1 ti 1 tj (


## 1 − 1

t i ) + (1 − δ (i, j)) 1 ti 1 tj . (S13)Therefore, we getP ( E (τ) ij | E (τ−1) ij ) = P ( E (τ) ij ∩ E (τ−1) ij )P ( E (τ−1) ij ) = δ (i, j) 1 tit j (


## 1 − 1

t i ) + 1 − δ (i, j) tit j


## 1 − 1

tit j= δ (i, j) (


## 1 − 1

t i ) + (1 − δ (i, j))tit j − 1 = δ (i, j) (


## 1 − 1

t i )tit j − 1 + (1 − δ (i, j)) 1 tit j − 1= δ (i, j) 1 t 2 i + ti + (1 − δ (i, j)) 1 tit j − 1 . (S14)In the following of this discussion, we make the following approximation:

δ (i, j) 1 t 2 i + ti + (1 − δ (i, j)) 1 tit j − 1 ≈ 1 tit j . (S15)Because of Eq. (S12), the approximation in Eq. (S15) implies in Eq. (S14) thatP ( E (τ) ij | E (τ−1) ij ) ≈   1 tit ji f τ ≥ max( t i,t j − 1)


## 0 if τ < max( t i,t j − 1) =⇒ P (

E (τ) ij | E (τ−1) ij ) ≈ P ( E (τ) ij ) , (S16)which is equivalent to assume that E (τ) ij and E (τ−1) ij are statistically independent, i.e. that the extraction of a certain pair (i, j) at time τ is independent of its extraction at the previous time (τ − 1). Therefore, using Eq. (S8), Eq. (S9), Eq. (S12) and Eq. (S16), the probability of the event C( t) ij that the pair (i, j) is extracted at time t for the first time can be approximated toP ( C( t) ij ) = P ( E (1) ij ) P ( E (2) ij ) · · · P ( E (t−1) ij ) P ( E (t) ij ) = t−1 ∏ τ=1 P ( E (τ) ij ) P ( E (t) ij )= t−1 ∏ τ=max( t i,t j−1) (


## 1 − P (

E (τ) ij )) P ( E (t) ij ) = (


## 1 − 1

tit j )t−max( t i,t j−1) 1 tit j , (S17)which can be used in Eq. (S6) to obtain an approximated expression for the probability of event C, i.e.,P (C) ≈ btβ1 ∑ i, j=1 P ( C( t) ij ) ≈ btβ1 ∑ i, j=1 (


## 1 − 1

tit j )t−max( t i,t j−1) 1 tit j . (S18)Summing u p, by inserting Eq. (S4), Eq. (S5), and Eq. (S18) into Eq. (S3), we get the following differential equation for the number of new pairs in time in the UMT:

dD2 dt ≈ t→∞ 2bβ1tβ1−1 + btβ1 ∑ i, j=1 (


## 1 − 1

tit j )t−max( t i,t j−1) 1 tit j ︸ ︷︷ ︸ C (t) . (S19)27/34In order to have an estimate of C (t), let us approximate the sum with the related integral:

C (t) ≈ t→∞ btβ1∫1 btβ1∫1 (


## 1 − 1

txty )t−max( t x,t y−1) 1 txty dxdy. (S20)This way, using the change of variables u = tx = ( xb ) 1 β1 , v = ty = ( yb ) 1 β1 , we getC (t) ≈ t→∞ (bβ1)


## 2 t∫

1 ρ−ν t∫1 ρ−ν (


## 1 − 1

u v )t−max( u, v−1) dudv (u v)2−β1 , (S21)where we have substituted the initial value ( 1 b ) 1 β1 = 1 ρ − ν , since b = (ρ − ν)β1 when ν < ρ, that is in this case1. Moreover,considering that u and v represent time variables, with τ ∈ (1,t), since between t = 0 and t = 1 there are no colors extracted yet, we can change the lower integral border to 1, i.e.,C (t) ≈ t→∞ (bβ1)


## 2 t∫

1 t∫1 (


## 1 − 1

u v )t−max( u, v) dudv (u v)2−β1 , (S22)where we have also simplified the exponent in the integrand, so that we can more easily calculate it asC (t) ≈ t→∞ 2 (bβ1)


## 2 t∫

1 u∫1 (


## 1 − 1

u v )t−u dudv (u v)2−β1 . (S23)We numerically solve the integral in Eq. (S23) on specified points ti using the command NIntegrate of Mathemathica98. The points ti have been chosen on a fine logarithmically spaced grid of N = 1601 points 1 = t 0 < t 1 < · · · < tN = 1016. By plugging the numerical approximation C (t i) into Eq. (S19), we also obtain a numerical approximation of dD2/d ti n these points. We also obtain an analytical approximation of dD2/d tb y fitting a function of the type atb+c/(d+log2(t)) using curve fit (i n Python’s package scipy), where the minimization of the error has been done in logarithm scale. Finally, integrating Eq. (S19) over t, we obtain a solution for D2(t). Again, we are not able to solve this integral analytically, so we solve it numerically using the analytical fit of dD2/d t. In particular, we integrate using Python’s command odeint in the scipy package. We find that the numerical integration for D2(t) can also be fitted by a function of the type atβ1+c/(d+log2(t)).

To sum u p, we have derived a solution of Eq. (S19) of the typeD2(t) ≈ atβ2, with β2 = β1 + cd + log( t) , (S24)where a, c, and d depend on the parameters ρ and ν. Fig. S8 shows that the analytical expression of β2 we have found is in good agreement with the numerical simulations. From left to right, we consider parameters ρ = 4 and ν = 1, 2, 3, and we run simulations until T = 107. In each plot, continuous lines represent the 2nd-order Heaps’ exponents of the power-law fits as a function of time t. The continuous blue line is obtained by fitting the best parameters a, c and d that minimize the error between the points D2(t) of the simulations with a function of the type atβ1+ c d+log( t) . The continuous orange line instead represents the result of our analytical approach in Eq. (S24). The expected value of β1 = ν/ρ is represented as a horizontal dashed gray line. Our results further confirm that 2nd-order Heaps’ exponents differ from the 1st-order ones at finite times. However, they also highlight that in the UMT the difference between β2 and β1 slowly decays in time.

S3.3 Higher-order Heaps’ law Finally, we point out that an analytical solution for higher-order Heaps’ exponents can also be obtained by induction, with assumptions similar to those used for the 2nd-order one. For example, for the 3rd-order, we can repeat the same process as in Sec. S3.2 to compute the probabilities of obtaining a new triplet. In particular, supposing thatdD1(t) dt ≈ a1tβ1−1, dD2(t) dt ≈ a2tβ1−1+ c 2 d 2+log2(t) , (S25)w e can obtain a new triplet in the three following distinct cases.


## 28/34104 107 1010 1013 1016

t 0.00.20.40.60.81.02(t) a / = 0.25 simulation analytical


## 104 107 1010 1013 1016

t 0.00.20.40.60.8


## 1.0 b

/ = 0.50


## 104 107 1010 1013 1016

t 0.00.20.40.60.8


## 1.0 c

/ = 0.

Figure S8. 2nd-order Heaps’ exponent in the urn model with triggering. Temporal evolution of the 2nd-order Heaps’ exponents β2(t) of the urn model with triggering according to the simulations (continuous blue line) and the numerical integration of Eq. (S19) (continuous orange line). Parameters are set to ρ = 4 and η = 1, while ν varies across panels: ν = 1 (a), 2 (b), and 3 (c). Continuous lines are obtained by fitting D2(t) with a function atβ1+c/(d+log( t)), as in Eq. (S24). The expected 1st-order Heaps’ exponent in each panel, respectively equal to β1 = ν/ρ = 0.25, 0.5, 0.75, is displayed as a dashed gray horizontal line.

(A): when at time (t − 1) a new pair is drawn, which happens with probabilityP(A) = dD2(t − 1) dt ≈ a2tβ1−1+ c 2 d 2+log2(t) . (S26)(B): when at time (t − 1) an old pair is drawn, and at time ta new color is drawn, which happens with probabilityP(B) = (


## 1 − dD2(t − 1)

d t ) dD1(t) dt ≈ (


## 1 − a2tβ1−1+c 2/(d 2+log2(t))) a1tβ1−1 ≈ a1tβ1−1. (S27)

(C): when at both times (t − 1) and ta n old pair and an old color are extracted, but the corresponding triplet has never appeared in the sequence before. Following the same steps of the 2nd-order case, we get the probabilityP (C) ≈ btβ1 ∑ i, j,k=1 (


## 1 − 1

tit jtk )t−max( t i,t j,t k) 1 tit jtk ≈≈ (a 1)


## 3 t∫

1 t∫1 t∫1 (


## 1 − 1

uvw )t−max( u, v−1, w−2) dudvdw (uvw)2−β1 ≈≈ 3! (a 1)


## 3 t∫

1 u∫1 v∫1 (


## 1 − 1

uvw )t−u dudvdw (uvw)2−β1 , (S28)where 3! = 3 · 2 · 1.

Then, summing up Eq. (S26), Eq. (S27) and Eq. (S28), the probability to have a new triplet can be approximated asdD3(t) dt ≈ a2tβ1−1+ c 2 d 2+log2(t) + a1tβ1−1 + 3! (a 1)


## 3 t∫

1 u∫1 v∫1 (


## 1 − 1

uvw )t−u dudvdw (uvw)2−β1 . (S29)In general, for the nth-order Heaps’ law, let us suppose by induction that all lower orders are known, i.e., for all orders k = 1, . . . , n − 1, with n ≥ 2, we havedDk( t) dt ≈ aktβ1−1+ ck dk +log2(t) , Dk( t) = ˜aktβ1+ ck dk +log2(t) , (S30)29/34with a, c, d > 0. Then, following the same procedure used for the 3rd-order Heaps’ law, the probability of extracting a new n-tuple is given b y:

dDn( t) dt ≈ dDn−1(t) dt + dD1(t) dt + n! (a 1) n t∫1 u 1∫


## 1 · · ·

u n−1∫1 ︸ ︷︷ ︸ n integrals (


## 1 − 1

u 1 · · · un )t−u 1 du1 · · · dun (u 1 · · · u n)2−β1 , (S31)which approximately givesdDn( t) dt ≈ antβ1−1+ cn d n+log2(t) , Dn( t) = ˜antβ1+ cn d n+log2(t) . (S32)30/34S4 Analytical details of ERRWT modelIn this section we provide an analytical insight of the model proposed in this manuscript, the Edge-Reinforced Random Walk with Triggering, or ERRWT. In particular, we refer to the definition of the ERRWT model given in Materials and Methods in the main manuscript, and try to build differential equations for the evolution of D1(t) and D2(t). From now o n, we omit the explicit time dependence of the variables, e.g., D1 ≡ D1(t), so that the mathematical expressions are easier to read. In the following analysis we make an important simplification, that i s, we do not consider an undirected update as defined the main text. Undirected update means that at any time a new link (i, j) is reinforced or triggered, the link ( j, i) is updated as well; here we consider the directed version of the model (only the visited link (i, j) is updated). We start from considering variables referring to single nodes: Din


## 1i, Dout


## 1i , Din


## 2i, Dout


## 2i represent respectively the number of times

a new node is discovered arriving (i n) in node i, and leaving (out) from node i, and the same for the number of times a new link is discovered arriving or leaving from node i. Notice that Din


## 1i becomes 1 as soon as node ii s visited for the first time.

These micro variables can be aggregated to obtain the macro variables D1 and D2, considering either in or out variables and summing over all the nodes:

D1 = ∑ i Din


## 1i = ∑

i Dout


## 1i D2 = ∑

i Din


## 2i = ∑

i Dout


## 2i (S33)

Let us now build differential equations for the evolution of the micro variables, which will be aggregated to obtain selfconsistent equations for D1 and D2. Let us consider the probability of exploring a new node starting from node i, i.e., the probability that the variable Dout


## 1i increases by 1. On the one hand, the total weight of the links outgoing from node ii s equal t o

M0i + ρni + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i, (S34)

where M0i is the initial number of links connected with node ia t time t = 0, and ni ≡ n i( t) is the number of times node i has been visited up to time t. The other two terms refer to the new links triggered when arriving in node i. Indeed, when ii s visited for the first time, (ν1 + 1) links outgoing from it o new nodes are triggered. Moreover, whenever a link ending in i is traversed for the first time, (ν2 + 1) new links from it o other explored nodes are triggered. On the other hand the total weight of links connecting i and never explored nodes is equal toM0i + (ν1 + 1)Din


## 1i − Dout


## 1i , (S35)

i.e., the initial number of nodes connected to i yet to be discovered, plus the number of nodes triggered when discovering node i, minus the number of nodes already discovered starting from i. These considerations make possible to write thatdDout 1i dt = p( i,t) M0i + (ν1 + 1)Din


## 1i − Dout

1i M0i + ρni + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i , (S36)

where p( i,t) is the probability of being on node ia t time t, which is a needed condition for Dout


## 1i to evolve. Using the same

argument, we can also write an equation for the evolution of Dout


## 2i :

dDout 2i dt = p( i,t) M0i + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i − Dout

2i M0i + ρni + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i (S37)

Notice that Eq. (S36) and Eq. (S37) cannot be obtained so easily in the undirected case. In fact, here we have implicitly assumed that any link in the adjacent possible that has never been visited before has weight 1. However, if the update is undirected, we may reinforce some link ( j, i) never traversed before only because the walker might have visited the edge (i, j), making impossible to know the actual weight of never traversed links. At this point we make another assumption in order to make the equations solvable. In particular, we assume a precise expression for the variable n i. In fact, as we have seen in Sec. S3, in the UMT, at least in the sublinear regime, we have n i( t) ∼ t/t i, where ti is the first time item (node) i has been visited1. Exploiting the analogy between the UMT and the ERRWT model we assume that n i( t) has the same behavior. We also checked numerically the validity of this assumption. We have indeed measured the evolution of n i( t) in simulations of the ERRWT model, showing that the assumption is reasonable for very different values of the parameters ν1 and ν2, as shown in Fig. S9. Further notice that p( i,t) = dni( t − 1)/d t ≈ 1/t i, since the probability of being on i at time ti s equal to the probability to move to node ii n the previous time step. With all these elements we can rewrite Eq. (S36) and Eq. (S37) asdDout 1i dt ≈ 1 ti M0i + (ν1 + 1)Din


## 1i − Dout

1iM0i + ρ tt i + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i (S38)

31/34


## 101 103 105

t101103105tini( t)


## 1 = 3


## 2 = 1

a


## 101 103 105

t101103105


## 1 = 5


## 2 = 4

b


## 101 103 105

t101103


## 105 1 = 5


## 2 = 8

c


## 101 103 105

t101103105


## 1 = 10


## 2 = 15

d


## 100 101 102 103 104 105

tiFigure S9. Temporal evolution of the quantities nnniii(((ttt))). In these figures we show the temporal evolution of n i( t), i.e. the number of times node i has been explored at time t, for many choices of the node i. In order to check the assumption n i( t) ∼ t/t i, where ti is the time when node ii s discovered for the first time, we actually plotted tini( t) vs t. We expect this quantity to go like t, which is represented by the dotted black line. As we can see from the four panels, the assumption is valid for a wide range of the parameters ν1 and ν2.

and dDout 2i dt ≈ 1 ti M0i + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i − Dout

2iM0i + ρ tt i + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i . (S39)

The last step before aggregating the equations is to further simplify the denominator. First notice that Din


## 1i is a variable which

can only take values 0 or 1, since an arriving node can result to be new only one time (this is not true for Dout


## 1i , which can b e

larger than 1). So we can neglect it with respect to the term with Din


## 2i, because also this can be larger than 1 and can go to infinity

with time with a pace dependent on the parameters as we will see later. Finally, we assume Din


## 2i ≈ D2/t i; this is a reasonable

assumption given the fact that n i( t) ≈ t/t i. Indeed, if a node ii s visited with a frequency depending on the inverse of t i, it is reasonable to assume that also the number of new links traversed arriving in node i occurs with the same frequency as well. We can finally aggregate the equations summing over all nodes i obtaining a self consistent equation for the evolution of D1:

dD1 dt = D1 ∑ i=1 dDout 1i dt ≈ ∑ i 1 ti M0i + (ν1 + 1)Din


## 1i − Dout

1iρ tt i + (ν2 + 1) D2 ti ≈ ∑ i M0i + (ν1 + 1)Din


## 1i − Dout

1i ρt + (ν2 + 1)D2= M0 + (ν1 + 1)D1 − D1 ρt + (ν2 + 1)D2 ≈ ν1D1 ρt + (ν2 + 1)D2 , (S40)where in the last approximation we have disregarded M0 in the numerator since D1(t) → ∞ is the leading term in the numerator. Similarly for the 2nd-order Heaps’ law we can writedD2 dt = D1 ∑ i=1 dDout 2i dt ≈ D1 ∑ i=1 1 ti M0i + (ν1 + 1)Din


## 1i + (ν2 + 1)Din


## 2i − Dout

2iρ tt i + (ν2 + 1) D2 t i= M0 + (ν1 + 1)D1 + (ν2 + 1)D2 − D2 ρt + (ν2 + 1)D2 ≈ (ν1 + 1)D1 + ν2D2 ρt + (ν2 + 1)D2 . (S41)Notice that the initial structure of the network only enters in the equations through the constant M0 ≡ ∑i M0i, and as we already said this term can be safely neglected with respect to the other variables. This means that the asymptotic behavior of D1 and D2, and so the exponents β1 and β2, should not depend on the initial structure of the network. We checked this fact running simulations with different initial conditions and measuring the exponents β1 and β2, checking that we obtain similar result in all cases. The results of this analysis is shown in Fig. S10. In particular, we consider regular trees with different number of levels, but same branching size. The idea is that we start from a node and trigger nodes, adding new levels of the tree. Therefore,


## 32/34100 101 102 103 104 105

t100101102103104D1(t) a 0.54 0.56 0.51 0.24 0.21 0.22


## 100 101 102 103 104 105

t100101102103104D2(t) b 0.77 0.73 0.71 0.28 0.24 0.25


## 100 101 102 103 104 105

t100101102103104D3(t) c 0.90 0.82 0.81 0.32 0.28 0.

Figure S10. Heaps’ exponents for different choices of the initial conditions. The three panels show the behavior of D1(t), D2(t) and D3(t) versus t for three different initial conditions (i.e., initial structure of the network). In particular, we consider a regular tree with branching parameter ν1 + 1 and number of levels equal to 1 (gray lines), 2 (orange lines), 3 (blue lines). All nodes apart from the leaves are considered known (o r discovered, or triggered) by the ERRWT at the beginning of the simulation. In each panel, the lines with higher Heaps’ law (see top left legend), refer to simulations with ρ = 10, ν1 = 8, and ν2 = 8, while the other lines (see bottom right legend) with ρ = 10, ν1 = 3, and ν2 = 1. In the legend, the related extracted power-law exponent is reported. As we can see, the exponents measured in the three cases are similar across order, thus showing that the initial structure of the network is not relevant for the asymptotic behavior of the ERRWT.

Figure S11. Representation of the initial network structure used in simulations of the ERRWT model in the main. Although any initial network structure can be used for the ERRWT model, in the simulations shown in the main manuscript we consider a regular tree with branching parameter ν1 + 1 (equal to 3 in the figure) and 2 levels. This structure resembles the way new nodes are triggered during the exploration, so that the root and first layer (full nodes) are considered triggered and known, while the leaves (empty nodes) are considered new. All links are regarded as new (represented as dashed). The choice of this tree has been done to ensure that the triggering of new edges finds nodes that are already known by the random walker.

the first initial network we consider is made by a root, considered triggered, connected to ν1 + 1 new nodes. The second one adds another level to the first one. Therefore, it i sa regular tree with branching size (ν1 + 1) and 2 levels. Here, the root and the first level are considered triggered, while the leaves are still new. This structure is the same used in the simulations of the main text (see also Fig. S11). Finally, the third one adds one more level, thus being much bigger than the previous ones. In the panels we show only two sets of parameters, but we find comparable results for other choices of the parameters. For both sets of parameters, we find that by increasing the number of levels (and hence the number of nodes and links) in the initial network, the higher-order Heaps’ exponents slightly increase. Moreover, the bigger the network, the longer we see a transient time in which there is a much higher Heaps’ exponent. For example, see the blue line in Fig. S10(a), where we can clearly find the initial higher slope. Nevertheless, notice that after this period, the pace of discovery, i.e., the exponent, seems to be similar across different initial conditions, thus showing that the initial structure of the network is not relevant for the asymptotic behavior of the ERRWT model.

Now, using Eq. (S40) and Eq. (S41), we are able to work out an analytical expression for the two exponents β1 and β2. Let us consider various cases. First, assuming a sublinear regime for D2 (s o that it can be neglected with respect to t), in the large time limit we can further simplify the equations and getdD1 dt ≈ ν1D1 ρt , (S42)33/34dD2 dt ≈ (ν1 + 1)D1 + ν2D2 ρt . (S43)Solving both of these equations, we obtain an explicit expression for the two exponents β1 and β2; in the sublinear case we hence have asymptoticallyβ1 = ν1 ρ , β2 = max ( ν1 ρ , ν2 ρ ) (S44)From the expression of β1 and β2 in Eq. (S44), we get that the sublinear regime holds only if ν1 < ρ and ν2 < ρ.

Before moving on to the other regimes, let us notice that β2 is constrained to b ea t most equal to 2β1. This is because if the number of nodes available to explore in the network is O(N), then the number of available edges is O(N2). This means that D2 can at most grow as the square of D1 in the large time limit, imposing a constraint on the related exponents. Let us now consider the case in which D2 grows linearly in time, but not D1. Notice that this can happen only provided that ν1 > ρ/2; in fact, since β2 is constrained to be smaller or equal than 2β1, then it would not be possible for β2 to be equal to 1 if β1 = ν1/ρ < 1/2. This regime can be obtained substituting a linear expression for D2 ∼ at into Eq. (S41). In this case, if we assume a sublinear behavior for D1, we can neglect the second term in the numerator, obtainingdD2 dt ≈ ν2at ρt + (ν2 + 1)a t = ν2a ρ + (ν2 + 1)a = a =⇒ a = ν2 − ρ (ν2 + 1) , (S45)thus showing that the condition for this regime to exist is ν2 > ρ, otherwise the coefficient a would be negative. Then, we cansubstitute D2 = ν2 − ρ (ν2 + 1)t into Eq. (S40), to get the actual value of β1:

dD1 dt ≈ ν1D1 ρt + (ν2 − ρ)t = ν1D1 ν2t =⇒ β1 = ν1 ν2 . (S46)Therefore, D1 keeps growing sublinearly provided that ν1 < ν2. Notice that in this case there are no conditions on the value of ν1, which can also be larger than ρ. Reminding also the network constraint β2 ≤ 2β1, we have that this regime holds provided that β1 > 1/2, which means 2ν1 > ν2.

Finally, there is one last regime, in which both D1 and D2 are linear, i.e., with exponents β1 = β2 = 1. Substituting the two linear expressions D2 ∼ at and D1 ∼ bt in Eq. (S40) and Eq. (S41), we obtain the following system of equations   dD1 dt ≈ ν1b ρ + (ν2 + 1)a = bdD2 dt ≈ (ν1 + 1)b + ν2a ρ + (ν2 + 1)a = a (S47)from which we can work out the values of the two coefficients:

a = ν1 − ρ (ν2 + 1) b = (ν1 − ρ) (ν2 + 1) (ν1 − ν2) (ν1 + 1) , (S48)which give the conditions ν1 > ρ and ν1 > ν2 for this regime to hold. This comes out from the fact that, as we have seen before, whenever ν2 > ν1 we have a sublinear regime for D1.

Summarizing the predicted exponents for the directed version of the model for any choice of the parameter ν1, ν2 and ρ, we have:   ν2 < ρ, ν1 < ρ β1 = ν1 ρ , β2 = min ( max ( ν1 ρ , ν2 ρ ) , 2ν1 ρ )ν2 ≥ ρ, ν1 ≤ ρ


## 2 β1 = ν1

ρ , β2 = 2ν1 ρ ν2 ≥ ρ, ρ


## 2 < ν1 < ν2 β1 = ν1

ν2 , β2 = 1ν1 ≥ ρ, ν1 ≥ ν2 β1 = β2 = 1 (S49)The results above give us an analytical overview of a simplified version of the model, which can still provide the phenomenology we are interested i n. In fact, with this analysis we still obtain a different behavior for D1 and D2 with two different Heaps’ exponents β1 and β2, which are controlled by the parameters ν1 and ν2, given ρ. 34/34