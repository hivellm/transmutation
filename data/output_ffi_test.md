3 1 s t C o n f e r e n c e o n N e u r a l I n f o r m a t i o n P r o c e s s i n g S y s t e m s ( N I P S 2 0 1 7 ) , L o n g B e a c h , C A , U S A . W o r k p e r f o r m e d w h i l e a t G o o g l e R e s e a r c h . ++ W o r k p e r f o r m e d w h i l e a t G o o g l e B r a i n . + o u r r e s e a r c h . i m p l e m e n t i n g t e n s o r 2 t e n s o r , r e p l a c i n g o u r e a r l i e r c o d e b a s e , g r e a t l y i m p r o v i n g r e s u l t s a n d m a s s i v e l y a c c e l e r a t i n g e f fi c i e n t i n f e r e n c e a n d v i s u a l i z a t i o n s . L u k a s z a n d A i d a n s p e n t c o u n t l e s s l o n g d a y s d e s i g n i n g v a r i o u s p a r t s o f a n d t e n s o r 2 t e n s o r . L l i o n a l s o e x p e r i m e n t e d w i t h n o v e l m o d e l v a r i a n t s , w a s r e s p o n s i b l e f o r o u r i n i t i a l c o d e b a s e , a n d d e t a i l . N i k i d e s i g n e d , i m p l e m e n t e d , t u n e d a n d e v a l u a t e d c o u n t l e s s m o d e l v a r i a n t s i n o u r o r i g i n a l c o d e b a s e a n d a t t e n t i o n a n d t h e p a r a m e t e r - f r e e p o s i t i o n r e p r e s e n t a t i o n a n d b e c a m e t h e o t h e r p e r s o n i n v o l v e d i n n e a r l y e v e r y h a s b e e n c r u c i a l l y i n v o l v e d i n e v e r y a s p e c t o f t h i s w o r k . N o a m p r o p o s e d s c a l e d d o t - p r o d u c t a t t e n t i o n , m u l t i - h e a d t h e e f f o r t t o e v a l u a t e t h i s i d e a . A s h i s h , w i t h I l l i a , d e s i g n e d a n d i m p l e m e n t e d t h e fi r s t T r a n s f o r m e r m o d e l s a n d E q u a l c o n t r i b u t i o n . L i s t i n g o r d e r i s r a n d o m . J a k o b p r o p o s e d r e p l a c i n g R N N s w i t h s e l f - a t t e n t i o n a n d s t a r t e d ∗ l a r g e a n d l i m i t e d t r a i n i n g d a t a . o t h e r t a s k s b y a p p l y i n g i t s u c c e s s f u l l y t o E n g l i s h c o n s t i t u e n c y p a r s i n g b o t h w i t h a b e s t m o d e l s f r o m t h e l i t e r a t u r e . W e s h o w t h a t t h e T r a n s f o r m e r g e n e r a l i z e s w e l l t o r t r a i n i n g f o r 3 . 5 d a y s o n e i g h t G P U s , a s m a l l f r a c t i o n o f t h e t r a i n i n g c o s t s o f t h e X o u r m o d e l e s t a b l i s h e s a n e w s i n g l e - m o d e l s t a t e - o f - t h e - a r t B L E U s c o r e o f 4 1 . 8 a f t e r i e n s e m b l e s , b y o v e r 2 B L E U . O n t h e W M T 2 0 1 4 E n g l i s h - t o - F r e n c h t r a n s l a t i o n t a s k , v t o - G e r m a n t r a n s l a t i o n t a s k , i m p r o v i n g o v e r t h e e x i s t i n g b e s t r e s u l t s , i n c l u d i n g : l e s s t i m e t o t r a i n . O u r m o d e l a c h i e v e s 2 8 . 4 B L E U o n t h e W M T 2 0 1 4 E n g l i s h - 1 b e s u p e r i o r i n q u a l i t y w h i l e b e i n g m o r e p a r a l l e l i z a b l e a n d r e q u i r i n g s i g n i fi c a n t l y 7 e n t i r e l y . E x p e r i m e n t s o n t w o m a c h i n e t r a n s l a t i o n t a s k s s h o w t h e s e m o d e l s t o 0 b a s e d s o l e l y o n a t t e n t i o n m e c h a n i s m s , d i s p e n s i n g w i t h r e c u r r e n c e a n d c o n v o l u t i o n s 6 m e c h a n i s m . W e p r o p o s e a n e w s i m p l e n e t w o r k a r c h i t e c t u r e , t h e T r a n s f o r m e r , . 0 p e r f o r m i n g m o d e l s a l s o c o n n e c t t h e e n c o d e r a n d d e c o d e r t h r o u g h a n a t t e n t i o n 3 c o n v o l u t i o n a l n e u r a l n e t w o r k s t h a t i n c l u d e a n e n c o d e r a n d a d e c o d e r . T h e b e s t 7 T h e d o m i n a n t s e q u e n c e t r a n s d u c t i o n m o d e l s a r e b a s e d o n c o m p l e x r e c u r r e n t o r 6 2 A b s t r a c t v 7 i l l i a . p o l o s u k h i n @ g m a i l . c o m \[ c I l l i a P o l o s u k h i n ∗ ++ s . l l i o n @ g o o g l e . c o m a i d a n @ c s . t o r o n t o . e d u l u k a s z k a i s e r @ g o o g l e . c o m C G o o g l e R e s e a r c h U n i v e r s i t y o f T o r o n t o G o o g l e B r a i n L \] L l i o n J o n e s A i d a n N . G o m e z Ł u k a s z K a i s e r ∗ ∗ + ∗ a v a s w a n i @ g o o g l e . c o m n o a m @ g o o g l e . c o m n i k i p @ g o o g l e . c o m u s z @ g o o g l e . c o m 2 G o o g l e B r a i n G o o g l e B r a i n G o o g l e R e s e a r c h G o o g l e R e s e a r c h A A s h i s h V a s w a n i N o a m S h a z e e r N i k i P a r m a r J a k o b U s z k o r e i t ∗ ∗ ∗ ∗ u g 2 0 2 3 A t t e n t i o n I s A l l Y o u N e e d s c h o l a r l y w o r k s . r e p r o d u c e t h e t a b l e s a n d fi g u r e s i n t h i s p a p e r s o l e l y f o r u s e i n j o u r n a l i s t i c o r P r o v i d e d p r o p e r a t t r i b u t i o n i s p r o v i d e d , G o o g l e h e r e b y g r a n t s p e r m i s s i o n t o 2 \[ 1 0 \] , c o n s u m i n g t h e p r e v i o u s l y g e n e r a t e d s y m b o l s a s a d d i t i o n a l i n p u t w h e n g e n e r a t i n g t h e n e x t . 1 m s e q u e n c e o f s y m b o l s o n e e l e m e n t a t a t i m e . A t e a c h s t e p t h e m o d e l i s a u t o - r e g r e s s i v e ( y , . . . , y ) 1 n o f c o n t i n u o u s r e p r e s e n t a t i o n s . G i v e n , t h e d e c o d e r t h e n g e n e r a t e s a n o u t p u t z z = ( z , . . . , z ) 1 n H e r e , t h e e n c o d e r m a p s a n i n p u t s e q u e n c e o f s y m b o l r e p r e s e n t a t i o n s t o a s e q u e n c e ( x , . . . , x ) M o s t c o m p e t i t i v e n e u r a l s e q u e n c e t r a n s d u c t i o n m o d e l s h a v e a n e n c o d e r - d e c o d e r s t r u c t u r e \[ 5 , 2 , 3 5 \] . 3 M o d e l A r c h i t e c t u r e s e l f - a t t e n t i o n a n d d i s c u s s i t s a d v a n t a g e s o v e r m o d e l s s u c h a s \[ 1 7 , 1 8 \] a n d \[ 9 \] . a l i g n e d R N N s o r c o n v o l u t i o n . I n t h e f o l l o w i n g s e c t i o n s , w e w i l l d e s c r i b e t h e T r a n s f o r m e r , m o t i v a t e e n t i r e l y o n s e l f - a t t e n t i o n t o c o m p u t e r e p r e s e n t a t i o n s o f i t s i n p u t a n d o u t p u t w i t h o u t u s i n g s e q u e n c e - T o t h e b e s t o f o u r k n o w l e d g e , h o w e v e r , t h e T r a n s f o r m e r i s t h e fi r s t t r a n s d u c t i o n m o d e l r e l y i n g l a n g u a g e m o d e l i n g t a s k s \[ 3 4 \] . a l i g n e d r e c u r r e n c e a n d h a v e b e e n s h o w n t o p e r f o r m w e l l o n s i m p l e - l a n g u a g e q u e s t i o n a n s w e r i n g a n d E n d - t o - e n d m e m o r y n e t w o r k s a r e b a s e d o n a r e c u r r e n t a t t e n t i o n m e c h a n i s m i n s t e a d o f s e q u e n c e - t e x t u a l e n t a i l m e n t a n d l e a r n i n g t a s k - i n d e p e n d e n t s e n t e n c e r e p r e s e n t a t i o n s \[ 4 , 2 7 , 2 8 , 2 2 \] . u s e d s u c c e s s f u l l y i n a v a r i e t y o f t a s k s i n c l u d i n g r e a d i n g c o m p r e h e n s i o n , a b s t r a c t i v e s u m m a r i z a t i o n , o f a s i n g l e s e q u e n c e i n o r d e r t o c o m p u t e a r e p r e s e n t a t i o n o f t h e s e q u e n c e . S e l f - a t t e n t i o n h a s b e e n S e l f - a t t e n t i o n , s o m e t i m e s c a l l e d i n t r a - a t t e n t i o n i s a n a t t e n t i o n m e c h a n i s m r e l a t i n g d i f f e r e n t p o s i t i o n s d e s c r i b e d i n s e c t i o n 3 . 2 . t o a v e r a g i n g a t t e n t i o n - w e i g h t e d p o s i t i o n s , a n e f f e c t w e c o u n t e r a c t w i t h M u l t i - H e a d A t t e n t i o n a s r e d u c e d t o a c o n s t a n t n u m b e r o f o p e r a t i o n s , a l b e i t a t t h e c o s t o f r e d u c e d e f f e c t i v e r e s o l u t i o n d u e i t m o r e d i f fi c u l t t o l e a r n d e p e n d e n c i e s b e t w e e n d i s t a n t p o s i t i o n s \[ 1 2 \] . I n t h e T r a n s f o r m e r t h i s i s i n t h e d i s t a n c e b e t w e e n p o s i t i o n s , l i n e a r l y f o r C o n v S 2 S a n d l o g a r i t h m i c a l l y f o r B y t e N e t . T h i s m a k e s t h e n u m b e r o f o p e r a t i o n s r e q u i r e d t o r e l a t e s i g n a l s f r o m t w o a r b i t r a r y i n p u t o r o u t p u t p o s i t i o n s g r o w s b l o c k , c o m p u t i n g h i d d e n r e p r e s e n t a t i o n s i n p a r a l l e l f o r a l l i n p u t a n d o u t p u t p o s i t i o n s . I n t h e s e m o d e l s , \[ 1 6 \] , B y t e N e t \[ 1 8 \] a n d C o n v S 2 S \[ 9 \] , a l l o f w h i c h u s e c o n v o l u t i o n a l n e u r a l n e t w o r k s a s b a s i c b u i l d i n g T h e g o a l o f r e d u c i n g s e q u e n t i a l c o m p u t a t i o n a l s o f o r m s t h e f o u n d a t i o n o f t h e E x t e n d e d N e u r a l G P U 2 B a c k g r o u n d t r a n s l a t i o n q u a l i t y a f t e r b e i n g t r a i n e d f o r a s l i t t l e a s t w e l v e h o u r s o n e i g h t P 1 0 0 G P U s . T h e T r a n s f o r m e r a l l o w s f o r s i g n i fi c a n t l y m o r e p a r a l l e l i z a t i o n a n d c a n r e a c h a n e w s t a t e o f t h e a r t i n r e l y i n g e n t i r e l y o n a n a t t e n t i o n m e c h a n i s m t o d r a w g l o b a l d e p e n d e n c i e s b e t w e e n i n p u t a n d o u t p u t . I n t h i s w o r k w e p r o p o s e t h e T r a n s f o r m e r , a m o d e l a r c h i t e c t u r e e s c h e w i n g r e c u r r e n c e a n d i n s t e a d a r e u s e d i n c o n j u n c t i o n w i t h a r e c u r r e n t n e t w o r k . t h e i n p u t o r o u t p u t s e q u e n c e s \[ 2 , 1 9 \] . I n a l l b u t a f e w c a s e s \[ 2 7 \] , h o w e v e r , s u c h a t t e n t i o n m e c h a n i s m s t i o n m o d e l s i n v a r i o u s t a s k s , a l l o w i n g m o d e l i n g o f d e p e n d e n c i e s w i t h o u t r e g a r d t o t h e i r d i s t a n c e i n A t t e n t i o n m e c h a n i s m s h a v e b e c o m e a n i n t e g r a l p a r t o f c o m p e l l i n g s e q u e n c e m o d e l i n g a n d t r a n s d u c - c o n s t r a i n t o f s e q u e n t i a l c o m p u t a t i o n , h o w e v e r , r e m a i n s . c o m p u t a t i o n \[ 3 2 \] , w h i l e a l s o i m p r o v i n g m o d e l p e r f o r m a n c e i n c a s e o f t h e l a t t e r . T h e f u n d a m e n t a l s i g n i fi c a n t i m p r o v e m e n t s i n c o m p u t a t i o n a l e f fi c i e n c y t h r o u g h f a c t o r i z a t i o n t r i c k s \[ 2 1 \] a n d c o n d i t i o n a l s e q u e n c e l e n g t h s , a s m e m o r y c o n s t r a i n t s l i m i t b a t c h i n g a c r o s s e x a m p l e s . R e c e n t w o r k h a s a c h i e v e d s e q u e n t i a l n a t u r e p r e c l u d e s p a r a l l e l i z a t i o n w i t h i n t r a i n i n g e x a m p l e s , w h i c h b e c o m e s c r i t i c a l a t l o n g e r t t 1 - s t a t e s , a s a f u n c t i o n o f t h e p r e v i o u s h i d d e n s t a t e a n d t h e i n p u t f o r p o s i t i o n . T h i s i n h e r e n t l y h h t s e q u e n c e s . A l i g n i n g t h e p o s i t i o n s t o s t e p s i n c o m p u t a t i o n t i m e , t h e y g e n e r a t e a s e q u e n c e o f h i d d e n R e c u r r e n t m o d e l s t y p i c a l l y f a c t o r c o m p u t a t i o n a l o n g t h e s y m b o l p o s i t i o n s o f t h e i n p u t a n d o u t p u t a r c h i t e c t u r e s \[ 3 8 , 2 4 , 1 5 \] . e f f o r t s h a v e s i n c e c o n t i n u e d t o p u s h t h e b o u n d a r i e s o f r e c u r r e n t l a n g u a g e m o d e l s a n d e n c o d e r - d e c o d e r t r a n s d u c t i o n p r o b l e m s s u c h a s l a n g u a g e m o d e l i n g a n d m a c h i n e t r a n s l a t i o n \[ 3 5 , 2 , 5 \] . N u m e r o u s i n p a r t i c u l a r , h a v e b e e n fi r m l y e s t a b l i s h e d a s s t a t e o f t h e a r t a p p r o a c h e s i n s e q u e n c e m o d e l i n g a n d R e c u r r e n t n e u r a l n e t w o r k s , l o n g s h o r t - t e r m m e m o r y \[ 1 3 \] a n d g a t e d r e c u r r e n t \[ 7 \] n e u r a l n e t w o r k s 1 I n t r o d u c t i o n 3 w h e r e t h e q u e r y , k e y s , v a l u e s , a n d o u t p u t a r e a l l v e c t o r s . T h e o u t p u t i s c o m p u t e d a s a w e i g h t e d s u m A n a t t e n t i o n f u n c t i o n c a n b e d e s c r i b e d a s m a p p i n g a q u e r y a n d a s e t o f k e y - v a l u e p a i r s t o a n o u t p u t , 3 . 2 A t t e n t i o n p r e d i c t i o n s f o r p o s i t i o n c a n d e p e n d o n l y o n t h e k n o w n o u t p u t s a t p o s i t i o n s l e s s t h a n . i i m a s k i n g , c o m b i n e d w i t h f a c t t h a t t h e o u t p u t e m b e d d i n g s a r e o f f s e t b y o n e p o s i t i o n , e n s u r e s t h a t t h e s u b - l a y e r i n t h e d e c o d e r s t a c k t o p r e v e n t p o s i t i o n s f r o m a t t e n d i n g t o s u b s e q u e n t p o s i t i o n s . T h i s a r o u n d e a c h o f t h e s u b - l a y e r s , f o l l o w e d b y l a y e r n o r m a l i z a t i o n . W e a l s o m o d i f y t h e s e l f - a t t e n t i o n a t t e n t i o n o v e r t h e o u t p u t o f t h e e n c o d e r s t a c k . S i m i l a r t o t h e e n c o d e r , w e e m p l o y r e s i d u a l c o n n e c t i o n s s u b - l a y e r s i n e a c h e n c o d e r l a y e r , t h e d e c o d e r i n s e r t s a t h i r d s u b - l a y e r , w h i c h p e r f o r m s m u l t i - h e a d D e c o d e r : T h e d e c o d e r i s a l s o c o m p o s e d o f a s t a c k o f i d e n t i c a l l a y e r s . I n a d d i t i o n t o t h e t w o N = 6 m o d e l l a y e r s , p r o d u c e o u t p u t s o f d i m e n s i o n . d = 5 1 2 i t s e l f . T o f a c i l i t a t e t h e s e r e s i d u a l c o n n e c t i o n s , a l l s u b - l a y e r s i n t h e m o d e l , a s w e l l a s t h e e m b e d d i n g , w h e r e i s t h e f u n c t i o n i m p l e m e n t e d b y t h e s u b - l a y e r L a y e r N o r m ( x + S u b l a y e r ( x ) ) S u b l a y e r ( x ) t h e t w o s u b - l a y e r s , f o l l o w e d b y l a y e r n o r m a l i z a t i o n \[ 1 \] . T h a t i s , t h e o u t p u t o f e a c h s u b - l a y e r i s w i s e f u l l y c o n n e c t e d f e e d - f o r w a r d n e t w o r k . W e e m p l o y a r e s i d u a l c o n n e c t i o n \[ 1 1 \] a r o u n d e a c h o f s u b - l a y e r s . T h e fi r s t i s a m u l t i - h e a d s e l f - a t t e n t i o n m e c h a n i s m , a n d t h e s e c o n d i s a s i m p l e , p o s i t i o n - E n c o d e r : T h e e n c o d e r i s c o m p o s e d o f a s t a c k o f i d e n t i c a l l a y e r s . E a c h l a y e r h a s t w o N = 6 3 . 1 E n c o d e r a n d D e c o d e r S t a c k s r e s p e c t i v e l y . c o n n e c t e d l a y e r s f o r b o t h t h e e n c o d e r a n d d e c o d e r , s h o w n i n t h e l e f t a n d r i g h t h a l v e s o f F i g u r e 1 , T h e T r a n s f o r m e r f o l l o w s t h i s o v e r a l l a r c h i t e c t u r e u s i n g s t a c k e d s e l f - a t t e n t i o n a n d p o i n t - w i s e , f u l l y F i g u r e 1 : T h e T r a n s f o r m e r - m o d e l a r c h i t e c t u r e . 4 i = 1 k i i v a r i a b l e s w i t h m e a n a n d v a r i a n c e . T h e n t h e i r d o t p r o d u c t , , h a s m e a n a n d v a r i a n c e . 0 1 q k = q k 0 d · sum k d T o i l l u s t r a t e w h y t h e d o t p r o d u c t s g e t l a r g e , a s s u m e t h a t t h e c o m p o n e n t s o f a n d a r e i n d e p e n d e n t r a n d o m q k 4 v q u e r i e s , k e y s a n d v a l u e s w e t h e n p e r f o r m t h e a t t e n t i o n f u n c t i o n i n p a r a l l e l , y i e l d i n g - d i m e n s i o n a l d k k v l i n e a r p r o j e c t i o n s t o , a n d d i m e n s i o n s , r e s p e c t i v e l y . O n e a c h o f t h e s e p r o j e c t e d v e r s i o n s o f d d d w e f o u n d i t b e n e fi c i a l t o l i n e a r l y p r o j e c t t h e q u e r i e s , k e y s a n d v a l u e s t i m e s w i t h d i f f e r e n t , l e a r n e d h m o d e l I n s t e a d o f p e r f o r m i n g a s i n g l e a t t e n t i o n f u n c t i o n w i t h - d i m e n s i o n a l k e y s , v a l u e s a n d q u e r i e s , d 3 . 2 . 2 M u l t i - H e a d A t t e n t i o n k d e x t r e m e l y s m a l l g r a d i e n t s . T o c o u n t e r a c t t h i s e f f e c t , w e s c a l e t h e d o t p r o d u c t s b y . sqrt 4 1 k , t h e d o t p r o d u c t s g r o w l a r g e i n m a g n i t u d e , p u s h i n g t h e s o f t m a x f u n c t i o n i n t o r e g i o n s w h e r e i t h a s d k d o t p r o d u c t a t t e n t i o n w i t h o u t s c a l i n g f o r l a r g e r v a l u e s o f \[ 3 \] . W e s u s p e c t t h a t f o r l a r g e v a l u e s o f d k W h i l e f o r s m a l l v a l u e s o f t h e t w o m e c h a n i s m s p e r f o r m s i m i l a r l y , a d d i t i v e a t t e n t i o n o u t p e r f o r m s d m a t r i x m u l t i p l i c a t i o n c o d e . m u c h f a s t e r a n d m o r e s p a c e - e f fi c i e n t i n p r a c t i c e , s i n c e i t c a n b e i m p l e m e n t e d u s i n g h i g h l y o p t i m i z e d a s i n g l e h i d d e n l a y e r . W h i l e t h e t w o a r e s i m i l a r i n t h e o r e t i c a l c o m p l e x i t y , d o t - p r o d u c t a t t e n t i o n i s k d o f . A d d i t i v e a t t e n t i o n c o m p u t e s t h e c o m p a t i b i l i t y f u n c t i o n u s i n g a f e e d - f o r w a r d n e t w o r k w i t h sqrt 1 p l i c a t i v e ) a t t e n t i o n . D o t - p r o d u c t a t t e n t i o n i s i d e n t i c a l t o o u r a l g o r i t h m , e x c e p t f o r t h e s c a l i n g f a c t o r T h e t w o m o s t c o m m o n l y u s e d a t t e n t i o n f u n c t i o n s a r e a d d i t i v e a t t e n t i o n \[ 2 \] , a n d d o t - p r o d u c t ( m u l t i - k d ( 1 ) A t t e n t i o n ( Q , K , V ) = s o f t m a x ( ) V sqrt Q K T t h e m a t r i x o f o u t p u t s a s : i n t o a m a t r i x . T h e k e y s a n d v a l u e s a r e a l s o p a c k e d t o g e t h e r i n t o m a t r i c e s a n d . W e c o m p u t e Q K V I n p r a c t i c e , w e c o m p u t e t h e a t t e n t i o n f u n c t i o n o n a s e t o f q u e r i e s s i m u l t a n e o u s l y , p a c k e d t o g e t h e r v a l u e s . k q u e r y w i t h a l l k e y s , d i v i d e e a c h b y , a n d a p p l y a s o f t m a x f u n c t i o n t o o b t a i n t h e w e i g h t s o n t h e d sqrt k v q u e r i e s a n d k e y s o f d i m e n s i o n , a n d v a l u e s o f d i m e n s i o n . W e c o m p u t e t h e d o t p r o d u c t s o f t h e d d W e c a l l o u r p a r t i c u l a r a t t e n t i o n " S c a l e d D o t - P r o d u c t A t t e n t i o n " ( F i g u r e 2 ) . T h e i n p u t c o n s i s t s o f 3 . 2 . 1 S c a l e d D o t - P r o d u c t A t t e n t i o n q u e r y w i t h t h e c o r r e s p o n d i n g k e y . o f t h e v a l u e s , w h e r e t h e w e i g h t a s s i g n e d t o e a c h v a l u e i s c o m p u t e d b y a c o m p a t i b i l i t y f u n c t i o n o f t h e a t t e n t i o n l a y e r s r u n n i n g i n p a r a l l e l . F i g u r e 2 : ( l e f t ) S c a l e d D o t - P r o d u c t A t t e n t i o n . ( r i g h t ) M u l t i - H e a d A t t e n t i o n c o n s i s t s o f s e v e r a l S c a l e d D o t - P r o d u c t A t t e n t i o n M u l t i - H e a d A t t e n t i o n 5 m o d e l l i n e a r t r a n s f o r m a t i o n , s i m i l a r t o \[ 3 0 \] . I n t h e e m b e d d i n g l a y e r s , w e m u l t i p l y t h o s e w e i g h t s b y . d sqrt o u r m o d e l , w e s h a r e t h e s a m e w e i g h t m a t r i x b e t w e e n t h e t w o e m b e d d i n g l a y e r s a n d t h e p r e - s o f t m a x m a t i o n a n d s o f t m a x f u n c t i o n t o c o n v e r t t h e d e c o d e r o u t p u t t o p r e d i c t e d n e x t - t o k e n p r o b a b i l i t i e s . I n m o d e l t o k e n s a n d o u t p u t t o k e n s t o v e c t o r s o f d i m e n s i o n . W e a l s o u s e t h e u s u a l l e a r n e d l i n e a r t r a n s f o r - d S i m i l a r l y t o o t h e r s e q u e n c e t r a n s d u c t i o n m o d e l s , w e u s e l e a r n e d e m b e d d i n g s t o c o n v e r t t h e i n p u t 3 . 4 E m b e d d i n g s a n d S o f t m a x f f . d = 2 0 4 8 m o d e l T h e d i m e n s i o n a l i t y o f i n p u t a n d o u t p u t i s , a n d t h e i n n e r - l a y e r h a s d i m e n s i o n a l i t y d = 5 1 2 f r o m l a y e r t o l a y e r . A n o t h e r w a y o f d e s c r i b i n g t h i s i s a s t w o c o n v o l u t i o n s w i t h k e r n e l s i z e 1 . W h i l e t h e l i n e a r t r a n s f o r m a t i o n s a r e t h e s a m e a c r o s s d i f f e r e n t p o s i t i o n s , t h e y u s e d i f f e r e n t p a r a m e t e r s 1 1 2 2 ( 2 ) F F N ( x ) = m a x ( 0 , x W + b ) W + b c o n s i s t s o f t w o l i n e a r t r a n s f o r m a t i o n s w i t h a R e L U a c t i v a t i o n i n b e t w e e n . c o n n e c t e d f e e d - f o r w a r d n e t w o r k , w h i c h i s a p p l i e d t o e a c h p o s i t i o n s e p a r a t e l y a n d i d e n t i c a l l y . T h i s I n a d d i t i o n t o a t t e n t i o n s u b - l a y e r s , e a c h o f t h e l a y e r s i n o u r e n c o d e r a n d d e c o d e r c o n t a i n s a f u l l y 3 . 3 P o s i t i o n - w i s e F e e d - F o r w a r d N e t w o r k s o f t h e s o f t m a x w h i c h c o r r e s p o n d t o i l l e g a l c o n n e c t i o n s . S e e F i g u r e 2 . i n s i d e o f s c a l e d d o t - p r o d u c t a t t e n t i o n b y m a s k i n g o u t ( s e t t i n g t o ) a l l v a l u e s i n t h e i n p u t - infinity i n f o r m a t i o n fl o w i n t h e d e c o d e r t o p r e s e r v e t h e a u t o - r e g r e s s i v e p r o p e r t y . W e i m p l e m e n t t h i s a l l p o s i t i o n s i n t h e d e c o d e r u p t o a n d i n c l u d i n g t h a t p o s i t i o n . W e n e e d t o p r e v e n t l e f t w a r d · S i m i l a r l y , s e l f - a t t e n t i o n l a y e r s i n t h e d e c o d e r a l l o w e a c h p o s i t i o n i n t h e d e c o d e r t o a t t e n d t o e n c o d e r . e n c o d e r . E a c h p o s i t i o n i n t h e e n c o d e r c a n a t t e n d t o a l l p o s i t i o n s i n t h e p r e v i o u s l a y e r o f t h e a n d q u e r i e s c o m e f r o m t h e s a m e p l a c e , i n t h i s c a s e , t h e o u t p u t o f t h e p r e v i o u s l a y e r i n t h e · T h e e n c o d e r c o n t a i n s s e l f - a t t e n t i o n l a y e r s . I n a s e l f - a t t e n t i o n l a y e r a l l o f t h e k e y s , v a l u e s \[ 3 8 , 2 , 9 \] . t y p i c a l e n c o d e r - d e c o d e r a t t e n t i o n m e c h a n i s m s i n s e q u e n c e - t o - s e q u e n c e m o d e l s s u c h a s p o s i t i o n i n t h e d e c o d e r t o a t t e n d o v e r a l l p o s i t i o n s i n t h e i n p u t s e q u e n c e . T h i s m i m i c s t h e a n d t h e m e m o r y k e y s a n d v a l u e s c o m e f r o m t h e o u t p u t o f t h e e n c o d e r . T h i s a l l o w s e v e r y · I n " e n c o d e r - d e c o d e r a t t e n t i o n " l a y e r s , t h e q u e r i e s c o m e f r o m t h e p r e v i o u s d e c o d e r l a y e r , T h e T r a n s f o r m e r u s e s m u l t i - h e a d a t t e n t i o n i n t h r e e d i f f e r e n t w a y s : 3 . 2 . 3 A p p l i c a t i o n s o f A t t e n t i o n i n o u r M o d e l i s s i m i l a r t o t h a t o f s i n g l e - h e a d a t t e n t i o n w i t h f u l l d i m e n s i o n a l i t y . m o d e l k v . D u e t o t h e r e d u c e d d i m e n s i o n o f e a c h h e a d , t h e t o t a l c o m p u t a t i o n a l c o s t d = d = d / h = 6 4 I n t h i s w o r k w e e m p l o y p a r a l l e l a t t e n t i o n l a y e r s , o r h e a d s . F o r e a c h o f t h e s e w e u s e h = 8 a n d . W ∈ R m o d e l v O h d d x i i i W h e r e t h e p r o j e c t i o n s a r e p a r a m e t e r m a t r i c e s , , W W W ∈ ∈ ∈ R R R m o d e l m o d e l m o d e l k k v d d K d d V d d x x x Q i i i i w h e r e h e a d = A t t e n t i o n ( Q W , K W , V W ) K V Q 1 h M u l t i H e a d ( Q , K , V ) = C o n c a t ( h e a d , . . . , h e a d ) W O s u b s p a c e s a t d i f f e r e n t p o s i t i o n s . W i t h a s i n g l e a t t e n t i o n h e a d , a v e r a g i n g i n h i b i t s t h i s . M u l t i - h e a d a t t e n t i o n a l l o w s t h e m o d e l t o j o i n t l y a t t e n d t o i n f o r m a t i o n f r o m d i f f e r e n t r e p r e s e n t a t i o n d e p i c t e d i n F i g u r e 2 . o u t p u t v a l u e s . T h e s e a r e c o n c a t e n a t e d a n d o n c e a g a i n p r o j e c t e d , r e s u l t i n g i n t h e fi n a l v a l u e s , a s 6 c o m p u t a t i o n a l c o m p l e x i t y , s e l f - a t t e n t i o n l a y e r s a r e f a s t e r t h a n r e c u r r e n t l a y e r s w h e n t h e s e q u e n c e e x e c u t e d o p e r a t i o n s , w h e r e a s a r e c u r r e n t l a y e r r e q u i r e s s e q u e n t i a l o p e r a t i o n s . I n t e r m s o f O ( n ) A s n o t e d i n T a b l e 1 , a s e l f - a t t e n t i o n l a y e r c o n n e c t s a l l p o s i t i o n s w i t h a c o n s t a n t n u m b e r o f s e q u e n t i a l l y d i f f e r e n t l a y e r t y p e s . t h e m a x i m u m p a t h l e n g t h b e t w e e n a n y t w o i n p u t a n d o u t p u t p o s i t i o n s i n n e t w o r k s c o m p o s e d o f t h e a n d o u t p u t s e q u e n c e s , t h e e a s i e r i t i s t o l e a r n l o n g - r a n g e d e p e n d e n c i e s \[ 1 2 \] . H e n c e w e a l s o c o m p a r e t r a v e r s e i n t h e n e t w o r k . T h e s h o r t e r t h e s e p a t h s b e t w e e n a n y c o m b i n a t i o n o f p o s i t i o n s i n t h e i n p u t a b i l i t y t o l e a r n s u c h d e p e n d e n c i e s i s t h e l e n g t h o f t h e p a t h s f o r w a r d a n d b a c k w a r d s i g n a l s h a v e t o d e p e n d e n c i e s i s a k e y c h a l l e n g e i n m a n y s e q u e n c e t r a n s d u c t i o n t a s k s . O n e k e y f a c t o r a f f e c t i n g t h e T h e t h i r d i s t h e p a t h l e n g t h b e t w e e n l o n g - r a n g e d e p e n d e n c i e s i n t h e n e t w o r k . L e a r n i n g l o n g - r a n g e b e p a r a l l e l i z e d , a s m e a s u r e d b y t h e m i n i m u m n u m b e r o f s e q u e n t i a l o p e r a t i o n s r e q u i r e d . O n e i s t h e t o t a l c o m p u t a t i o n a l c o m p l e x i t y p e r l a y e r . A n o t h e r i s t h e a m o u n t o f c o m p u t a t i o n t h a t c a n c o n s i d e r t h r e e d e s i d e r a t a . l a y e r i n a t y p i c a l s e q u e n c e t r a n s d u c t i o n e n c o d e r o r d e c o d e r . M o t i v a t i n g o u r u s e o f s e l f - a t t e n t i o n w e 1 n 1 n i i t o a n o t h e r s e q u e n c e o f e q u a l l e n g t h , w i t h , s u c h a s a h i d d e n ( x , . . . , x ) ( z , . . . , z ) x , z ∈ R d t i o n a l l a y e r s c o m m o n l y u s e d f o r m a p p i n g o n e v a r i a b l e - l e n g t h s e q u e n c e o f s y m b o l r e p r e s e n t a t i o n s I n t h i s s e c t i o n w e c o m p a r e v a r i o u s a s p e c t s o f s e l f - a t t e n t i o n l a y e r s t o t h e r e c u r r e n t a n d c o n v o l u - 4 W h y S e l f - A t t e n t i o n d u r i n g t r a i n i n g . b e c a u s e i t m a y a l l o w t h e m o d e l t o e x t r a p o l a t e t o s e q u e n c e l e n g t h s l o n g e r t h a n t h e o n e s e n c o u n t e r e d v e r s i o n s p r o d u c e d n e a r l y i d e n t i c a l r e s u l t s ( s e e T a b l e 3 r o w ( E ) ) . W e c h o s e t h e s i n u s o i d a l v e r s i o n W e a l s o e x p e r i m e n t e d w i t h u s i n g l e a r n e d p o s i t i o n a l e m b e d d i n g s \[ 9 \] i n s t e a d , a n d f o u n d t h a t t h e t w o p o s . P E p o s + k r e l a t i v e p o s i t i o n s , s i n c e f o r a n y fi x e d o f f s e t , c a n b e r e p r e s e n t e d a s a l i n e a r f u n c t i o n o f k P E c h o s e t h i s f u n c t i o n b e c a u s e w e h y p o t h e s i z e d i t w o u l d a l l o w t h e m o d e l t o e a s i l y l e a r n t o a t t e n d b y c o r r e s p o n d s t o a s i n u s o i d . T h e w a v e l e n g t h s f o r m a g e o m e t r i c p r o g r e s s i o n f r o m t o . W e 2 pi 1 0 0 0 0 2 pi · w h e r e i s t h e p o s i t i o n a n d i s t h e d i m e n s i o n . T h a t i s , e a c h d i m e n s i o n o f t h e p o s i t i o n a l e n c o d i n g p o s i ( p o s , 2 i + 1 ) P E = c o s ( p o s / 1 0 0 0 0 ) m o d e l 2 i / d ( p o s , 2 i ) P E = s i n ( p o s / 1 0 0 0 0 ) m o d e l 2 i / d I n t h i s w o r k , w e u s e s i n e a n d c o s i n e f u n c t i o n s o f d i f f e r e n t f r e q u e n c i e s : l e a r n e d a n d fi x e d \[ 9 \] . a s t h e e m b e d d i n g s , s o t h a t t h e t w o c a n b e s u m m e d . T h e r e a r e m a n y c h o i c e s o f p o s i t i o n a l e n c o d i n g s , m o d e l b o t t o m s o f t h e e n c o d e r a n d d e c o d e r s t a c k s . T h e p o s i t i o n a l e n c o d i n g s h a v e t h e s a m e d i m e n s i o n d t o k e n s i n t h e s e q u e n c e . T o t h i s e n d , w e a d d " p o s i t i o n a l e n c o d i n g s " t o t h e i n p u t e m b e d d i n g s a t t h e o r d e r o f t h e s e q u e n c e , w e m u s t i n j e c t s o m e i n f o r m a t i o n a b o u t t h e r e l a t i v e o r a b s o l u t e p o s i t i o n o f t h e S i n c e o u r m o d e l c o n t a i n s n o r e c u r r e n c e a n d n o c o n v o l u t i o n , i n o r d e r f o r t h e m o d e l t o m a k e u s e o f t h e 3 . 5 P o s i t i o n a l E n c o d i n g S e l f - A t t e n t i o n ( r e s t r i c t e d ) O ( r n d ) O ( 1 ) O ( n / r ) · · k C o n v o l u t i o n a l O ( k n d ) O ( 1 ) O ( l o g ( n ) ) · · 2 R e c u r r e n t O ( n d ) O ( n ) O ( n ) · 2 S e l f - A t t e n t i o n O ( n d ) O ( 1 ) O ( 1 ) · 2 O p e r a t i o n s L a y e r T y p e C o m p l e x i t y p e r L a y e r S e q u e n t i a l M a x i m u m P a t h L e n g t h s i z e o f c o n v o l u t i o n s a n d t h e s i z e o f t h e n e i g h b o r h o o d i n r e s t r i c t e d s e l f - a t t e n t i o n . r f o r d i f f e r e n t l a y e r t y p e s . i s t h e s e q u e n c e l e n g t h , i s t h e r e p r e s e n t a t i o n d i m e n s i o n , i s t h e k e r n e l n d k T a b l e 1 : M a x i m u m p a t h l e n g t h s , p e r - l a y e r c o m p l e x i t y a n d m i n i m u m n u m b e r o f s e q u e n t i a l o p e r a t i o n s 7 W e e m p l o y t h r e e t y p e s o f r e g u l a r i z a t i o n d u r i n g t r a i n i n g : 5 . 4 R e g u l a r i z a t i o n \_ . w a r m u p s t e p s = 4 0 0 0 a n d d e c r e a s i n g i t t h e r e a f t e r p r o p o r t i o n a l l y t o t h e i n v e r s e s q u a r e r o o t o f t h e s t e p n u m b e r . W e u s e d T h i s c o r r e s p o n d s t o i n c r e a s i n g t h e l e a r n i n g r a t e l i n e a r l y f o r t h e fi r s t \_ t r a i n i n g s t e p s , w a r m u p s t e p s m o d e l \_ \_ \_ ( 3 ) l r a t e = d m i n ( s t e p n u m , s t e p n u m w a r m u p s t e p s ) · · 0 . 5 1 . 5 - - 0 . 5 - r a t e o v e r t h e c o u r s e o f t r a i n i n g , a c c o r d i n g t o t h e f o r m u l a : 1 2 W e u s e d t h e A d a m o p t i m i z e r \[ 2 0 \] w i t h , a n d . W e v a r i e d t h e l e a r n i n g beta = 0 . 9 beta = 0 . 9 8 ϵ = 1 0 9 - 5 . 3 O p t i m i z e r ( 3 . 5 d a y s ) . b o t t o m l i n e o f t a b l e 3 ) , s t e p t i m e w a s 1 . 0 s e c o n d s . T h e b i g m o d e l s w e r e t r a i n e d f o r 3 0 0 , 0 0 0 s t e p s t r a i n e d t h e b a s e m o d e l s f o r a t o t a l o f 1 0 0 , 0 0 0 s t e p s o r 1 2 h o u r s . F o r o u r b i g m o d e l s , ( d e s c r i b e d o n t h e t h e h y p e r p a r a m e t e r s d e s c r i b e d t h r o u g h o u t t h e p a p e r , e a c h t r a i n i n g s t e p t o o k a b o u t 0 . 4 s e c o n d s . W e W e t r a i n e d o u r m o d e l s o n o n e m a c h i n e w i t h 8 N V I D I A P 1 0 0 G P U s . F o r o u r b a s e m o d e l s u s i n g 5 . 2 H a r d w a r e a n d S c h e d u l e t a r g e t t o k e n s . b a t c h c o n t a i n e d a s e t o f s e n t e n c e p a i r s c o n t a i n i n g a p p r o x i m a t e l y 2 5 0 0 0 s o u r c e t o k e n s a n d 2 5 0 0 0 v o c a b u l a r y \[ 3 8 \] . S e n t e n c e p a i r s w e r e b a t c h e d t o g e t h e r b y a p p r o x i m a t e s e q u e n c e l e n g t h . E a c h t r a i n i n g 2 0 1 4 E n g l i s h - F r e n c h d a t a s e t c o n s i s t i n g o f 3 6 M s e n t e n c e s a n d s p l i t t o k e n s i n t o a 3 2 0 0 0 w o r d - p i e c e t a r g e t v o c a b u l a r y o f a b o u t 3 7 0 0 0 t o k e n s . F o r E n g l i s h - F r e n c h , w e u s e d t h e s i g n i fi c a n t l y l a r g e r W M T s e n t e n c e p a i r s . S e n t e n c e s w e r e e n c o d e d u s i n g b y t e - p a i r e n c o d i n g \[ 3 \] , w h i c h h a s a s h a r e d s o u r c e - W e t r a i n e d o n t h e s t a n d a r d W M T 2 0 1 4 E n g l i s h - G e r m a n d a t a s e t c o n s i s t i n g o f a b o u t 4 . 5 m i l l i o n 5 . 1 T r a i n i n g D a t a a n d B a t c h i n g T h i s s e c t i o n d e s c r i b e s t h e t r a i n i n g r e g i m e f o r o u r m o d e l s . 5 T r a i n i n g a n d s e m a n t i c s t r u c t u r e o f t h e s e n t e n c e s . h e a d s c l e a r l y l e a r n t o p e r f o r m d i f f e r e n t t a s k s , m a n y a p p e a r t o e x h i b i t b e h a v i o r r e l a t e d t o t h e s y n t a c t i c f r o m o u r m o d e l s a n d p r e s e n t a n d d i s c u s s e x a m p l e s i n t h e a p p e n d i x . N o t o n l y d o i n d i v i d u a l a t t e n t i o n A s s i d e b e n e fi t , s e l f - a t t e n t i o n c o u l d y i e l d m o r e i n t e r p r e t a b l e m o d e l s . W e i n s p e c t a t t e n t i o n d i s t r i b u t i o n s t h e a p p r o a c h w e t a k e i n o u r m o d e l . c o n v o l u t i o n i s e q u a l t o t h e c o m b i n a t i o n o f a s e l f - a t t e n t i o n l a y e r a n d a p o i n t - w i s e f e e d - f o r w a r d l a y e r , c o n s i d e r a b l y , t o . E v e n w i t h , h o w e v e r , t h e c o m p l e x i t y o f a s e p a r a b l e O ( k n d + n d ) k = n · · · 2 r e c u r r e n t l a y e r s , b y a f a c t o r o f . S e p a r a b l e c o n v o l u t i o n s \[ 6 \] , h o w e v e r , d e c r e a s e t h e c o m p l e x i t y k b e t w e e n a n y t w o p o s i t i o n s i n t h e n e t w o r k . C o n v o l u t i o n a l l a y e r s a r e g e n e r a l l y m o r e e x p e n s i v e t h a n k o r i n t h e c a s e o f d i l a t e d c o n v o l u t i o n s \[ 1 8 \] , i n c r e a s i n g t h e l e n g t h o f t h e l o n g e s t p a t h s O ( l o g ( n ) ) p o s i t i o n s . D o i n g s o r e q u i r e s a s t a c k o f c o n v o l u t i o n a l l a y e r s i n t h e c a s e o f c o n t i g u o u s k e r n e l s , O ( n / k ) A s i n g l e c o n v o l u t i o n a l l a y e r w i t h k e r n e l w i d t h d o e s n o t c o n n e c t a l l p a i r s o f i n p u t a n d o u t p u t k < n p a t h l e n g t h t o . W e p l a n t o i n v e s t i g a t e t h i s a p p r o a c h f u r t h e r i n f u t u r e w o r k . O ( n / r ) t h e i n p u t s e q u e n c e c e n t e r e d a r o u n d t h e r e s p e c t i v e o u t p u t p o s i t i o n . T h i s w o u l d i n c r e a s e t h e m a x i m u m v e r y l o n g s e q u e n c e s , s e l f - a t t e n t i o n c o u l d b e r e s t r i c t e d t o c o n s i d e r i n g o n l y a n e i g h b o r h o o d o f s i z e i n r \[ 3 8 \] a n d b y t e - p a i r \[ 3 1 \] r e p r e s e n t a t i o n s . T o i m p r o v e c o m p u t a t i o n a l p e r f o r m a n c e f o r t a s k s i n v o l v i n g s e n t e n c e r e p r e s e n t a t i o n s u s e d b y s t a t e - o f - t h e - a r t m o d e l s i n m a c h i n e t r a n s l a t i o n s , s u c h a s w o r d - p i e c e l e n g t h i s s m a l l e r t h a n t h e r e p r e s e n t a t i o n d i m e n s i o n a l i t y , w h i c h i s m o s t o f t e n t h e c a s e w i t h n d 8 W e u s e d v a l u e s o f 2 . 8 , 3 . 7 , 6 . 0 a n d 9 . 5 T F L O P S f o r K 8 0 , K 4 0 , M 4 0 a n d P 1 0 0 , r e s p e c t i v e l y . 5 i n d i f f e r e n t w a y s , m e a s u r i n g t h e c h a n g e i n p e r f o r m a n c e o n E n g l i s h - t o - G e r m a n t r a n s l a t i o n o n t h e T o e v a l u a t e t h e i m p o r t a n c e o f d i f f e r e n t c o m p o n e n t s o f t h e T r a n s f o r m e r , w e v a r i e d o u r b a s e m o d e l 6 . 2 M o d e l V a r i a t i o n s s i n g l e - p r e c i s i o n fl o a t i n g - p o i n t c a p a c i t y o f e a c h G P U . 5 m o d e l b y m u l t i p l y i n g t h e t r a i n i n g t i m e , t h e n u m b e r o f G P U s u s e d , a n d a n e s t i m a t e o f t h e s u s t a i n e d a r c h i t e c t u r e s f r o m t h e l i t e r a t u r e . W e e s t i m a t e t h e n u m b e r o f fl o a t i n g p o i n t o p e r a t i o n s u s e d t o t r a i n a T a b l e 2 s u m m a r i z e s o u r r e s u l t s a n d c o m p a r e s o u r t r a n s l a t i o n q u a l i t y a n d t r a i n i n g c o s t s t o o t h e r m o d e l i n f e r e n c e t o i n p u t l e n g t h + , b u t t e r m i n a t e e a r l y w h e n p o s s i b l e \[ 3 8 \] . 5 0 w e r e c h o s e n a f t e r e x p e r i m e n t a t i o n o n t h e d e v e l o p m e n t s e t . W e s e t t h e m a x i m u m o u t p u t l e n g t h d u r i n g u s e d b e a m s e a r c h w i t h a b e a m s i z e o f a n d l e n g t h p e n a l t y \[ 3 8 \] . T h e s e h y p e r p a r a m e t e r s 4 alpha = 0 . 6 w e r e w r i t t e n a t 1 0 - m i n u t e i n t e r v a l s . F o r t h e b i g m o d e l s , w e a v e r a g e d t h e l a s t 2 0 c h e c k p o i n t s . W e F o r t h e b a s e m o d e l s , w e u s e d a s i n g l e m o d e l o b t a i n e d b y a v e r a g i n g t h e l a s t 5 c h e c k p o i n t s , w h i c h d r o p d r o p o u t r a t e , i n s t e a d o f . P = 0 . 1 0 . 3 p r e v i o u s s t a t e - o f - t h e - a r t m o d e l . T h e T r a n s f o r m e r ( b i g ) m o d e l t r a i n e d f o r E n g l i s h - t o - F r e n c h u s e d o u t p e r f o r m i n g a l l o f t h e p r e v i o u s l y p u b l i s h e d s i n g l e m o d e l s , a t l e s s t h a n t h e t r a i n i n g c o s t o f t h e 1 / 4 O n t h e W M T 2 0 1 4 E n g l i s h - t o - F r e n c h t r a n s l a t i o n t a s k , o u r b i g m o d e l a c h i e v e s a B L E U s c o r e o f , 4 1 . 0 t h e c o m p e t i t i v e m o d e l s . s u r p a s s e s a l l p r e v i o u s l y p u b l i s h e d m o d e l s a n d e n s e m b l e s , a t a f r a c t i o n o f t h e t r a i n i n g c o s t o f a n y o f l i s t e d i n t h e b o t t o m l i n e o f T a b l e 3 . T r a i n i n g t o o k d a y s o n P 1 0 0 G P U s . E v e n o u r b a s e m o d e l 3 . 5 8 B L E U , e s t a b l i s h i n g a n e w s t a t e - o f - t h e - a r t B L E U s c o r e o f . T h e c o n fi g u r a t i o n o f t h i s m o d e l i s 2 8 . 4 i n T a b l e 2 ) o u t p e r f o r m s t h e b e s t p r e v i o u s l y r e p o r t e d m o d e l s ( i n c l u d i n g e n s e m b l e s ) b y m o r e t h a n 2 . 0 O n t h e W M T 2 0 1 4 E n g l i s h - t o - G e r m a n t r a n s l a t i o n t a s k , t h e b i g t r a n s f o r m e r m o d e l ( T r a n s f o r m e r ( b i g ) 6 . 1 M a c h i n e T r a n s l a t i o n 6 R e s u l t s h u r t s p e r p l e x i t y , a s t h e m o d e l l e a r n s t o b e m o r e u n s u r e , b u t i m p r o v e s a c c u r a c y a n d B L E U s c o r e . l s L a b e l S m o o t h i n g D u r i n g t r a i n i n g , w e e m p l o y e d l a b e l s m o o t h i n g o f v a l u e \[ 3 6 \] . T h i s ϵ = 0 . 1 d r o p . P = 0 . 1 p o s i t i o n a l e n c o d i n g s i n b o t h t h e e n c o d e r a n d d e c o d e r s t a c k s . F o r t h e b a s e m o d e l , w e u s e a r a t e o f s u b - l a y e r i n p u t a n d n o r m a l i z e d . I n a d d i t i o n , w e a p p l y d r o p o u t t o t h e s u m s o f t h e e m b e d d i n g s a n d t h e R e s i d u a l D r o p o u t W e a p p l y d r o p o u t \[ 3 3 \] t o t h e o u t p u t o f e a c h s u b - l a y e r , b e f o r e i t i s a d d e d t o t h e 2 8 . 4 4 1 . 8 T r a n s f o r m e r ( b i g ) 2 . 3 1 0 · 1 9 T r a n s f o r m e r ( b a s e m o d e l ) 2 7 . 3 3 8 . 1 3 . 3 1 0 · 1 8 4 1 . 2 9 C o n v S 2 S E n s e m b l e \[ 9 \] 2 6 . 3 6 7 . 7 1 0 1 . 2 1 0 · · 1 9 2 1 G N M T + R L E n s e m b l e \[ 3 8 \] 2 6 . 3 0 4 1 . 1 6 1 . 8 1 0 1 . 1 1 0 · · 2 0 2 1 D e e p - A t t + P o s U n k E n s e m b l e \[ 3 9 \] 4 0 . 4 8 . 0 1 0 · 2 0 M o E \[ 3 2 \] 2 6 . 0 3 4 0 . 5 6 2 . 0 1 0 1 . 2 1 0 · · 1 9 2 0 C o n v S 2 S \[ 9 \] 2 5 . 1 6 4 0 . 4 6 9 . 6 1 0 1 . 5 1 0 · · 1 8 2 0 G N M T + R L \[ 3 8 \] 2 4 . 6 3 9 . 9 2 2 . 3 1 0 1 . 4 1 0 · · 1 9 2 0 D e e p - A t t + P o s U n k \[ 3 9 \] 3 9 . 2 1 . 0 1 0 · 2 0 B y t e N e t \[ 1 8 \] 2 3 . 7 5 E N - D E E N - F R E N - D E E N - F R M o d e l B L E U T r a i n i n g C o s t ( F L O P s ) E n g l i s h - t o - G e r m a n a n d E n g l i s h - t o - F r e n c h n e w s t e s t 2 0 1 4 t e s t s a t a f r a c t i o n o f t h e t r a i n i n g c o s t . T a b l e 2 : T h e T r a n s f o r m e r a c h i e v e s b e t t e r B L E U s c o r e s t h a n p r e v i o u s s t a t e - o f - t h e - a r t m o d e l s o n t h e 9 r e m a i n e d u n c h a n g e d f r o m t h e E n g l i s h - t o - G e r m a n b a s e t r a n s l a t i o n m o d e l . D u r i n g i n f e r e n c e , w e ( s e c t i o n 5 . 4 ) , l e a r n i n g r a t e s a n d b e a m s i z e o n t h e S e c t i o n 2 2 d e v e l o p m e n t s e t , a l l o t h e r p a r a m e t e r s W e p e r f o r m e d o n l y a s m a l l n u m b e r o f e x p e r i m e n t s t o s e l e c t t h e d r o p o u t , b o t h a t t e n t i o n a n d r e s i d u a l f o r t h e s e m i - s u p e r v i s e d s e t t i n g . \[ 3 7 \] . W e u s e d a v o c a b u l a r y o f 1 6 K t o k e n s f o r t h e W S J o n l y s e t t i n g a n d a v o c a b u l a r y o f 3 2 K t o k e n s u s i n g t h e l a r g e r h i g h - c o n fi d e n c e a n d B e r k l e y P a r s e r c o r p o r a f r o m w i t h a p p r o x i m a t e l y 1 7 M s e n t e n c e s P e n n T r e e b a n k \[ 2 5 \] , a b o u t 4 0 K t r a i n i n g s e n t e n c e s . W e a l s o t r a i n e d i t i n a s e m i - s u p e r v i s e d s e t t i n g , m o d e l W e t r a i n e d a 4 - l a y e r t r a n s f o r m e r w i t h o n t h e W a l l S t r e e t J o u r n a l ( W S J ) p o r t i o n o f t h e d = 1 0 2 4 m o d e l s h a v e n o t b e e n a b l e t o a t t a i n s t a t e - o f - t h e - a r t r e s u l t s i n s m a l l - d a t a r e g i m e s \[ 3 7 \] . c o n s t r a i n t s a n d i s s i g n i fi c a n t l y l o n g e r t h a n t h e i n p u t . F u r t h e r m o r e , R N N s e q u e n c e - t o - s e q u e n c e c o n s t i t u e n c y p a r s i n g . T h i s t a s k p r e s e n t s s p e c i fi c c h a l l e n g e s : t h e o u t p u t i s s u b j e c t t o s t r o n g s t r u c t u r a l T o e v a l u a t e i f t h e T r a n s f o r m e r c a n g e n e r a l i z e t o o t h e r t a s k s w e p e r f o r m e d e x p e r i m e n t s o n E n g l i s h 6 . 3 E n g l i s h C o n s t i t u e n c y P a r s i n g r e s u l t s t o t h e b a s e m o d e l . s i n u s o i d a l p o s i t i o n a l e n c o d i n g w i t h l e a r n e d p o s i t i o n a l e m b e d d i n g s \[ 9 \] , a n d o b s e r v e n e a r l y i d e n t i c a l b i g g e r m o d e l s a r e b e t t e r , a n d d r o p o u t i s v e r y h e l p f u l i n a v o i d i n g o v e r - fi t t i n g . I n r o w ( E ) w e r e p l a c e o u r f u n c t i o n t h a n d o t p r o d u c t m a y b e b e n e fi c i a l . W e f u r t h e r o b s e r v e i n r o w s ( C ) a n d ( D ) t h a t , a s e x p e c t e d , s u g g e s t s t h a t d e t e r m i n i n g c o m p a t i b i l i t y i s n o t e a s y a n d t h a t a m o r e s o p h i s t i c a t e d c o m p a t i b i l i t y k I n T a b l e 3 r o w s ( B ) , w e o b s e r v e t h a t r e d u c i n g t h e a t t e n t i o n k e y s i z e h u r t s m o d e l q u a l i t y . T h i s d a t t e n t i o n i s 0 . 9 B L E U w o r s e t h a n t h e b e s t s e t t i n g , q u a l i t y a l s o d r o p s o f f w i t h t o o m a n y h e a d s . k e e p i n g t h e a m o u n t o f c o m p u t a t i o n c o n s t a n t , a s d e s c r i b e d i n S e c t i o n 3 . 2 . 2 . W h i l e s i n g l e - h e a d I n T a b l e 3 r o w s ( A ) , w e v a r y t h e n u m b e r o f a t t e n t i o n h e a d s a n d t h e a t t e n t i o n k e y a n d v a l u e d i m e n s i o n s , c h e c k p o i n t a v e r a g i n g . W e p r e s e n t t h e s e r e s u l t s i n T a b l e 3 . d e v e l o p m e n t s e t , n e w s t e s t 2 0 1 3 . W e u s e d b e a m s e a r c h a s d e s c r i b e d i n t h e p r e v i o u s s e c t i o n , b u t n o 4 . 3 3 2 6 . 4 b i g 6 1 0 2 4 4 0 9 6 1 6 0 . 3 3 0 0 K 2 1 3 ( E ) p o s i t i o n a l e m b e d d i n g i n s t e a d o f s i n u s o i d s 4 . 9 2 2 5 . 7 0 . 2 5 . 4 7 2 5 . 7 0 . 0 4 . 6 7 2 5 . 3 ( D ) 0 . 2 4 . 9 5 2 5 . 5 0 . 0 5 . 7 7 2 4 . 6 4 0 9 6 4 . 7 5 2 6 . 2 9 0 1 0 2 4 5 . 1 2 2 5 . 4 5 3 1 0 2 4 1 2 8 1 2 8 4 . 6 6 2 6 . 0 1 6 8 ( C ) 2 5 6 3 2 3 2 5 . 7 5 2 4 . 5 2 8 8 4 . 8 8 2 5 . 5 8 0 4 5 . 1 9 2 5 . 3 5 0 2 6 . 1 1 2 3 . 7 3 6 3 2 5 . 0 1 2 5 . 4 6 0 ( B ) 1 6 5 . 1 6 2 5 . 1 5 8 3 2 1 6 1 6 5 . 0 1 2 5 . 4 1 6 3 2 3 2 4 . 9 1 2 5 . 8 ( A ) 4 1 2 8 1 2 8 5 . 0 0 2 5 . 5 1 5 1 2 5 1 2 5 . 2 9 2 4 . 9 b a s e 6 5 1 2 2 0 4 8 8 6 4 6 4 0 . 1 0 . 1 1 0 0 K 4 . 9 2 2 5 . 8 6 5 s t e p s ( d e v ) ( d e v ) 1 0 x 6 m o d e l f f k v d r o p l s N d d h d d P ϵ t r a i n P P L B L E U p a r a m s p e r - w o r d p e r p l e x i t i e s . p e r p l e x i t i e s a r e p e r - w o r d p i e c e , a c c o r d i n g t o o u r b y t e - p a i r e n c o d i n g , a n d s h o u l d n o t b e c o m p a r e d t o m o d e l . A l l m e t r i c s a r e o n t h e E n g l i s h - t o - G e r m a n t r a n s l a t i o n d e v e l o p m e n t s e t , n e w s t e s t 2 0 1 3 . L i s t e d T a b l e 3 : V a r i a t i o n s o n t h e T r a n s f o r m e r a r c h i t e c t u r e . U n l i s t e d v a l u e s a r e i d e n t i c a l t o t h o s e o f t h e b a s e 1 0 r e a d i n g . , 2 0 1 6 . a r X i v p r e p r i n t a r X i v : 1 6 0 1 . 0 6 7 3 3 \[ 4 \] J i a n p e n g C h e n g , L i D o n g , a n d M i r e l l a L a p a t a . L o n g s h o r t - t e r m m e m o r y - n e t w o r k s f o r m a c h i n e m a c h i n e t r a n s l a t i o n a r c h i t e c t u r e s . , a b s / 1 7 0 3 . 0 3 9 0 6 , 2 0 1 7 . C o R R \[ 3 \] D e n n y B r i t z , A n n a G o l d i e , M i n h - T h a n g L u o n g , a n d Q u o c V . L e . M a s s i v e e x p l o r a t i o n o f n e u r a l l e a r n i n g t o a l i g n a n d t r a n s l a t e . , a b s / 1 4 0 9 . 0 4 7 3 , 2 0 1 4 . C o R R \[ 2 \] D z m i t r y B a h d a n a u , K y u n g h y u n C h o , a n d Y o s h u a B e n g i o . N e u r a l m a c h i n e t r a n s l a t i o n b y j o i n t l y , 2 0 1 6 . a r X i v : 1 6 0 7 . 0 6 4 5 0 \[ 1 \] J i m m y L e i B a , J a m i e R y a n K i r o s , a n d G e o f f r e y E H i n t o n . L a y e r n o r m a l i z a t i o n . a r X i v p r e p r i n t R e f e r e n c e s c o m m e n t s , c o r r e c t i o n s a n d i n s p i r a t i o n . A c k n o w l e d g e m e n t s W e a r e g r a t e f u l t o N a l K a l c h b r e n n e r a n d S t e p h a n G o u w s f o r t h e i r f r u i t f u l t e n s o r f l o w / t e n s o r 2 t e n s o r . h t t p s : / / g i t h u b . c o m / T h e c o d e w e u s e d t o t r a i n a n d e v a l u a t e o u r m o d e l s i s a v a i l a b l e a t s u c h a s i m a g e s , a u d i o a n d v i d e o . M a k i n g g e n e r a t i o n l e s s s e q u e n t i a l i s a n o t h e r r e s e a r c h g o a l s o f o u r s . t o i n v e s t i g a t e l o c a l , r e s t r i c t e d a t t e n t i o n m e c h a n i s m s t o e f fi c i e n t l y h a n d l e l a r g e i n p u t s a n d o u t p u t s p l a n t o e x t e n d t h e T r a n s f o r m e r t o p r o b l e m s i n v o l v i n g i n p u t a n d o u t p u t m o d a l i t i e s o t h e r t h a n t e x t a n d W e a r e e x c i t e d a b o u t t h e f u t u r e o f a t t e n t i o n - b a s e d m o d e l s a n d p l a n t o a p p l y t h e m t o o t h e r t a s k s . W e m o d e l o u t p e r f o r m s e v e n a l l p r e v i o u s l y r e p o r t e d e n s e m b l e s . E n g l i s h - t o - F r e n c h t r a n s l a t i o n t a s k s , w e a c h i e v e a n e w s t a t e o f t h e a r t . I n t h e f o r m e r t a s k o u r b e s t o n r e c u r r e n t o r c o n v o l u t i o n a l l a y e r s . O n b o t h W M T 2 0 1 4 E n g l i s h - t o - G e r m a n a n d W M T 2 0 1 4 F o r t r a n s l a t i o n t a s k s , t h e T r a n s f o r m e r c a n b e t r a i n e d s i g n i fi c a n t l y f a s t e r t h a n a r c h i t e c t u r e s b a s e d m u l t i - h e a d e d s e l f - a t t e n t i o n . a t t e n t i o n , r e p l a c i n g t h e r e c u r r e n t l a y e r s m o s t c o m m o n l y u s e d i n e n c o d e r - d e c o d e r a r c h i t e c t u r e s w i t h I n t h i s w o r k , w e p r e s e n t e d t h e T r a n s f o r m e r , t h e fi r s t s e q u e n c e t r a n s d u c t i o n m o d e l b a s e d e n t i r e l y o n 7 C o n c l u s i o n P a r s e r \[ 2 9 \] e v e n w h e n t r a i n i n g o n l y o n t h e W S J t r a i n i n g s e t o f 4 0 K s e n t e n c e s . I n c o n t r a s t t o R N N s e q u e n c e - t o - s e q u e n c e m o d e l s \[ 3 7 \] , t h e T r a n s f o r m e r o u t p e r f o r m s t h e B e r k e l e y - R e c u r r e n t N e u r a l N e t w o r k G r a m m a r \[ 8 \] . p r i s i n g l y w e l l , y i e l d i n g b e t t e r r e s u l t s t h a n a l l p r e v i o u s l y r e p o r t e d m o d e l s w i t h t h e e x c e p t i o n o f t h e O u r r e s u l t s i n T a b l e 4 s h o w t h a t d e s p i t e t h e l a c k o f t a s k - s p e c i fi c t u n i n g o u r m o d e l p e r f o r m s s u r - f o r b o t h W S J o n l y a n d t h e s e m i - s u p e r v i s e d s e t t i n g . i n c r e a s e d t h e m a x i m u m o u t p u t l e n g t h t o i n p u t l e n g t h + . W e u s e d a b e a m s i z e o f a n d 3 0 0 2 1 alpha = 0 . 3 D y e r e t a l . ( 2 0 1 6 ) \[ 8 \] g e n e r a t i v e 9 3 . 3 L u o n g e t a l . ( 2 0 1 5 ) \[ 2 3 \] m u l t i - t a s k 9 3 . 0 T r a n s f o r m e r ( 4 l a y e r s ) s e m i - s u p e r v i s e d 9 2 . 7 V i n y a l s & K a i s e r e l a l . ( 2 0 1 4 ) \[ 3 7 \] s e m i - s u p e r v i s e d 9 2 . 1 M c C l o s k y e t a l . ( 2 0 0 6 ) \[ 2 6 \] s e m i - s u p e r v i s e d 9 2 . 1 H u a n g & H a r p e r ( 2 0 0 9 ) \[ 1 4 \] s e m i - s u p e r v i s e d 9 1 . 3 Z h u e t a l . ( 2 0 1 3 ) \[ 4 0 \] s e m i - s u p e r v i s e d 9 1 . 3 T r a n s f o r m e r ( 4 l a y e r s ) W S J o n l y , d i s c r i m i n a t i v e 9 1 . 3 D y e r e t a l . ( 2 0 1 6 ) \[ 8 \] W S J o n l y , d i s c r i m i n a t i v e 9 1 . 7 Z h u e t a l . ( 2 0 1 3 ) \[ 4 0 \] W S J o n l y , d i s c r i m i n a t i v e 9 0 . 4 P e t r o v e t a l . ( 2 0 0 6 ) \[ 2 9 \] W S J o n l y , d i s c r i m i n a t i v e 9 0 . 4 V i n y a l s & K a i s e r e l a l . ( 2 0 1 4 ) \[ 3 7 \] W S J o n l y , d i s c r i m i n a t i v e 8 8 . 3 P a r s e r T r a i n i n g W S J 2 3 F 1 o f W S J ) T a b l e 4 : T h e T r a n s f o r m e r g e n e r a l i z e s w e l l t o E n g l i s h c o n s t i t u e n c y p a r s i n g ( R e s u l t s a r e o n S e c t i o n 2 3 1 1 b a s e d n e u r a l m a c h i n e t r a n s l a t i o n . , 2 0 1 5 . a r X i v p r e p r i n t a r X i v : 1 5 0 8 . 0 4 0 2 5 \[ 2 4 \] M i n h - T h a n g L u o n g , H i e u P h a m , a n d C h r i s t o p h e r D M a n n i n g . E f f e c t i v e a p p r o a c h e s t o a t t e n t i o n - s e q u e n c e t o s e q u e n c e l e a r n i n g . , 2 0 1 5 . a r X i v p r e p r i n t a r X i v : 1 5 1 1 . 0 6 1 1 4 \[ 2 3 \] M i n h - T h a n g L u o n g , Q u o c V . L e , I l y a S u t s k e v e r , O r i o l V i n y a l s , a n d L u k a s z K a i s e r . M u l t i - t a s k , 2 0 1 7 . a r X i v : 1 7 0 3 . 0 3 1 3 0 Z h o u , a n d Y o s h u a B e n g i o . A s t r u c t u r e d s e l f - a t t e n t i v e s e n t e n c e e m b e d d i n g . a r X i v p r e p r i n t \[ 2 2 \] Z h o u h a n L i n , M i n w e i F e n g , C i c e r o N o g u e i r a d o s S a n t o s , M o Y u , B i n g X i a n g , B o w e n , 2 0 1 7 . a r X i v : 1 7 0 3 . 1 0 7 2 2 \[ 2 1 \] O l e k s i i K u c h a i e v a n d B o r i s G i n s b u r g . F a c t o r i z a t i o n t r i c k s f o r L S T M n e t w o r k s . a r X i v p r e p r i n t D i e d e r i k K i n g m a a n d J i m m y B a . A d a m : A m e t h o d f o r s t o c h a s t i c o p t i m i z a t i o n . I n , 2 0 1 5 . \[ 2 0 \] I C L R I n , 2 0 1 7 . I n t e r n a t i o n a l C o n f e r e n c e o n L e a r n i n g R e p r e s e n t a t i o n s \[ 1 9 \] Y o o n K i m , C a r l D e n t o n , L u o n g H o a n g , a n d A l e x a n d e r M . R u s h . S t r u c t u r e d a t t e n t i o n n e t w o r k s . 2 0 1 7 . r a y K a v u k c u o g l u . N e u r a l m a c h i n e t r a n s l a t i o n i n l i n e a r t i m e . , a r X i v p r e p r i n t a r X i v : 1 6 1 0 . 1 0 0 9 9 v 2 \[ 1 8 \] N a l K a l c h b r e n n e r , L a s s e E s p e h o l t , K a r e n S i m o n y a n , A a r o n v a n d e n O o r d , A l e x G r a v e s , a n d K o - , 2 0 1 6 . o n L e a r n i n g R e p r e s e n t a t i o n s ( I C L R ) \[ 1 7 \] Ł u k a s z K a i s e r a n d I l y a S u t s k e v e r . N e u r a l G P U s l e a r n a l g o r i t h m s . I n I n t e r n a t i o n a l C o n f e r e n c e , 2 0 1 6 . I n f o r m a t i o n P r o c e s s i n g S y s t e m s , ( N I P S ) \[ 1 6 \] Ł u k a s z K a i s e r a n d S a m y B e n g i o . C a n a c t i v e m e m o r y r e p l a c e a t t e n t i o n ? I n A d v a n c e s i n N e u r a l t h e l i m i t s o f l a n g u a g e m o d e l i n g . , 2 0 1 6 . a r X i v p r e p r i n t a r X i v : 1 6 0 2 . 0 2 4 1 0 \[ 1 5 \] R a f a l J o z e f o w i c z , O r i o l V i n y a l s , M i k e S c h u s t e r , N o a m S h a z e e r , a n d Y o n g h u i W u . E x p l o r i n g , p a g e s 8 3 2 - 8 4 1 . A C L , A u g u s t 2 0 0 9 . L a n g u a g e P r o c e s s i n g a c r o s s l a n g u a g e s . I n P r o c e e d i n g s o f t h e 2 0 0 9 C o n f e r e n c e o n E m p i r i c a l M e t h o d s i n N a t u r a l \[ 1 4 \] Z h o n g q i a n g H u a n g a n d M a r y H a r p e r . S e l f - t r a i n i n g P C F G g r a m m a r s w i t h l a t e n t a n n o t a t i o n s 9 ( 8 ) : 1 7 3 5 - 1 7 8 0 , 1 9 9 7 . \[ 1 3 \] S e p p H o c h r e i t e r a n d J ü r g e n S c h m i d h u b e r . L o n g s h o r t - t e r m m e m o r y . , N e u r a l c o m p u t a t i o n r e c u r r e n t n e t s : t h e d i f fi c u l t y o f l e a r n i n g l o n g - t e r m d e p e n d e n c i e s , 2 0 0 1 . \[ 1 2 \] S e p p H o c h r e i t e r , Y o s h u a B e n g i o , P a o l o F r a s c o n i , a n d J ü r g e n S c h m i d h u b e r . G r a d i e n t fl o w i n , p a g e s 7 7 0 - 7 7 8 , 2 0 1 6 . R e c o g n i t i o n a g e r e c o g n i t i o n . I n P r o c e e d i n g s o f t h e I E E E C o n f e r e n c e o n C o m p u t e r V i s i o n a n d P a t t e r n \[ 1 1 \] K a i m i n g H e , X i a n g y u Z h a n g , S h a o q i n g R e n , a n d J i a n S u n . D e e p r e s i d u a l l e a r n i n g f o r i m - , 2 0 1 3 . a r X i v : 1 3 0 8 . 0 8 5 0 \[ 1 0 \] A l e x G r a v e s . G e n e r a t i n g s e q u e n c e s w i t h r e c u r r e n t n e u r a l n e t w o r k s . a r X i v p r e p r i n t t i o n a l s e q u e n c e t o s e q u e n c e l e a r n i n g . , 2 0 1 7 . a r X i v p r e p r i n t a r X i v : 1 7 0 5 . 0 3 1 2 2 v 2 \[ 9 \] J o n a s G e h r i n g , M i c h a e l A u l i , D a v i d G r a n g i e r , D e n i s Y a r a t s , a n d Y a n n N . D a u p h i n . C o n v o l u - n e t w o r k g r a m m a r s . I n , 2 0 1 6 . P r o c . o f N A A C L \[ 8 \] C h r i s D y e r , A d h i g u n a K u n c o r o , M i g u e l B a l l e s t e r o s , a n d N o a h A . S m i t h . R e c u r r e n t n e u r a l o f g a t e d r e c u r r e n t n e u r a l n e t w o r k s o n s e q u e n c e m o d e l i n g . , a b s / 1 4 1 2 . 3 5 5 5 , 2 0 1 4 . C o R R \[ 7 \] J u n y o u n g C h u n g , Ç a g l a r G ü l ç e h r e , K y u n g h y u n C h o , a n d Y o s h u a B e n g i o . E m p i r i c a l e v a l u a t i o n , 2 0 1 6 . p r e p r i n t a r X i v : 1 6 1 0 . 0 2 3 5 7 \[ 6 \] F r a n c o i s C h o l l e t . X c e p t i o n : D e e p l e a r n i n g w i t h d e p t h w i s e s e p a r a b l e c o n v o l u t i o n s . a r X i v m a c h i n e t r a n s l a t i o n . , a b s / 1 4 0 6 . 1 0 7 8 , 2 0 1 4 . C o R R a n d Y o s h u a B e n g i o . L e a r n i n g p h r a s e r e p r e s e n t a t i o n s u s i n g r n n e n c o d e r - d e c o d e r f o r s t a t i s t i c a l \[ 5 \] K y u n g h y u n C h o , B a r t v a n M e r r i e n b o e r , C a g l a r G u l c e h r e , F e t h i B o u g a r e s , H o l g e r S c h w e n k , 1 2 , p a g e s 4 3 4 - 4 4 3 . A C L , A u g u s t 2 0 1 3 . 1 : L o n g P a p e r s ) s h i f t - r e d u c e c o n s t i t u e n t p a r s i n g . I n P r o c e e d i n g s o f t h e 5 1 s t A n n u a l M e e t i n g o f t h e A C L ( V o l u m e \[ 4 0 \] M u h u a Z h u , Y u e Z h a n g , W e n l i a n g C h e n , M i n Z h a n g , a n d J i n g b o Z h u . F a s t a n d a c c u r a t e f a s t - f o r w a r d c o n n e c t i o n s f o r n e u r a l m a c h i n e t r a n s l a t i o n . , a b s / 1 6 0 6 . 0 4 1 9 9 , 2 0 1 6 . C o R R \[ 3 9 \] J i e Z h o u , Y i n g C a o , X u g u a n g W a n g , P e n g L i , a n d W e i X u . D e e p r e c u r r e n t m o d e l s w i t h , 2 0 1 6 . a r X i v : 1 6 0 9 . 0 8 1 4 4 t r a n s l a t i o n s y s t e m : B r i d g i n g t h e g a p b e t w e e n h u m a n a n d m a c h i n e t r a n s l a t i o n . a r X i v p r e p r i n t M a c h e r e y , M a x i m K r i k u n , Y u a n C a o , Q i n G a o , K l a u s M a c h e r e y , e t a l . G o o g l e ' s n e u r a l m a c h i n e \[ 3 8 \] Y o n g h u i W u , M i k e S c h u s t e r , Z h i f e n g C h e n , Q u o c V L e , M o h a m m a d N o r o u z i , W o l f g a n g , 2 0 1 5 . A d v a n c e s i n N e u r a l I n f o r m a t i o n P r o c e s s i n g S y s t e m s \[ 3 7 \] V i n y a l s & K a i s e r , K o o , P e t r o v , S u t s k e v e r , a n d H i n t o n . G r a m m a r a s a f o r e i g n l a n g u a g e . I n R e t h i n k i n g t h e i n c e p t i o n a r c h i t e c t u r e f o r c o m p u t e r v i s i o n . , a b s / 1 5 1 2 . 0 0 5 6 7 , 2 0 1 5 . C o R R \[ 3 6 \] C h r i s t i a n S z e g e d y , V i n c e n t V a n h o u c k e , S e r g e y I o f f e , J o n a t h o n S h l e n s , a n d Z b i g n i e w W o j n a . n e t w o r k s . I n , p a g e s 3 1 0 4 - 3 1 1 2 , 2 0 1 4 . A d v a n c e s i n N e u r a l I n f o r m a t i o n P r o c e s s i n g S y s t e m s \[ 3 5 \] I l y a S u t s k e v e r , O r i o l V i n y a l s , a n d Q u o c V V L e . S e q u e n c e t o s e q u e n c e l e a r n i n g w i t h n e u r a l I n c . , 2 0 1 5 . , p a g e s 2 4 4 0 - 2 4 4 8 . C u r r a n A s s o c i a t e s , A d v a n c e s i n N e u r a l I n f o r m a t i o n P r o c e s s i n g S y s t e m s 2 8 n e t w o r k s . I n C . C o r t e s , N . D . L a w r e n c e , D . D . L e e , M . S u g i y a m a , a n d R . G a r n e t t , e d i t o r s , \[ 3 4 \] S a i n b a y a r S u k h b a a t a r , A r t h u r S z l a m , J a s o n W e s t o n , a n d R o b F e r g u s . E n d - t o - e n d m e m o r y , 1 5 ( 1 ) : 1 9 2 9 - 1 9 5 8 , 2 0 1 4 . L e a r n i n g R e s e a r c h n o v . D r o p o u t : a s i m p l e w a y t o p r e v e n t n e u r a l n e t w o r k s f r o m o v e r fi t t i n g . J o u r n a l o f M a c h i n e \[ 3 3 \] N i t i s h S r i v a s t a v a , G e o f f r e y E H i n t o n , A l e x K r i z h e v s k y , I l y a S u t s k e v e r , a n d R u s l a n S a l a k h u t d i - l a y e r . , 2 0 1 7 . a r X i v p r e p r i n t a r X i v : 1 7 0 1 . 0 6 5 3 8 a n d J e f f D e a n . O u t r a g e o u s l y l a r g e n e u r a l n e t w o r k s : T h e s p a r s e l y - g a t e d m i x t u r e - o f - e x p e r t s \[ 3 2 \] N o a m S h a z e e r , A z a l i a M i r h o s e i n i , K r z y s z t o f M a z i a r z , A n d y D a v i s , Q u o c L e , G e o f f r e y H i n t o n , w i t h s u b w o r d u n i t s . , 2 0 1 5 . a r X i v p r e p r i n t a r X i v : 1 5 0 8 . 0 7 9 0 9 \[ 3 1 \] R i c o S e n n r i c h , B a r r y H a d d o w , a n d A l e x a n d r a B i r c h . N e u r a l m a c h i n e t r a n s l a t i o n o f r a r e w o r d s , 2 0 1 6 . p r e p r i n t a r X i v : 1 6 0 8 . 0 5 8 5 9 \[ 3 0 \] O fi r P r e s s a n d L i o r W o l f . U s i n g t h e o u t p u t e m b e d d i n g t o i m p r o v e l a n g u a g e m o d e l s . a r X i v 2 0 0 6 . , p a g e s 4 3 3 - 4 4 0 . A C L , J u l y C o m p u t a t i o n a l L i n g u i s t i c s a n d 4 4 t h A n n u a l M e e t i n g o f t h e A C L a n d i n t e r p r e t a b l e t r e e a n n o t a t i o n . I n P r o c e e d i n g s o f t h e 2 1 s t I n t e r n a t i o n a l C o n f e r e n c e o n \[ 2 9 \] S l a v P e t r o v , L e o n B a r r e t t , R o m a i n T h i b a u x , a n d D a n K l e i n . L e a r n i n g a c c u r a t e , c o m p a c t , s u m m a r i z a t i o n . , 2 0 1 7 . a r X i v p r e p r i n t a r X i v : 1 7 0 5 . 0 4 3 0 4 \[ 2 8 \] R o m a i n P a u l u s , C a i m i n g X i o n g , a n d R i c h a r d S o c h e r . A d e e p r e i n f o r c e d m o d e l f o r a b s t r a c t i v e m o d e l . I n , 2 0 1 6 . E m p i r i c a l M e t h o d s i n N a t u r a l L a n g u a g e P r o c e s s i n g \[ 2 7 \] A n k u r P a r i k h , O s c a r T ä c k s t r ö m , D i p a n j a n D a s , a n d J a k o b U s z k o r e i t . A d e c o m p o s a b l e a t t e n t i o n p a g e s 1 5 2 - 1 5 9 . A C L , J u n e 2 0 0 6 . , P r o c e e d i n g s o f t h e H u m a n L a n g u a g e T e c h n o l o g y C o n f e r e n c e o f t h e N A A C L , M a i n C o n f e r e n c e \[ 2 6 \] D a v i d M c C l o s k y , E u g e n e C h a r n i a k , a n d M a r k J o h n s o n . E f f e c t i v e s e l f - t r a i n i n g f o r p a r s i n g . I n c o r p u s o f e n g l i s h : T h e p e n n t r e e b a n k . , 1 9 ( 2 ) : 3 1 3 - 3 3 0 , 1 9 9 3 . C o m p u t a t i o n a l l i n g u i s t i c s \[ 2 5 \] M i t c h e l l P M a r c u s , M a r y A n n M a r c i n k i e w i c z , a n d B e a t r i c e S a n t o r i n i . B u i l d i n g a l a r g e a n n o t a t e d 1 3 t h e w o r d ' m a k i n g ' . D i f f e r e n t c o l o r s r e p r e s e n t d i f f e r e n t h e a d s . B e s t v i e w e d i n c o l o r . t h e v e r b ' m a k i n g ' , c o m p l e t i n g t h e p h r a s e ' m a k i n g . . . m o r e d i f fi c u l t ' . A t t e n t i o n s h e r e s h o w n o n l y f o r e n c o d e r s e l f - a t t e n t i o n i n l a y e r 5 o f 6 . M a n y o f t h e a t t e n t i o n h e a d s a t t e n d t o a d i s t a n t d e p e n d e n c y o f F i g u r e 3 : A n e x a m p l e o f t h e a t t e n t i o n m e c h a n i s m f o l l o w i n g l o n g - d i s t a n c e d e p e n d e n c i e s i n t h e g o r v e A e g r m i p m n < s p m d r < < < < < < t m e E a v a o i r a s f m p p p p p p 2 a h o r s j s c f O l e o k i n i a i a a a a a a 0 t s t c a n t p e t c o t h n i i i r e h S w d d d d d d n o e 0 a n h v c u i i s r o a o r t t i w i i > > > > > > > n d 9 g n e g n e e a e I s y s i s l s s r t t t f . t I i s a o A h n l 2 t r m d . < < < i t t m g p s m o v p < < < < s a n t h h h e p i o f a e 0 i o a r r p p p E p p p m n w f a a o i a e g o f s i t v w 0 v s a a a a a a O r c i i j k r t i c e s c n i o e e s s 9 d d d d d d e e t i e S u r n e g t r r > > > > > > i r i n s l c g d > t a t y s m a t i n o e n n t s A t t e n t i o n V i s u a l i z a t i o n s I n p u t - I n p u t L a y e r 5 1 4 a n d 6 . N o t e t h a t t h e a t t e n t i o n s a r e v e r y s h a r p f o r t h i s w o r d . F u l l a t t e n t i o n s f o r h e a d 5 . B o t t o m : I s o l a t e d a t t e n t i o n s f r o m j u s t t h e w o r d ' i t s ' f o r a t t e n t i o n h e a d s 5 F i g u r e 4 : T w o a t t e n t i o n h e a d s , a l s o i n l a y e r 5 o f 6 , a p p a r e n t l y i n v o l v e d i n a n a p h o r a r e s o l u t i o n . T o p : a p p m < o l p s i < E c p i n e h s p a i w O e r n o s L T a t f j t a h b v w i i u i u e m a w h S d o o n b b h i e r a u l i s c t w i i i > > n n d g e e e e n e s y s s l r - t t t t , , . l T L b , i a b - t w a m o . < w n p b s j i w , i m < t u s n h s h a e p e r p e e u E p h h i e s i y i e l s s o w v r t p i a l e O a t n f s e u l d e t i i S i c o r l > n c d a n > t g t i o n a p p m < o l p s i < E c p I n p u t - I n p u t L a y e r 5 i n e h s p a i w O e r n o s L T a t f j t a h b v w i i u i u e m a w h S d o o n b b h i e r a u l i s c t w i i i > > n n d g e e e e n e s s y s l r - t t t t , , . l T L b , i a b - t w a m o . < w n p b s j i w , i m < t u s n h s h a e e e u p e r p E p h i h e s i y i e l s o s w p i v r t a l e O a t n f s e u l d e t i i S i c o r l > n c d a n > t g t i o n I n p u t - I n p u t L a y e r 5 1 5 a t l a y e r 5 o f 6 . T h e h e a d s c l e a r l y l e a r n e d t o p e r f o r m d i f f e r e n t t a s k s . s e n t e n c e . W e g i v e t w o s u c h e x a m p l e s a b o v e , f r o m t w o d i f f e r e n t h e a d s f r o m t h e e n c o d e r s e l f - a t t e n t i o n F i g u r e 5 : M a n y o f t h e a t t e n t i o n h e a d s e x h i b i t b e h a v i o u r t h a t s e e m s r e l a t e d t o t h e s t r u c t u r e o f t h e a p p m < o l p s i < E c p i n e h s p a i w O e r n o s L T a t f j t a h b v w i i u i u e m a w h S d o o n b b h i e r a u l i s c t w i i i > > n n d g e e e e n e s s y s l r - t t t t , , . l T m . L w n b p , b i a s b j - t i w w a , m o < i < t u s n h s h a e p e r p e e u E p h h i e s i y i e l s s o w p i v r t a l e O a t n f s e u l d e t i i S i c o r l > n c d a n > t g t i o n a p p m < o l p s i < I n p u t - I n p u t L a y e r 5 E c p i n e h s p a i w O e r n o s L T a t f j t a h b v w i i u i u e m a w h S d o o n b b h i e r a u l s i c t w i i i > > n n d g e e e e n e s s y s l r - t t t t , , . l T m . L w n b p , b i a s b j - t i w w a , m o < i < t u s n h s h a e p e r p e e u E p h h i e s i y i e l s s o w p i v r t a l e O a t n f s e u l d e t i i S i c o r l > n c d a n > t g t i o n I n p u t - I n p u t L a y e r 5
